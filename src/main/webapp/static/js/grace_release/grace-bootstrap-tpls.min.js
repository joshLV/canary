/*
 * grace-bootstrap
 * http://angular-ui.github.io/bootstrap/

 * Version: 0.0.2-a1 - 2015-04-23
 * License: MIT
 */
angular.module("grace.bootstrap",["grace.bootstrap.tpls","grace.bootstrap.bindHtml","grace.bootstrap.bindTemplate","grace.bootstrap.checkbox","grace.bootstrap.chosenAssociate","grace.bootstrap.dataFormatter","grace.bootstrap.dataAdapterModelManager","grace.bootstrap.dataAdapter","grace.bootstrap.date","grace.bootstrap.dateparser","grace.bootstrap.position","grace.bootstrap.datepicker","grace.bootstrap.dimension","grace.bootstrap.dimensionBaseSelect","grace.bootstrap.dimensionSelectWithCheckBox","grace.bootstrap.dimensionSelectWithCustom","grace.bootstrap.dimensionSelectWithRadioBox","grace.bootstrap.dropdown","grace.bootstrap.fieldManager","grace.bootstrap.pagination","grace.bootstrap.tooltip","grace.bootstrap.grid","grace.bootstrap.input","grace.bootstrap.transition","grace.bootstrap.modal","grace.bootstrap.nav","grace.bootstrap.radio","grace.bootstrap.select","grace.bootstrap.selectByGroup","grace.bootstrap.string","grace.bootstrap.summary","grace.bootstrap.summaryList","grace.bootstrap.table","grace.bootstrap.tabs"]),angular.module("grace.bootstrap.tpls",["template/checkbox/checkbox.html","template/chosenAssociate/chosenAssociate.html","template/datepicker/datepicker.html","template/datepicker/daterangepicker.html","template/datepicker/day.html","template/datepicker/dayrange.html","template/datepicker/hour.html","template/datepicker/minuteOrSecond.html","template/datepicker/month.html","template/datepicker/popup.html","template/datepicker/year.html","template/dimension/dimension.html","template/dimensionBaseSelect/dimensionBaseSelect.html","template/dimensionBaseSelect/dimensionSelectWithCheckBox.html","template/dimensionBaseSelect/dimensionSelectWithCustom.html","template/dimensionBaseSelect/dimensionSelectWithRadioBox.html","template/pagination/pager.html","template/pagination/pagination.html","template/tooltip/tooltip-html-unsafe-popup.html","template/tooltip/tooltip-popup.html","template/grid/grid.html","template/grid/gridBody.html","template/grid/gridCell.html","template/grid/gridFooter.html","template/grid/gridFooterCell.html","template/grid/gridHeader.html","template/grid/gridHeaderCell.html","template/grid/gridPagination.html","template/grid/gridScreener.html","template/grid/gridSearchAll.html","template/input/input.html","template/modal/backdrop.html","template/modal/window.html","template/nav/nav.html","template/radio/radio.html","template/select/select.html","template/selectByGroup/selectByGroup.html","template/summary/summary-item.html","template/summary/summary.html","template/summaryList/summaryList.html","template/table/table.html","template/tabs/tab.html","template/tabs/tabset.html"]),angular.module("grace.bootstrap.bindHtml",[]).directive("graceBindHtmlUnsafe",function(){return function(a,b,c){b.addClass("ng-binding").data("$binding",c.graceBindHtmlUnsafe),a.$watch(c.graceBindHtmlUnsafe,function(a){b.html(a||"")})}}),angular.module("grace.bootstrap.bindTemplate",[]).directive("graceBindTemplate",["$compile",function(a){return function(b,c,d){c.addClass("ng-binding").data("$binding",d.graceBindTemplate),b.$watch(d.graceBindTemplate,function(d){c.html(d||""),a(c.contents())(b)})}}]),angular.module("grace.bootstrap.checkbox",[]).constant("checkboxConfig",{checkboxList:[]}).controller("checkboxController",["$scope","checkboxConfig",function(a,b){a.checkboxList=a.checkboxDatas?a.checkboxDatas:b.checkboxList,a.selection=[],a.changeboxChange=function(b,c){b.checked=!b.checked,b.checked?a.selection.push(b.value):angular.forEach(a.selection,function(c,d){c===b.value&&a.selection.splice(d,1)}),a.selectValue(a.selection)},a.$watch("checkboxDatas",function(c){if(a.checkboxList=c?c:b.checkboxList,a.selection=[],a.isAllSelected)for(var d=0;d<a.checkboxList.length;)a.selection.push(a.checkboxList[d].value),a.checkboxList[d].checked=!0,d++})}]).directive("graceCheckbox",[function(){return{restrict:"EA",replace:!0,templateUrl:"template/checkbox/checkbox.html",scope:{checkboxDatas:"=?",selectValue:"=?",isAllSelected:"=?"},controller:"checkboxController",link:function(a,b,c,d){angular.isString(c.horizontal)&&(a.horizontal="horizontal")}}}]);var app=angular.module("grace.bootstrap.chosenAssociate",[]).constant("chosenAssociateConfig",{isPaging:!1,plural:!1,isDefault:!0}).controller("chosenAssociateController",["$scope","$http","chosenAssociateConfig","$sce",function(a,b,c,d){a.bodyShow=!1,a.isPaging=void 0===a.isPaging?c.isPaging:a.isPaging,a.plural=void 0===a.plural?c.plural:a.plural,a.isDefault=void 0===a.isDefault?c.isDefault:a.isDefault,a.expression="",a.ngModel||(a.ngModel={selected:"",param:""},a.plural?a.ngModel.selected=[]:a.ngModel.selected=""),a.trust=function(a){return d.trustAsHtml(a)},a.$watch("data",function(){a.data&&(a.plural||a.isDefault?a.ngModel.selected=a.ngModel.selected?a.ngModel.selected:a.data[0]:a.ngModel.selected="",a.currentPageData=angular.copy(a.data))},!0),a.changeConfigured=function(b){if(a.plural){var c=!1;if(angular.forEach(a.ngModel.selected,function(a,d){a.code==b.code&&(c=!0)}),c)return;a.ngModel.selected.push(b)}else a.currentPageData=angular.copy(a.data),a.ngModel.selected=b},a.selectFuzzy=function(){if(a.loadData)a.ngModel.param=a.expression,a.loadData&&a.loadData();else{for(var b,c=new RegExp(a.expression,"i"),d=[],e=0;b=a.data[e];e++)(c.test(b.name)||c.test(b.code))&&d.push({name:b.name,code:b.code});a.currentPageData=d}},a.choiceCloseClick=function(b){for(var c,d=0;c=a.ngModel.selected[d];d++)if(c.code==b.code){a.ngModel.selected.splice(d,1);break}angular.element(".plural-expression").focus()},a.getWidth=function(a){elm=$(a.target).parent(),elm.find(".plural-expression").width(elm.width()-58*elm.find("span").length-12)},a.setWidth=function(a){elm=$(a.target).parent(),elm.find(".plural-expression").width("20")}}]).directive("graceChosenAssociate",["$window",function(a){return{restrict:"EA",require:["graceChosenAssociate","^ngModel"],controller:"chosenAssociateController",templateUrl:"template/chosenAssociate/chosenAssociate.html",replace:!0,scope:{data:"=",ngModel:"=",isPaging:"=?",plural:"=?",loadData:"=?",isDefault:"=?"},link:function(b,c,d,e){var f=angular.element(a);f.on("click",function(){b.$apply(function(){b.bodyShow=!1,b.currentPageData=angular.copy(b.data)})});var g=c.find("#chose-single");g.on("click",function(a){b.ngModel.param=b.expression,b.$apply(function(){b.bodyShow=!b.bodyShow}),a.originalEvent.cancelBubble=!0});var h=c.find("#chose-plural"),i=c.find(".plural-expression");h.on("click",function(a){i.focus(),b.ngModel.param=angular.copy(b.expression),b.$apply(function(){b.bodyShow=!b.bodyShow}),a.originalEvent.cancelBubble=!0});var j=c.find(".associate-body input");j.on("click",function(a){a.originalEvent.cancelBubble=!0}),c.find("#chose-plural").delegate(".choice-close","click",function(a){a.stopPropagation()})}}}]);angular.module("grace.bootstrap.dataFormatter",[]).factory("$gDataFormatterFactory",["$filter",function(a){function b(a,b){var c=b.indexOf("_");if(-1==c){var d=b;b=null}else{var d=b.substr(0,c);b=b.substr(c+1)}return f[d]?f[d](a,b):a}var c="yyyy-MM-dd",d="￥",e="%",f={number:function(b,c){b=parseFloat(b),c=c||"";var d=c.split("_"),e=a("number")(b,d[0]||0);return parseInt(d[1])&&b>0&&(e="+"+e),e},percent:function(a,b){var c;return b&&(c=b.split("_")[2])&&parseInt(c)&&(a=100*parseFloat(a)),this.number(a,b)+e},date:function(b,d){return d?a("date")(b,d):a("date")(b,c)},currency:function(b,c){return c?a("currency")(b,c):a("currency")(b,d)},limitTo:function(b,c){return c?a("limitTo")(b,c):b},typeCast:function(a,b){switch(b){case"i":return parseInt(a);case"f":return parseFloat(a);case"s":return a instanceof Object?JSON.stringify(a):a+"";case"o":return a&&JSON.parse(a)||a;case"b":return"true"==a?!0:"false"==a||"0"==a||"undefined"==a||"null"==a?!1:!!a;default:return a}}};return b}]).filter("dataFormatterFilter",["$gDataFormatterFactory",function(a){return a}]),angular.module("grace.bootstrap.dataAdapterModelManager",["grace.bootstrap.dataFormatter"]).factory("$gDataAdapterModelManagerFactory",function(){var a={},b={define:function(b,c){if(!a[b]){var d=b.split(".");b=d.pop();for(var e,f=a;e=d.shift();)!f[e]&&(f[e]={isPackage:!0}),f=f[e];f[b]=c}},constant:function(a,b){this.define(a,b)},get:function(b){for(var c,d=b.split("."),e=a;c=d.shift();)e=e[c];return e}};return b}),angular.module("grace.bootstrap.dataAdapter",["grace.bootstrap.dataFormatter","grace.bootstrap.dataAdapterModelManager"]).factory("$gDataAdapterFactory",["$gDataFormatterFactory","$gDataAdapterModelManagerFactory",function(a,b){function c(a,b){if(arguments.length<2)return a;for(var c in b)a[c]=b[c];return a}function d(){return j.root?f(k,j.root):k}function e(a){var c;if(j.dynamicModel[a]){if(c=f(d(),j.dynamicModel[a]),!c)throw new Error("没有找到动态的Model:"+a)}else if(c=b.get(a),!c)throw new Error("没有找到预定义Model:"+a);return c}function f(b,c){c+="";var e=c.split("::");c=e[0];var f=e[1];if(-1!=c.indexOf(j.propertyRegRoot)&&(b=d(),c=c.replace(j.propertyRegRoot+j.propertyJoiner,"")),-1!=c.indexOf(j.propertyJoiner)){for(var e=c.split("."),g=0;e[g]&&(b=b[e[g]]);)g++;return j.enableFormatter&&f?a(b,f):b}return j.enableFormatter&&f?a(b[c],f):b[c]}function g(a,b,c){var d,e;return b?(e=typeof b,b instanceof Array&&(e="array"),d=p[e](a,b,c)):a}var h={},i={root:"data",success:"success",message:"message",propertyRegRoot:"$",propertyJoiner:".",propertyModelPre:"@",propertyConstantPre:"&",parentKey:"#parentKey",autoWalkKey:"#autoKey",autoWalkKeyReg:/#autoKey\*?/,enableFormatter:!0,dynamicModel:{}},j=null,k=null,l=null,m=/{{(.*?)}}/g,n=/&([^\[]*)(\[(.*?)\])?/,o=/^(\$\.)?([^\s'"<>]+\.)+[^\s'"<>]+$/,p={modelString:function(a){var b={};if(/^_this_$/.test(a))b.type="THIS",b.model=a;else if(new RegExp("^"+j.propertyModelPre).test(a))b=p.modelType(e(a.replace(j.propertyModelPre,"")));else if(/^#parentKey$/.test(a))b.type="TEMPLATE_TRACK",b.model=a;else if(/^=/.test(a)){var c;b.type="CONSTANT",b.formater=(c=a.match(/::(\w+)$/))?c[1]:"",b.model=b.formater?a.replace(c[0],""):a,b.data=b.model.replace(/^=/,"")}else/^[a-z A-Z 0-9 _]+$/.test(a)?(b.type="INDEX",b.formater=(c=a.match(/::(\w+)$/))?c[1]:"",b.model=a):(b.type="TEMPLATE_FORMAT",b.model=a);return b},modelType:function(a){var b={};return"NUMBER"==(typeof a).toUpperCase()&&(a+=""),b.type=(typeof a).toUpperCase(),b.model=a,"STRING"===b.type&&(b=p.modelString(a)),b},sourceDataTemplate:function(a,c,d){var e={};if(n.test(a)){var g=a.match(n),h=b.get(g[1]);g[3]?(m.test(g[3])&&(g[3]=g[3].replace(m,function(a,b,e){return b==j.parentKey?d:f(c,b)})),e.tdata=f(h,g[3])):e.tdata=h}else m.test(a)?(a=a.replace(m,function(a,b,e){return b==j.parentKey?d:f(c,b)}),o.test(a)?e.tdata=f(c,a):e.tdata=a):e.tdata=f(c,a);return e.sourceTpl=a,e},array:function(a,b,c){var d,e=b.length,f=[];if(1===e){if(d=p.modelType(b[0]),"INDEX"==d.type&&a instanceof Array){for(var h=0,e=a.length;ic=a[h];h++)f.push(ic[d.model]);return f}if("OBJECT"==d.type&&a instanceof Array)for(var h=0,e=a.length;ic=a[h];h++)f.push(g(ic,d.model,h,0,d));else if("OBJECT"==d.type&&"object"==typeof a)for(var i in a)f.push(g(a[i],d.model,i,0,d));return f}for(var j,h=0;j=b[h];h++)f[h]=a[j];return f},object:function(b,c,d){var e={},h={};for(var i in c){if(/#autoKey\*?/.test(i)){var j=i.split("*");e=p.modelType(c[i]);for(var k in b){var l=b[k];h[j[1]?l[j[1]]:k]=g(l,e.model,k)}return h}if(/\|/.test(i)){var m,j=i.split("|");e=p.modelType(c[i]),m=p.sourceDataTemplate(j[1],b,d),h[j[0]]=g(m.tdata,e.model,m.sourceTpl)}if(/^[a-z A-Z 0-9 _$]+$/.test(i))switch(e=p.modelType(c[i]),e.type){case"THIS":h[i]=b;break;case"TEMPLATE_TRACK":h[i]=d;break;case"CONSTANT":e.formater?h[i]=a.apply(null,[e.data,e.formater]):h[i]=e.data;break;case"INDEX":h[i]=f(b,e.model);break;case"TEMPLATE_FORMAT":h[i]=p.sourceDataTemplate(e.model,b,d).tdata;break;default:h[i]=b}}return h}};return h.read=function(a,b,e){j=c(c({},i),e),k=a,l=b;var f=d();if(f){var h=g(f,b,j.root);return h}},h}]),Date.prototype.toJSON=function(){return this.toString()},angular.module("grace.bootstrap.date",[]).constant("graceDateConfig",{pattern_ymd:"yyyy-MM-dd",pattern_ym:"yyyy-MM",pattern_md:"MM-dd",pattern_week:["SUN","MON","TUE","WED","THU","FRI","SAT"],pattern_ymd_cn:"yyyy年MM月dd日",pattern_ym_cn:"yyyy年MM月",pattern_md_cn:"MM月dd日",pattern_week_cn:["日","一","二","三","四","五","六"],datetime_mm:6e4,datetime_hh:36e5,datetime_dd:864e5}).factory("graceDateServ",["graceDateConfig",function(a){var b=function(b,c){b=b||new Date;var d=c||a.pattern_ymd;return d=d.replace(/yyyy|YYYY/,b.getFullYear()),d=d.replace(/yy|YY/,b.getFullYear()%100>9?(b.getFullYear()%100).toString():"0"+b.getFullYear()%100),d=d.replace(/MM/,b.getMonth()+1>9?(b.getMonth()+1).toString():"0"+(b.getMonth()+1)),d=d.replace(/M/g,b.getMonth()+1),d=d.replace(/w|W/g,a.pattern_week_cn[b.getDay()]),d=d.replace(/dd|DD/,b.getDate()>9?b.getDate().toString():"0"+b.getDate()),d=d.replace(/d|D/g,b.getDate()),d=d.replace(/hh|HH/,b.getHours()>9?b.getHours().toString():"0"+b.getHours()),d=d.replace(/h|H/g,b.getHours()),d=d.replace(/mm/,b.getMinutes()>9?b.getMinutes().toString():"0"+b.getMinutes()),d=d.replace(/m/g,b.getMinutes()),d=d.replace(/ss|SS/,b.getSeconds()>9?b.getSeconds().toString():"0"+b.getSeconds()),d=d.replace(/s|S/g,b.getSeconds())},c=function(c,d,e){c=c||new Date,e=e||a.pattern_ymd,d=d||1;var f=new Date(c.getTime());return f.setDate(f.getDate()-d),{date:f,format:b(f,e)}},d=function(b,d,e){e=e||a.pattern_ymd,b=b||new Date;for(var f=[],g=1;d>=g;g++)f[g-1]=c(b,g,e);return f},e=function(c,d,e){c=c||new Date,e=e||a.pattern_ymd;var f=new Date(c.getTime());return f.setDate(c.getDate()-(0==c.getDay()?7:c.getDay())+d),{date:f,format:b(f,e)}},f=function(b,c){b=b||new Date,c=c||a.pattern_ymd;for(var d=[],f=1;7>=f;f++)d[f-1]=e(b,f,c);return d},g=function(b,d,e){b=b||new Date,e=e||a.pattern_ymd,d=d||1;var g=c(b,7*d,e).date,h=f(g,e);return h},h=function(a,b,c){var d=i(a,0,c);return{date:d[b].date,format:d[b].format}},i=function(c,d,e){e=e||a.pattern_ymd,d=d||1,c=c||new Date;for(var f,g=new Date,h=[],i=new Date(c.getFullYear(),c.getMonth(),1),j=new Date(c.getFullYear(),c.getMonth()+1,1),k=(j-i)/a.datetime_dd,l=0;k>l;l++)f=new Date(c.getFullYear(),c.getMonth(),l+1),h.push({date:f,format:b(f,e)});return c.getFullYear()===g.getFullYear()&&c.getMonth()===g.getMonth()&&(h=h.slice(0,h.length-d)),h},j=function(b,c,d,e){e=e||a.pattern_ymd,c=c||1,d=d||1,b=b||new Date;var f=new Date(b.getFullYear(),b.getMonth()-c,1);return i(f,d,e)},k=function(c,d){c=c||new Date,d=d||a.pattern_ymd;for(var e,f=[],g=m(c),h=c.getFullYear(),i=new Date(h,3*(g-1),1),j=new Date(h,3*g,1),k=(j-i)/a.datetime_dd,l=0;k>l;l++)e=new Date(i.getTime()+l*a.datetime_dd),f.push({date:e,format:b(e,d)});return f},l=function(c,d){c=c||new Date,d=d||a.pattern_ymd;var e,f,g,h,i=c.getFullYear(),j=m(c),k=3,l=[];0>j-2?(g=new Date(i-1,9,1),h=new Date(i,0,1)):(g=new Date(i,(j-2)*k,1),h=new Date(i,(j-1)*k,1)),f=(h-g)/a.datetime_dd;for(var n=0;f>n;n++)e=new Date(g.getTime()+n*a.datetime_dd),l.push({date:e,format:b(e,d)});return l},m=function(a){return a=a||new Date,a.getMonth()/3+1},n=function(a){a=a||new Date;var b=a.getFullYear(),c=a.getMonth(),d=3,e={};return e=0>=c-d?{year:--b,index:4}:{year:b,index:Math.floor(c/d)}},o=function(a){a=a||new Date;var b=a.getFullYear();return 0==b%4&&(b%100!=0||b%400==0)},p=function(a){var b=new Date(a);b.setDate(b.getDate()+4-(b.getDay()||7));var c=b.getTime();return b.setMonth(0),b.setDate(1),Math.floor(Math.round((c-b)/864e5)/7)+1},q=function(a,b){for(var c,d=new Date(b,0,1),e=new Date(d.getTime()+864e5*(a-1)*7),f=[],g=e.getDay(),h=1;7>=h;h++)c=new Date(864e5*(h-g)+e.getTime()),f.push(c);return f};return{format:b,previousDay:c,previousDays:d,daysOfPreviousWeek:g,dayOfCurrentWeek:e,daysOfCurrentWeek:f,dayOfCurrentMonth:h,daysOfCurrentMonth:i,daysOfPreviousMonth:j,daysOfCurrentSeason:k,daysOfPreviousSeason:l,currentSeasonIndex:m,previousSeasonIndex:n,getISO8601WeekNumber:p,getDatesByWeek:q,ifLeapYear:o}}]).filter("graceDateFilter",["graceDateServ",function(_graceDateServ){var input,days,returnDates=[];return function(_input,_options){var options=eval("("+_options+")");switch(input=_input instanceof Date?_input:new Date(_input.replace(/(-|\/)/g,"/")),options.type){case"current_week_121":days=_graceDateServ.daysOfCurrentWeek(input,options.pattern),returnDates=[days[0].format,days[days.length-1].format];break;case"previous_week_121":days=_graceDateServ.daysOfPreviousWeek(input,options.n||1,options.pattern),returnDates=[days[0].format,days[days.length-1].format];break;case"current_month_121":days=_graceDateServ.daysOfCurrentMonth(input,options.pattern),returnDates=[days[0].format,days[days.length-1].format];break;case"previous_month_121":days=_graceDateServ.daysOfPreviousMonth(input,options.n||1,0,options.pattern),returnDates=[days[0].format,days[days.length-1].format];break;case"current_season_121":days=_graceDateServ.daysOfCurrentSeason(input,options.pattern),returnDates=[days[0].format,days[days.length-1].format];break;case"previous_season_121":days=_graceDateServ.daysOfPreviousSeason(input,options.pattern),returnDates=[days[0].format,days[days.length-1].format];break;default:returnDates=[_graceDateServ.format(input,options.pattern)]}return returnDates.join(",")}}]),angular.module("grace.bootstrap.dateparser",[]).service("$gDateParserService",["$locale","orderByFilter",function(a,b){function c(a){var c=[],d=a.split("");return angular.forEach(e,function(b,e){var f=a.indexOf(e);if(f>-1){a=a.split(""),d[f]="("+b.regex+")",a[f]="$";for(var g=f+1,h=f+e.length;h>g;g++)d[g]="",a[g]="$";a=a.join(""),c.push({index:f,apply:b.apply})}}),{regex:new RegExp("^"+d.join("")+"$"),map:b(c,"index")}}function d(a,b,c){return 1===b&&c>28?29===c&&(a%4===0&&a%100!==0||a%400===0):3===b||5===b||8===b||10===b?31>c:!0}this.parsers={};var e={yyyy:{regex:"\\d{4}",apply:function(a){this.year=+a}},yy:{regex:"\\d{2}",apply:function(a){this.year=+a+2e3}},y:{regex:"\\d{1,4}",apply:function(a){this.year=+a}},MMMM:{regex:a.DATETIME_FORMATS.MONTH.join("|"),apply:function(b){this.month=a.DATETIME_FORMATS.MONTH.indexOf(b)}},MMM:{regex:a.DATETIME_FORMATS.SHORTMONTH.join("|"),apply:function(b){this.month=a.DATETIME_FORMATS.SHORTMONTH.indexOf(b)}},MM:{regex:"0[1-9]|1[0-2]",apply:function(a){this.month=a-1}},M:{regex:"[1-9]|1[0-2]",apply:function(a){this.month=a-1}},dd:{regex:"[0-2][0-9]{1}|3[0-1]{1}",apply:function(a){this.date=+a}},d:{regex:"[1-2]?[0-9]{1}|3[0-1]{1}",apply:function(a){this.date=+a}},w:{regex:"[1-9]|[1-5][0-9]",apply:function(a){this.date=+a}},ww:{regex:"0[1-9]|[1-5][0-9]",apply:function(a){this.date=+a}},EEEE:{regex:a.DATETIME_FORMATS.DAY.join("|")},EEE:{regex:a.DATETIME_FORMATS.SHORTDAY.join("|")}};this.parse=function(b,e){if(!angular.isString(b)||!e)return b;e=a.DATETIME_FORMATS[e]||e,this.parsers[e]||(this.parsers[e]=c(e));var f=this.parsers[e],g=f.regex,h=f.map,i=b.match(g);if(i&&i.length){for(var j,k={year:1900,month:0,date:1,hours:0},l=1,m=i.length;m>l;l++){var n=h[l-1];n.apply&&n.apply.call(k,i[l])}return d(k.year,k.month,k.date)&&(j=new Date(k.year,k.month,k.date,k.hours)),j}}}]),angular.module("grace.bootstrap.position",[]).factory("$position",["$document","$window",function(a,b){function c(a,c){return a.currentStyle?a.currentStyle[c]:b.getComputedStyle?b.getComputedStyle(a)[c]:a.style[c]}function d(a){return"static"===(c(a,"position")||"static")}var e=function(b){for(var c=a[0],e=b.offsetParent||c;e&&e!==c&&d(e);)e=e.offsetParent;return e||c};return{position:function(b){var c=this.offset(b),d={top:0,left:0},f=e(b[0]);f!=a[0]&&(d=this.offset(angular.element(f)),d.top+=f.clientTop-f.scrollTop,d.left+=f.clientLeft-f.scrollLeft);var g=b[0].getBoundingClientRect();return{width:g.width||b.prop("offsetWidth"),height:g.height||b.prop("offsetHeight"),top:c.top-d.top,left:c.left-d.left}},offset:function(c){var d=c[0].getBoundingClientRect();return{width:d.width||c.prop("offsetWidth"),height:d.height||c.prop("offsetHeight"),top:d.top+(b.pageYOffset||a[0].documentElement.scrollTop),left:d.left+(b.pageXOffset||a[0].documentElement.scrollLeft)}},positionElements:function(a,b,c,d){var e,f,g,h,i=c.split("-"),j=i[0],k=i[1]||"center";e=d?this.offset(a):this.position(a),f=b.prop("offsetWidth"),g=b.prop("offsetHeight");var l={center:function(){return e.left+e.width/2-f/2},left:function(){return e.left},right:function(){return e.left+e.width}},m={center:function(){return e.top+e.height/2-g/2},top:function(){return e.top},bottom:function(){return e.top+e.height}};switch(j){case"right":h={top:m[k](),left:l[j]()};break;case"left":h={top:m[k](),left:e.left-f};break;case"bottom":h={top:m[j](),left:l[k]()};break;default:h={top:e.top-g,left:l[k]()}}return h}}}]),angular.module("grace.bootstrap.datepicker",["grace.bootstrap.dateparser","grace.bootstrap.position","grace.bootstrap.date"]).constant("datepickerConfig",{formatMinute:"HH:mm",formatHour:"HH:mm",formatDay:"dd",formatMonth:"MMMM",formatYear:"yyyy",formatDayHeader:"EEE",formatMinuteTitle:"yyyy/MM/dd",formatHourTitle:"yyyy/MM/dd",formatWeekTitle:"yyyy/WW",formatDayTitle:"yyyy/MM",formatMonthTitle:"yyyy",datepickerMode:"day",minMode:"day",maxMode:"year",showWeeks:!0,startingDay:1,graceYearRange:20,minDate:null,maxDate:null,weekMode:!1}).controller("datepickerController",["$scope","$attrs","$parse","$interpolate","$timeout","$log","$locale","dateFilter","datepickerConfig","graceDateServ",function(a,b,c,d,e,f,g,h,i,j){function k(a){return n[a-1]}var l=this,m={$setViewValue:angular.noop};angular.extend(g.DATETIME_FORMATS,{DAY:["日","一","二","三","四","五","六"],SHORTDAY:["日","一","二","三","四","五","六"]}),this.modes=["minute","hour","day","month","year"],angular.forEach(["formatMinute","formatHour","formatDay","formatMonth","formatYear","formatDayHeader","formatMinuteTitle","formatHourTitle","formatDayTitle","formatMonthTitle","minMode","maxMode","showWeeks","startingDay","graceYearRange","weekMode"],function(c,e){l[c]=angular.isDefined(b[c])?11>e?d(b[c])(a.$parent):a.$parent.$eval(b[c]):i[c]}),angular.forEach(["minDate","maxDate"],function(d){b[d]?a.$parent.$watch(c(b[d]),function(a){l[d]=a?new Date(a):null,l.refreshView()}):l[d]=i[d]?new Date(i[d]):null}),a.datepickerMode=a.datepickerMode||i.datepickerMode,a.uniqueId="grace-datepicker-"+a.$id+"-"+Math.floor(1e4*Math.random()),l.activeDate=angular.isDefined(b.initDate)?a.$parent.$eval(b.initDate):new Date,a.isActive=function(b){return 0===l.compare(b.date,l.activeDate)?(a.activeDateId=b.uid,!0):!1},this.init=function(a){m=a,m.$render=function(){l.render()}},this.render=function(){if(m.$modelValue){var a=new Date(m.$modelValue),b=!isNaN(a);b?this.activeDate=a:f.error('Datepicker directive: "ng-model" value must be a Date object, a number of milliseconds since 01.01.1970 or a string representing an RFC2822 or ISO 8601 date.'),m.$setValidity("date",b)}this.refreshView()},this.refreshView=function(){if(this.element){this._refreshView();var a=m.$modelValue?new Date(m.$modelValue):null;m.$setValidity("date-disabled",!a||this.element&&!this.isDisabled(a))}},a.currentWeek=null;var n=["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"];this.createDateObject=function(a,b){var c=m.$modelValue?new Date(m.$modelValue):null;if(l.weekMode){var d=l.getWeekNumber(c),e=l.getWeekNumber(new Date),f=l.getWeekNumber(a);return{date:a,label:"MMMM"==b?k(parseInt(h(a,"M"))):h(a,b),selected:c&&f==d,disabled:this.isDisabled(a),current:e==f,weekend:6==a.getDay()||0==a.getDay(),weekIndex:f}}return{date:a,label:"MMMM"==b?k(parseInt(h(a,"M"))):h(a,b),selected:c&&0===this.compare(a,c),disabled:this.isDisabled(a),current:0===this.compare(a,new Date),weekend:6==a.getDay()||0==a.getDay()}},this.createWeekObject=function(a){var b=m.$modelValue?new Date(m.$modelValue):null;return console.log(b),angular.extend({},a,{selected:a.week==j.getISO8601WeekNumber(b)&&l.weekMode})},this.isDisabled=function(c){return this.minDate&&this.compare(c,this.minDate)<0||this.maxDate&&this.compare(c,this.maxDate)>0||b.dateDisabled&&a.dateDisabled({date:c,mode:a.datepickerMode})},this.split=function(a,b){for(var c=[];a.length>0;)c.push(a.splice(0,b));return c},a.select=function(b,c){if(l.weekMode&&angular.isArray(b)){if(c&&/^\d{4}-\d{2}$/.test(c)){var d=(c.split("-")[0],c.split("-")[1]);console.log(a),a.weekIndex=a.$parent.$parent.weekIndex=d,m.$setViewValue(l.minDate&&b[0]<new Date(l.minDate)?new Date(l.minDate):b[0]),m.$render()}}else if(a.datepickerMode===l.minMode){var e=m.$modelValue?new Date(m.$modelValue):new Date(0,0,0,0,0,0,0);e.setFullYear(b.getFullYear(),b.getMonth(),b.getDate()),e.setHours(b.getHours()),e.setMinutes(b.getMinutes()),m.$setViewValue(e),m.$render()}else l.activeDate=b,a.switchDisabled||(a.datepickerMode=l.modes[l.modes.indexOf(a.datepickerMode)-1])},a.move=function(a){var b=l.activeDate.getFullYear()+a*(l.step.years||0),c=l.activeDate.getMonth()+a*(l.step.months||0);l.activeDate.setFullYear(b,c,1),l.refreshView()},a.toggleMode=function(b){if(!a.switchDisabled){if(b=b||1,a.datepickerMode===l.maxMode&&1===b||a.datepickerMode===l.minMode&&-1===b)return;a.datepickerMode=l.modes[l.modes.indexOf(a.datepickerMode)+b]}},a.keys={13:"enter",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down"};var o=function(){e(function(){l.element[0].focus()},0,!1)};a.$on("datepicker.focus",o),a.keydown=function(b){var c=a.keys[b.which];if(c&&!b.shiftKey&&!b.altKey)if(b.preventDefault(),b.stopPropagation(),"enter"===c||"space"===c){if(l.isDisabled(l.activeDate))return;a.select(l.activeDate),o()}else!b.ctrlKey||"up"!==c&&"down"!==c?(l.handleKeyDown(c,b),l.refreshView()):(a.toggleMode("up"===c?1:-1),o())}}]).directive("graceDatepicker",function(){return{restrict:"EA",replace:!0,templateUrl:"template/datepicker/datepicker.html",scope:{datepickerMode:"=?",switchDisabled:"=?",dateDisabled:"&"},require:["graceDatepicker","?^ngModel"],controller:"datepickerController",link:function(a,b,c,d){var e=d[0],f=d[1];f&&e.init(f)}}}).directive("graceDaypicker",["dateFilter","graceDateServ",function(a,b){return{restrict:"EA",replace:!0,templateUrl:"template/datepicker/day.html",require:"^graceDatepicker",link:function(c,d,e,f){function g(a,b){return 1!==b||a%4!==0||a%100===0&&a%400!==0?i[b]:29}function h(a,b){var c=new Array(b),d=new Date(a),e=0;for(d.setHours(12);b>e;)c[e++]=new Date(d),d.setDate(d.getDate()+1);return c}c.showWeeks=f.showWeeks,f.step={months:1},f.element=d;var i=[31,28,31,30,31,30,31,31,30,31,30,31];f._refreshView=function(){var d=f.activeDate.getFullYear(),e=f.activeDate.getMonth(),g=new Date(d,e,1),i=f.startingDay-g.getDay(),j=i>0?7-i:-i,k=new Date(g);j>0&&k.setDate(-j+1);for(var l=h(k,42),m=0;42>m;m++)l[m]=angular.extend(f.createDateObject(l[m],f.formatDay),{secondary:l[m].getMonth()!==e,uid:c.uniqueId+"-"+m});c.labels=new Array(7);for(var n=0;7>n;n++)c.labels[n]={abbr:a(l[n].date,f.formatDayHeader),full:a(l[n].date,"EEEE")};if(c.rows=f.split(l,7),c.showWeeks){c.title=a(f.activeDate,f.formatDayTitle),c.weekNumbers=[];for(var o,p,q=c.rows.length,m=0;q>m;m++)o=c.rows[m][c.rows[m].length-1].date,p=b.getISO8601WeekNumber(o),c.weekNumbers.push(f.createWeekObject({year:o.getFullYear(),week:p}))}else c.title=a(f.activeDate,f.formatDayTitle)},f.compare=function(a,b){return new Date(a.getFullYear(),a.getMonth(),a.getDate())-new Date(b.getFullYear(),b.getMonth(),b.getDate())},c.selectWeek=function(a){c.select(b.getDatesByWeek(a.week,a.year),a.year+"-"+(a.week<10?"0"+a.week:a.week))},f.getWeekNumber=b.getISO8601WeekNumber,f.handleKeyDown=function(a,b){var c=f.activeDate.getDate();if("left"===a)c-=1;else if("up"===a)c-=7;else if("right"===a)c+=1;else if("down"===a)c+=7;else if("pageup"===a||"pagedown"===a){var d=f.activeDate.getMonth()+("pageup"===a?-1:1);f.activeDate.setMonth(d,1),c=Math.min(g(f.activeDate.getFullYear(),f.activeDate.getMonth()),c)}else"home"===a?c=1:"end"===a&&(c=g(f.activeDate.getFullYear(),f.activeDate.getMonth()));f.activeDate.setDate(c)},f.refreshView()}}}]).directive("graceHourpicker",["dateFilter",function(a){return{restrict:"EA",replace:!0,templateUrl:"template/datepicker/hour.html",require:"^graceDatepicker",link:function(b,c,d,e){e.element=c,e._refreshView=function(){for(var c=e.activeDate,d=new Array(25),f=c.getDate(),g=c.getMonth(),h=c.getFullYear(),i=0;24>i;i++)d[i]=angular.extend(e.createDateObject(new Date(h,g,f,i),e.formatHour),{uid:b.uniqueId+"-"+i});d[24]=null,b.title=a(e.activeDate,e.formatHourTitle),b.rows=e.split(d,5)},e.compare=function(a,b){return new Date(a.getFullYear(),a.getMonth(),a.getDate(),a.getHours())-new Date(b.getFullYear(),b.getMonth(),b.getDate(),b.getHours())},e.handleKeyDown=function(a,b){return},e.refreshView()}}}]).directive("graceMinutepicker",["dateFilter",function(a){return{restrict:"EA",replace:!0,templateUrl:"template/datepicker/minuteOrSecond.html",require:"^graceDatepicker",link:function(b,c,d,e){e.element=c;var f=5,g=5;e._refreshView=function(){for(var c=e.activeDate,d=60/f,h=Math.ceil(d/g)*g,i=new Array(h),j=c.getHours(),k=c.getDate(),l=c.getMonth(),m=c.getFullYear(),n=0;h>n;n++)i[n]=d>n?angular.extend(e.createDateObject(new Date(m,l,k,j,n*f),e.formatMinute),{uid:b.uniqueId+"-"+n}):{uid:b.uniqueId+"-"+n};b.title=a(e.activeDate,e.formatMinuteTitle),b.rows=e.split(i,g)},e.compare=function(a,b){return new Date(a.getFullYear(),a.getMonth(),a.getDate(),a.getHours(),a.getMinutes())-new Date(b.getFullYear(),b.getMonth(),b.getDate(),b.getHours(),b.getMinutes())},e.handleKeyDown=function(a,b){return},e.refreshView()}}}]).directive("graceMonthpicker",["dateFilter",function(a){return{restrict:"EA",replace:!0,templateUrl:"template/datepicker/month.html",require:"^graceDatepicker",link:function(b,c,d,e){e.step={years:1},e.element=c,e._refreshView=function(){for(var c=new Array(12),d=e.activeDate.getFullYear(),f=0;12>f;f++)c[f]=angular.extend(e.createDateObject(new Date(d,f,1),e.formatMonth),{uid:b.uniqueId+"-"+f});b.title=a(e.activeDate,e.formatMonthTitle),b.rows=e.split(c,3)},e.compare=function(a,b){return new Date(a.getFullYear(),a.getMonth())-new Date(b.getFullYear(),b.getMonth())},e.handleKeyDown=function(a,b){var c=e.activeDate.getMonth();if("left"===a)c-=1;else if("up"===a)c-=3;else if("right"===a)c+=1;else if("down"===a)c+=3;else if("pageup"===a||"pagedown"===a){var d=e.activeDate.getFullYear()+("pageup"===a?-1:1);e.activeDate.setFullYear(d)}else"home"===a?c=0:"end"===a&&(c=11);e.activeDate.setMonth(c)},e.refreshView()}}}]).directive("graceYearpicker",["dateFilter",function(a){return{restrict:"EA",replace:!0,templateUrl:"template/datepicker/year.html",require:"^graceDatepicker",link:function(a,b,c,d){function e(a){return parseInt((a-1)/f,10)*f+1}var f=d.graceYearRange;d.step={years:f},d.element=b,d._refreshView=function(){for(var b=new Array(f),c=0,g=e(d.activeDate.getFullYear());f>c;c++)b[c]=angular.extend(d.createDateObject(new Date(g+c,0,1),d.formatYear),{uid:a.uniqueId+"-"+c});a.title=[b[0].label,b[f-1].label].join(" - "),a.rows=d.split(b,5)},d.compare=function(a,b){return a.getFullYear()-b.getFullYear()},d.handleKeyDown=function(a,b){var c=d.activeDate.getFullYear();"left"===a?c-=1:"up"===a?c-=5:"right"===a?c+=1:"down"===a?c+=5:"pageup"===a||"pagedown"===a?c+=("pageup"===a?-1:1)*d.step.years:"home"===a?c=e(d.activeDate.getFullYear()):"end"===a&&(c=e(d.activeDate.getFullYear())+f-1),d.activeDate.setFullYear(c)},d.refreshView()}}}]).constant("datepickerPopupConfig",{graceDatepickerPopup:"yyyy-MM-dd",currentText:"Today",clearText:"Clear",closeText:"Done",enterText:"Enter",closeOnDateSelection:!1,appendToBody:!0,showButtonBar:!0,switchDisabled:!0,buttons:["current","close","clear"],rangeJoint:" 至 "}).directive("graceDatepickerPopup",["$compile","$parse","$document","$position","dateFilter","$gDateParserService","datepickerPopupConfig","$timeout","graceDateServ",function(a,b,c,d,e,f,g,h,i){return{restrict:"EA",require:"ngModel",scope:{isOpen:"=?",currentText:"@",clearText:"@",closeText:"@",enterText:"@",dateDisabled:"&",datepickerMode:"=?"},link:function(f,j,k,l){function m(a){return a.replace(/([A-Z])/g,function(a){return"-"+a.toLowerCase()})}function n(a){if(angular.isArray(a)){var b=[];return angular.forEach(a,function(a,c){b[c]=n(a)}),
b}return a}function o(){l.$setViewValue(f.date),l.$render()}function p(a,b){var c=i.getISO8601WeekNumber(a),d=e(a,b);return b.indexOf("ww")>-1?d.replace("ww",c>9?c:"0"+c):d.replace("w",c)}var q,r=angular.isDefined(k.closeOnDateSelection)?f.$parent.$eval(k.closeOnDateSelection):g.closeOnDateSelection,s=angular.isDefined(k.datepickerAppendToBody)?f.$parent.$eval(k.datepickerAppendToBody):g.appendToBody,t=angular.isDefined(k.buttons)?f.$parent.$eval(k.buttons):g.buttons,u=angular.isDefined(k.rangeJoint)?f.$parent.$eval(k.rangeJoint):g.rangeJoint,v=angular.isDefined(k.onEnter)?f.$parent.$eval(k.onEnter):void 0,w=angular.isDefined(k.onClose)?f.$parent.$eval(k.onClose):void 0,x=f.$parent.$eval(k.ngModel);if(f.uniqId="graceDataPikcerPopupWrap"+f.$id+"_"+(new Date).getTime(),f.showButtonBar=angular.isDefined(k.showButtonBar)?f.$parent.$eval(k.showButtonBar):g.showButtonBar,f.datepickerMode=k.datepickerMode,f.switchDisabled=angular.isDefined(k.switchDisabled)?f.$parent.$eval(k.switchDisabled):g.switchDisabled,-1!=t.indexOf("current")&&(f.showCurrentButton=!0),-1!=t.indexOf("clear")&&(f.showClearButton=!0),-1!=t.indexOf("enter")&&(f.showEnterButton=!0),-1!=t.indexOf("close")&&(f.showCloseButton=!0),f.getText=function(a){return f[a+"Text"]||g[a+"Text"]},k.$observe("graceDatepickerPopup",function(a){q=a||g.graceDatepickerPopup,l.$render()}),angular.isArray(x))var y=angular.element("<div grace-datepicker-popup-wrap><div grace-datepicker-range ></div></div>");else var y=angular.element("<div grace-datepicker-popup-wrap><div grace-datepicker ></div></div>");y.attr({"ng-model":"date","ng-change":"dateSelection()"});var z=angular.element(y.children()[0]);k.datepickerOptions&&angular.forEach(f.$parent.$eval(k.datepickerOptions),function(a,b){z.attr(m(b),a)}),f.watchData={},angular.forEach(["minDate","maxDate","datepickerMode","switchDisabled"],function(a){if(k[a]){var c=b(k[a]);if(f.$parent.$watch(c,function(b){f.watchData[a]=b}),z.attr(m(a),"watchData."+a),"datepickerMode"===a){var d=c.assign;f.$watch("watchData."+a,function(a,b){a!==b&&d(f.$parent,a)})}}}),k.dateDisabled&&z.attr("date-disabled","dateDisabled({ date: date, mode: mode })"),l.$parsers.unshift(n),f.dateSelection=function(a){angular.isDefined(a)&&(f.date=a),o(),r&&(f.isOpen=!1,j[0].focus())},j.bind("input change keyup",function(){f.$apply(function(){f.date=l.$modelValue})}),l.$render=function(){if(angular.isArray(l.$viewValue)){var a=[];f.date=[],angular.forEach(l.$viewValue,function(b,c){a[c]=e(b,q)}),j.val(a.join(u)),f.date=n(l.$modelValue)}else{if(q&&-1!=q.indexOf("w"))var a=l.$viewValue?p(l.$viewValue,q):"";else var a=l.$viewValue?e(l.$viewValue,q):"";j.val(a),f.date=n(l.$modelValue)}};var A=function(a){f.isOpen&&a.target!==j[0]&&f.$apply(function(){f.isOpen=!1})},B=function(a,b){f.keydown(a)};j.bind("keydown",B),f.keydown=function(a){27===a.which?(a.preventDefault(),a.stopPropagation(),f.close()):40!==a.which||f.isOpen||(f.isOpen=!0)},f.$watch("isOpen",function(a){if(a){f.$broadcast("graceDatepicker.focus"),f.position=s?d.offset(j):d.position(j);var b=angular.element("#"+f.uniqId);b.css("visibility","hidden"),h(function(){f.$apply(function(){var a=b.prop("offsetWidth");f.position.left+a>screen.width&&(f.position.left=screen.width-a),b.css("visibility","visible")})},0,!1),f.position.top=f.position.top+j.prop("offsetHeight"),c.bind("click",A)}else c.unbind("click",A)}),f.select=function(a){if("today"===a){var b=new Date;angular.isDate(l.$modelValue)?(a=new Date(l.$modelValue),a.setFullYear(b.getFullYear(),b.getMonth(),b.getDate())):a=new Date(b.setHours(0,0,0,0))}f.dateSelection(a)},f.close=function(){f.isOpen=!1,j[0].focus(),angular.isFunction(w)&&w.call(f.$parent)},f.enter=function(){f.isOpen=!1,j[0].focus(),angular.isFunction(v)&&v.call(f.$parent,j.val())};var C=a(y)(f);s?c.find("body").append(C):j.after(C),f.$on("$destroy",function(){C.remove(),j.unbind("keydown",B),c.unbind("click",A)})}}}]).directive("graceDatepickerPopupWrap",function(){return{restrict:"EA",replace:!0,transclude:!0,templateUrl:"template/datepicker/popup.html",link:function(a,b,c){b.bind("click",function(a){a.preventDefault(),a.stopPropagation()})}}}).constant("daterangepickerConfig",{pickerCount:1}).controller("datepickerRangeController",["$scope","$attrs","$parse","$interpolate","$timeout","$log","dateFilter","datepickerConfig","daterangepickerConfig",function(a,b,c,d,e,f,g,h,i){var j=this,k={$setViewValue:angular.noop};this.modes=["day","month","year"],angular.forEach(["formatDay","formatMonth","formatYear","formatDayHeader","formatDayTitle","formatMonthTitle","minMode","maxMode","showWeeks","startingDay","graceYearRange","pickerCount"],function(c,e){j[c]=angular.isDefined(b[c])?8>e?d(b[c])(a.$parent):a.$parent.$eval(b[c]):i[c]||h[c]}),angular.forEach(["minDate","maxDate"],function(d){b[d]?a.$parent.$watch(c(b[d]),function(a){j[d]=a?new Date(a):null,j.refreshView()}):j[d]=h[d]?new Date(h[d]):null}),a.datepickerMode=a.datepickerMode||h.datepickerMode,a.uniqueId="grace-datepicker-"+a.$id+"-"+Math.floor(1e4*Math.random()),a.isActive=function(b){return 0===j.compare(b.date,j.activeDate)?(a.activeDateId=b.uid,!0):!1},this.init=function(a){k=a,k.$render=function(){j.render()}},this.render=function(){if(k.$modelValue){var a=new Date(k.$modelValue[0]),b=new Date(k.$modelValue[1]),c=!isNaN(a)&&!isNaN(b);c&&!this.activeDate?this.activeDate=[a,b]:c||f.error('DateRangepicker directive: "ng-model" value must be a Array of Date objects, numbers of milliseconds since 01.01.1970 or strings representing an RFC2822 or ISO 8601 date.'),k.$setValidity("date",c)}this.refreshView()},this.refreshView=function(){this.element&&this._refreshView()},this.createDateObject=function(a,b){var c,d,c=d=null;return k.$modelValue&&(c=new Date(k.$modelValue[0]),d=new Date(k.$modelValue[1])),{date:a,label:g(a,b),selected:c&&d&&this.compare(a,c,d),disabled:this.isDisabled(a),current:!1,weekend:6==a.getDay()||0==a.getDay()}},this.isDisabled=function(c){return this.minDate&&this.compare(c,this.minDate)<0||this.maxDate&&this.compare(c,this.maxDate)>0||b.dateDisabled&&a.dateDisabled({date:c,mode:a.datepickerMode})},this.split=function(a,b){for(var c=[];a.length>0;)c.push(a.splice(0,b));return c},a.select=function(b){if(!j._select||j._select(b,k))if(a.datepickerMode===j.minMode){var c=k.$modelValue?new Date(k.$modelValue):new Date(0,0,0,0,0,0,0);c.setFullYear(b.getFullYear(),b.getMonth(),b.getDate()),k.$setViewValue(c),k.$render()}else j.activeDate=b,a.datepickerMode=j.modes[j.modes.indexOf(a.datepickerMode)-1]},a.move=function(a){var b=j.activeDate[0].getFullYear()+a*(j.step.years||0),c=j.activeDate[0].getMonth()+a*(j.step.months||0),d=j.activeDate[1].getFullYear()+a*(j.step.years||0),e=j.activeDate[1].getMonth()+a*(j.step.months||0);j.activeDate[0].setFullYear(b,c,1),j.activeDate[1].setFullYear(d,e,1),j.refreshView()},a.toggleMode=function(a){},a.keys={13:"enter",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down"};var l=function(){e(function(){j.element[0].focus()},0,!1)};a.$on("datepicker.focus",l),a.keydown=function(b){var c=a.keys[b.which];if(c&&!b.shiftKey&&!b.altKey)if(b.preventDefault(),b.stopPropagation(),"enter"===c||"space"===c){if(j.isDisabled(j.activeDate))return;a.select(j.activeDate),l()}else!b.ctrlKey||"up"!==c&&"down"!==c?(j.handleKeyDown(c,b),j.refreshView()):(a.toggleMode("up"===c?1:-1),l())}}]).directive("graceDatepickerRange",function(){return{restrict:"EA",replace:!0,templateUrl:"template/datepicker/daterangepicker.html",scope:{datepickerMode:"=?",quickSelectMode:"=?",dateDisabled:"&"},require:["graceDatepickerRange","?^ngModel"],controller:"datepickerRangeController",link:function(a,b,c,d){var e=d[0],f=d[1];f&&e.init(f)}}}).directive("graceDaypickerRange",["dateFilter","graceDateServ",function(a,b){return{restrict:"EA",replace:!0,templateUrl:"template/datepicker/dayrange.html",require:"^graceDatepickerRange",link:function(c,d,e,f){function g(a,b){var c=new Array(b),d=new Date(a),e=0;for(d.setHours(12);b>e;)c[e++]=new Date(d),d.setDate(d.getDate()+1);return c}function h(a,b){var c=new Date(a,b,1),d=f.startingDay-c.getDay(),e=d>0?7-d:-d,g=new Date(c);return e>0&&g.setDate(-e+1),g}function i(a,b,c){return 3==arguments.length?i(a,b)>=0&&i(a,c)<=0:new Date(a.getFullYear(),a.getMonth(),a.getDate())-new Date(b.getFullYear(),b.getMonth(),b.getDate())}c.showWeeks=f.showWeeks,f.step={months:1},f.element=d;var j=0;f._select=function(a,b){var c;return c=b.$modelValue&&b.$modelValue[1]?0==j?[new Date(a.getFullYear(),a.getMonth(),a.getDate()),new Date(a.getFullYear(),a.getMonth(),a.getDate())]:i(a,b.$modelValue[0])<0?[new Date(a.getFullYear(),a.getMonth(),a.getDate()),new Date(b.$modelValue[1])]:[new Date(b.$modelValue[0]),new Date(a.getFullYear(),a.getMonth(),a.getDate())]:[new Date(0,0,0,0,0,0,0),new Date(0,0,0,0,0,0,0)],b.$setViewValue(c),b.$render(),j=++j%2,!1},f._refreshView=function(){var d=f.activeDate[0].getFullYear(),e=f.activeDate[0].getMonth(),i=f.activeDate[1].getFullYear(),j=f.activeDate[1].getMonth(),k=12*(i-d)+(j-e)+1,l=0;for(k=parseInt(f.pickerCount)||k,c.titles=[],c.rowsGroup=[],c.weekNumbersGroup=[];k>l;){for(var m=(e+l)%12,n=d+Math.floor((e+l)/12),o=h(n,m),p=g(o,42),q=0;42>q;q++)p[q]=angular.extend(f.createDateObject(p[q],f.formatDay),{secondary:p[q].getMonth()!==m,uid:c.uniqueId+"-"+q});c.titles.push(a(new Date(n,m,1),f.formatDayTitle));var r=f.split(p,7);if(c.showWeeks){for(var s,t,u=[],v=r.length,q=0;v>q;q++)s=r[q][r[q].length-1].date,t=b.getISO8601WeekNumber(s),u.push({year:s.getFullYear(),week:t});c.weekNumbersGroup.push(u)}c.rowsGroup.push(r),l++}c.labels=new Array(7);for(var w=0;7>w;w++)c.labels[w]={abbr:a(c.rowsGroup[0][0][w].date,f.formatDayHeader),full:a(c.rowsGroup[0][0][w].date,"EEEE")}},f.compare=i,f.handleKeyDown=function(a,b){return},f.refreshView()}}}]);var app=angular.module("grace.bootstrap.dimension",["grace.bootstrap.position"]).constant("dimensionConfig",{autoIncrement:!1,dimensionContrast:!1,showDimension23:!1,showDimension45:!1,enableContrast:!0,isCodeUniq:!1}).controller("dimensionController",["$scope","dimensionConfig","$http","dimensionFactory",function(a,b,c,d){function e(){a._initSelect=null;for(;n.length;)a.nodeClick(null,n[0])}function f(b){a.selected[b.code]?delete a.selected[b.code]:a.selected[b.code]=d.makeNodeChainInfo(b.code,a.nodeIndex)}function g(){for(var b,c=0;b=n[c];)a.nodeClick(null,b);a.nodeClick(null,a.dimensionData[0].children[0]),a.onAction()}function h(a){for(var b,c="object"==typeof a?a.code:a,d=0;b=n[d];d++)if(b.code==c)return b;return!1}function i(a){for(var b,c=0;b=n[c];c++)if(b.code==a.code)return n.splice(c,1)}function j(a){return n[0]?n[0].level==a.level?!0:void 0:!0}function k(b,c){if(b){var d=angular.element(b.target),e=d.parent().siblings(".grace-dimension-searchbox");23==e.attr("level")?a.closeSearchBox(23):45==e.attr("level")&&a.closeSearchBox(45),e.val(c?"":d.text())}}function l(a){for(var b in a)return!1;return!0}a.dContrast=b.dimensionContrast,void 0==a.isContrast&&(a.isContrast=b.dimensionContrast),void 0==a.enableContrast&&(a.enableContrast=b.enableContrast),a.showDimension23=b.showDimension23,a.showDimension45=b.showDimension45,a.searchResult23={},a.searchResult23Empty=!0,a.searchResult45={},a.searchResult45Empty=!0,a.searchKeyWord23="",a.searchKeyWord45="",a.$watch("dimensionData",function(b){b&&(e(),a.nodeIndex=d.createNodeIndex(a.dimensionData,a),a._initSelect&&(a._initSelect.checked=!1),m=a.isContrast?2:1,a.nodeClick(null,a._initSelect||a.dimensionData[0].children[0]),a.onAction())});var m=1;a.checkContrast=function(){return a.enableContrast?(a.isContrast=!a.isContrast,a.onContrastSwitchClick&&a.onContrastSwitchClick(a.isContrast),m=a.isContrast?2:1,void(a.isContrast||2!=n.length||g())):void(a.onContrastSwitchClick&&a.onContrastSwitchClick(!1))},a.selected={};var n=a.selectedNode=[];a.cancelSelect=function(b){var c=h(b);c&&a.nodeClick(null,c)},a.nodeClick=function(a,b){if(!b.unavailable)if(h(b))b.checked=!b.checked,i(b),f(b),k(a,!0);else if(!h(b)&&n.length<m)j(b)?(n.push(b),b.checked=!b.checked,f(b),k(a,!1)):alert("维度应该在同一级");else if(!h(b)&&n.length==m&&m>1)alert("维度选择超数量限制");else if(!h(b)&&n.length==m&&1==m){var c=n.shift();c.checked=!c.checked,f(c),n.push(b),b.checked=!b.checked,f(b),k(a,!1)}},a.curLevel1Node=null,a.curLevel3Node=null,a.showSubDimension=function(b,c){1==c.level?(a.curLevel1Node&&a.curLevel1Node!=c.code?null!==a.curLevel1Node&&a.curLevel1Node!=c.code&&(a.showDimension23=!0):a.showDimension23=!a.showDimension23,a.curLevel1Node=c.code,a.curDimensionData23=c,a.showDimension45=!1):3==c.level&&(a.curLevel3Node&&a.curLevel3Node!=c.code?null!==a.curLevel3Node&&a.curLevel3Node!=c.code&&(a.showDimension45=!0):a.showDimension45=!a.showDimension45,a.curLevel3Node=c.code,a.curDimensionData45=c)},a.doSearch=function(b,c){"23"==c?(a.searchResult23=d.searchNode(b,a.curDimensionData23,function(a){return-1!=a.name.indexOf(b)&&(3==a.level||2==a.level)}),a.searchResult23Empty=l(a.searchResult23),a.$apply()):"45"==c&&(a.searchResult45=d.searchNode(b,a.curDimensionData45,function(a){return-1!=a.name.indexOf(b)&&(5==a.level||4==a.level)}),a.searchResult45Empty=l(a.searchResult45),a.$apply())},a.closeSearchBox=function(b){23==b?(a.searchResult23={},a.searchResult23Empty=!0):45==b&&(a.searchResult45={},a.searchResult45Empty=!0)},a.onAction=function(){n.length<m||(b.isCodeUniq?a.action(n,a.selected):a.action(d.restoreNode(n),d.restoreNodeChain(a.selected,a.nodeIndex)))}}]).factory("dimensionFactory",["dimensionConfig",function(a){function b(b,d){var e={};return!k&&(k=d),a.isCodeUniq||c(b),f(b,e,null,null,0),e}function c(a){for(var b,d=0;b=a[d];d++)b.children&&b.children.length&&c(b.children),b.oldCode=b.code,b.code=j++,!k._initSelect&&b.checked&&(k._initSelect=b)}function d(a){for(var b,c=[],d=0;b=a[d];d++){var e={code:b.oldCode,name:b.name};c.push(e)}return c}function e(a,b){var c={};for(var d in a){var e=a[d];c[b[d].oldCode]=e}return c}function f(a,b,c,d,e){for(var g,h=0;g=a[h];h++)g.children&&g.children.length&&f(g.children,b,g.code,d,void 0!=e?e+1:void 0),(!d||d(g))&&(b[g.code]=g,g.pcode=c||null,void 0!=e&&(g.level=e))}function g(a,b){var c={nameChain:[],codeChain:[]};return h(a,c,b),c.nameChain.reverse(),c.codeChain.reverse(),c}function h(b,c,d){var e=d[b];e&&a.isCodeUniq?(c.nameChain.push(e.name),c.codeChain.push(e.code),h(e.pcode,c,d)):e&&!a.isCodeUniq&&e.oldCode&&(c.nameChain.push(e.name),c.codeChain.push(e.oldCode),h(e.pcode,c,d))}function i(a,b,c){var d={};return f(b.children,d,b.code,c),d}var j=1,k=null;return{createNodeIndex:b,makeNodeChainInfo:g,searchNode:i,restoreNode:d,restoreNodeChain:e}}]).directive("graceDimension",["$window","$position",function(a,b){return{restrict:"EA",require:["graceDimension"],controller:"dimensionController",templateUrl:"template/dimension/dimension.html",replace:!0,scope:{dimensionData:"=",action:"=",enableContrast:"=",isContrast:"=",onContrastSwitchClick:"=?"},link:function(c,d,e,f){function g(a,b){var c=!0;return function(d){c&&(a(d),c=!1,setTimeout(function(){c=!0},b))}}var h=angular.element(a);c.showContrastOption="false"!=e.showContrastOption,h.on("click",function(){c.$apply(function(){c.showDimension45=!1,c.showDimension23=!1}),k&&k.css({height:"auto"}),l&&l.css({height:"auto"})});var i=angular.element(".grace-section-dimension23"),j=angular.element(".grace-section-dimension45");i.on("click",function(a){i.find(".grace-dimension-searchbox").val(""),c.$apply(function(){c.closeSearchBox(23)});var b=angular.element(a.target);b.hasClass(".grace-dimension-dropdown")||"I"==a.target.tagName||(c.$apply(function(){c.closeSearchBox(45),c.showDimension45=!1}),a.originalEvent.cancelBubble=!0)}),j.on("click",function(a){j.find(".grace-dimension-searchbox").val(""),c.$apply(function(){c.closeSearchBox(45)}),a.originalEvent.cancelBubble=!0});var k=null,l=null,m=null;d.on("click",".grace-dimension-dropdown",function(a){m=angular.element(a.currentTarget);var c=m.parent(),d=b.position(c),e=b.offset(c);if(m.hasClass("level1")){var f=k=m.parent().parent();f.css({height:"auto"});var g=b.offset(f);f.append(i),i.css({top:e.top+e.height+8-g.top}),i.find(".grace-dimension-arrow").css({left:d.left+d.width/2});var h=b.offset(i);h.top+h.height>g.height+g.top&&f.css({height:h.top-g.top+h.height}),a.originalEvent.cancelBubble=!0}else if(m.hasClass("level3")&&!j.hasClass("ng-hide")){var f=l=m.parent().parent().parent().parent().parent();f.append(j),j.css({top:"auto"});var n=(b.offset(j),b.offset(i));j.css({top:e.top-n.top+e.height+8,left:0}),j.find(".grace-dimension-arrow").css({left:d.left+d.width/2}),a.originalEvent.cancelBubble=!0}else m.hasClass("level3")&&j.hasClass("ng-hide")&&(i.css({height:"auto"}),a.originalEvent.cancelBubble=!0)}),d.find(".grace-search-group").on("click",function(a){a.originalEvent.cancelBubble=!0});var n=g(function(a){var b=angular.element(a.target),d=b.val();d?c.doSearch(d,b.attr("level")):b.parent().find(".grace-searchbox-closebtn").triggerHandler("click")},100);d.find(".grace-dimension-searchbox").bind("keyup",n),d.find(".grace-searchbox-closebtn").bind("click",function(a){var b=angular.element(a.target);b.parent().find(".grace-dimension-searchbox").val("")})}}}]);angular.module("grace.bootstrap.dimensionBaseSelect",["template/dimensionBaseSelect/dimensionBaseSelect.html"]).controller("dimensionBaseSelectController",["$scope","$attrs","$parse",function(a,b,c){var d=this,e={$setViewValue:angular.noop},f=!1;a.lastSelect=angular.noop,this.init=function(a){e=a},a.$watch("data",function(){a.data&&d.render()}),a.$watch(a.getHideListValue,function(){1==f&&(a.selStatus=[""])},!0),a.getHideListValue=function(){return f},a.keyUp=function(b,c){var d=$(b.target).val();a.selStatus[0]=d},this.render=function(){if(a.selStatus=[],a.data.detail&&a.data.detail.length>0)if("all"==a.data.detail[0].code.toLowerCase().substring(a.data.detail[0].code.length-3))for(var b=0;b<a.data.detail.length;b++)"custom"!=a.data.detail[b].code&&a.selStatus.push(a.data.detail[b].code);else if(a.isMult)for(var b=0;b<a.data.detail.length;b++)1==a.data.detail[b].selected&&a.selStatus.push(a.data.detail[b].code);else{for(var b=0;b<a.data.detail.length;b++)if(1==a.data.detail[b].selected){a.selStatus.push(a.data.detail[b].code);break}0==a.selStatus.length&&a.selStatus.push(a.data.detail[0].code)}a.lastSelect=angular.copy(a.selStatus),e.$setViewValue(a.selStatus)},a.rankValue=function(){var b=angular.copy(a.selStatus);a.selStatus.length=0;for(var c,d=0;c=a.data.detail[d];d++)for(var e,f=0;e=b[f];f++)c.code==e&&a.selStatus.push(e)},a.select=function(b,c){if("custom"==b.code)a.hideList=!a.hideList;else{if(a.isMult){if(-1!=a.selStatus.indexOf(b.code))"all"==a.selStatus[0].toLowerCase().substring(a.selStatus[0].length-3)&&a.selStatus.shift(),"all"!=b.code.toLowerCase().substring(b.code.length-3)&&a.selStatus.splice(a.selStatus.indexOf(b.code),1);else if("all"==b.code.toLowerCase().substring(b.code.length-3)){a.selStatus=[];for(var d=0;d<a.data.detail.length;d++)a.selStatus.push(a.data.detail[d].code);a.selStatus.shift()}else a.selStatus.push(b.code),a.rankValue();a.selStatus.length==a.data.detail.length-1&&a.selStatus.indexOf("$scope.data.detail[0].code")<0&&a.selStatus.unshift(a.data.detail[0].code)}else if("all"==b.code.toLowerCase().substring(b.code.length-3)){a.selStatus=[];for(var d=0;d<a.data.detail.length;d++)a.selStatus.push(a.data.detail[d].code);a.selStatus.pop()}else a.selStatus=[b.code];a.lastSelect=angular.copy(a.selStatus)}e.$setViewValue(a.selStatus)},a["return"]=function(){a.selStatus=angular.copy(a.lastSelect),a.hideList=!a.hideList,e.$setViewValue(a.selStatus)}}]).directive("graceDimensionBaseSelect",function(){return{restrict:"E",replace:!0,templateUrl:"template/dimensionBaseSelect/dimensionBaseSelect.html",scope:{data:"=data",isMult:"=ismult"},require:["graceDimensionBaseSelect","?^ngModel"],controller:"dimensionBaseSelectController",link:function(a,b,c,d){var e=d[0],f=d[1];f&&e.init(f)}}}),angular.module("grace.bootstrap.dimensionSelectWithCheckBox",["template/dimensionBaseSelect/dimensionSelectWithCheckBox.html"]).directive("graceDimensionSelectWithCheckBox",function(){return{restrict:"E",replace:!0,transclude:!0,templateUrl:"template/dimensionBaseSelect/dimensionSelectWithCheckBox.html",scope:{data:"=data"},require:["ngModel"],link:function(a,b,c,d){function e(a,b){this.code=a,this.newName=b}function f(a,b){var c=a.indexOf(b);return c>=0&&a.splice(c,1),b}function g(a,b){var c=!1;return a.indexOf(b)>=0&&(c=!0),c}a.allSelStatus=[],a.allOrderType=[],a._orderType=[],a.selStatus=[],a.lastDi={};var h=d[0];a.$watch("data",function(){if(a.data){if(a.data.detail&&a.data.detail.length>0)for(var b=0;b<a.data.detail.length;b++)if(a.data.detail[b].detail)for(var c=a.data.detail[b].detail,d=0;d<c.length;d++){a.allSelStatus.push(c[d].code);var f=new e(c[d].code,a.data.detail[b].name+"-"+c[d].name);a.allOrderType.push(f),c[d].selected&&(a.selStatus.push(c[d].code),a._orderType.push(f))}else a.allSelStatus.push(a.data.detail[b].code),1==a.data.detail[b].selected&&a.selStatus.push(a.data.detail[b].code);h.$setViewValue(a.selStatus,a._orderType)}}),a.changeAllStatus=function(){a.allSelStatus.length-1>a.selStatus.length||(g(a.selStatus,a.allSelStatus[0])?f(a.selStatus,a.allSelStatus[0]):a.selStatus=angular.copy(a.allSelStatus,[]))},a.updateShowButtonForCheck=function(b,c){if(g(a.selStatus,b))a.updateShowButton(b,c),a.rankValue();else{a.selStatus.push(b);for(var d=0;d<a.allOrderType.length;d++)if(b==a.allOrderType[d].code){a._orderType.push(a.allOrderType[d]);break}a._orderType.sort(function(b,c){var d,e;return d=a.allOrderType.indexOf(b),e=a.allOrderType.indexOf(c),d-e}),a.changeAllStatus(),a.rankValue()}h.$setViewValue(a.selStatus)},a.updateShowButton=function(b,c){if(!c)for(var d,e=0;d=a.data.detail[e];e++)if(d.detail)for(var g,i=0;g=d.detail[i];i++)if(g.code==b){c=d;break}c._checked=!1,f(a.selStatus,b);for(var e=0;e<a._orderType.length;e++)if(b==a._orderType[e].code){f(a._orderType,a._orderType[e]);break}a.rankValue(),a.changeAllStatus(),h.$setViewValue(a.selStatus,a._orderType)},a.rankValue=function(){var b=angular.copy(a.selStatus);a.selStatus.length=0;for(var c,d=0;c=a.data.detail[d];d++)if(c.detail)for(var e,f=0;e=c.detail[f];f++)for(var g,h=0;g=b[h];h++)e.code==g&&a.selStatus.push(g);else for(var g,h=0;g=b[h];h++)c.code==g&&a.selStatus.push(g)},a.select=function(b,c,d){if(a.lastDi.showCheckBoxList=!1,a.lastDi.checkboxselect=!1,a.lastDi.isDrop=!1,"all"==b.code.toLowerCase().substring(b.code.length-3)||0==c){if(g(a.selStatus,b.code))return;a.selStatus=angular.copy(a.allSelStatus,[]),a._orderType=angular.copy(a.allOrderType,[])}else b.detail?(b.isDrop=!0,a.lastDi.checkboxselect=!1,b.showCheckBoxList=!0,b.checkboxselect=!0,a.lastDi=b):(g(a.selStatus,b.code)?f(a.selStatus,b.code):a.selStatus.push(b.code),a.changeAllStatus(),a.rankValue(),h.$setViewValue(a.selStatus));h.$setViewValue(a.selStatus)},a.hideCheckboxList=function(a){a.showCheckBoxList=!1,a.checkboxselect=!1,a.isDrop=!1},a.hideCheckboxListForClick=function(a,b,c){b&&(a.showCheckBoxList=!1,a.checkboxselect=!1,a.isDrop=!1,c.stopPropagation())}}}}),angular.module("grace.bootstrap.dimensionSelectWithCustom",["template/dimensionBaseSelect/dimensionSelectWithCustom.html"]).controller("dimensionSelectWithCustomController",["$scope","$attrs","$parse",function(a,b,c){a.isCustom=function(a){return"custom"==a.code},a.isBrand=function(){return"statisticalClassification"==a.code}}]).directive("graceDimensionSelectWithCustom",function(){return{restrict:"E",replace:!0,templateUrl:"template/dimensionBaseSelect/dimensionSelectWithCustom.html",scope:{data:"=data",isMult:"=ismult",code:"=code"},require:["ngModel"],controller:"dimensionSelectWithCustomController",link:function(a,b,c,d){a.selStatus=[],a.$watch("data",function(b){if(b){var c=a.data.detail.length;if(a.data.detail&&a.data.detail.length>0)if("all"==a.data.detail[0].code.toLowerCase().substring(a.data.detail[0].code.length-3))for(var e=0;e<a.data.detail.length;e++)"custom"!=a.data.detail[e].code?a.selStatus.push(a.data.detail[e].code):c--;else if(a.isMult)for(var e=0;e<a.data.detail.length;e++)1==a.data.detail[e].selected&&a.selStatus.push(a.data.detail[e].code);else{for(var e=0;e<a.data.detail.length;e++)if(1==a.data.detail[e].selected){a.selStatus.push(a.data.detail[e].code);break}0==a.selStatus.length&&a.selStatus.push(a.data.detail[0].code)}var f=d[0];f.$setViewValue(a.selStatus);a.lastSelect=angular.copy(a.selStatus),a["return"]=function(){a.$parent.cancelCustom&&a.$parent.cancelCustom(),a.selStatus=angular.copy(a.lastSelect),a.hideList=!a.hideList,f.$setViewValue(a.selStatus)},a.select=function(b,d){if(a.isBrand()&&a.$parent.switchBrand&&a.$parent.switchBrand(b),"custom"==b.code)a.hideList=!a.hideList,a.customSelected=!0,document.getElementById("graceDiCusInputBox").value="";else{if(a.customSelected=!1,a.isMult){if(-1!=a.selStatus.indexOf(b.code))"all"==a.selStatus[0].toLowerCase().substring(a.selStatus[0].length-3)&&a.selStatus.shift(),"all"!=b.code.toLowerCase().substring(b.code.length-3)&&a.selStatus.splice(a.selStatus.indexOf(b.code),1);else if("all"==b.code.toLowerCase().substring(b.code.length-3)){a.selStatus=[];for(var e=0;c>e;e++)a.selStatus.push(a.data.detail[e].code)}else a.selStatus.push(b.code);a.selStatus.length==c-1&&a.selStatus.indexOf("$scope.data.detail[0].code")<0&&a.selStatus.unshift(a.data.detail[0].code)}else if("all"==b.code.toLowerCase().substring(b.code.length-3)){a.selStatus=[];for(var e=0;c>e;e++)a.selStatus.push(a.data.detail[e].code)}else a.selStatus=[b.code];a.lastSelect=angular.copy(a.selStatus)}f.$setViewValue(a.selStatus)}}})}}}),angular.module("grace.bootstrap.dimensionSelectWithRadioBox",["template/dimensionBaseSelect/dimensionSelectWithRadioBox.html"]).directive("graceDimensionSelectWithRadioBox",function(){return{restrict:"E",replace:!0,transclude:!0,templateUrl:"template/dimensionBaseSelect/dimensionSelectWithRadioBox.html",scope:{data:"=data"},require:["ngModel"],link:function(a,b,c,d){function e(a,b){this.code=a,this.newName=b}function f(a,b){var c=a.indexOf(b);return c>=0&&a.splice(c,1),b}function g(a,b){var c=!1;return a.indexOf(b)>=0&&(c=!0),c}a.allSelStatus=[],a.allOrderType=[],a._orderType=[],a.selStatus=[],a.lastDi={};var h=d[0];a.$watch("data",function(){if(a.data){if(a.data.detail&&a.data.detail.length>0)for(var b=0;b<a.data.detail.length;b++)if(a.data.detail[b].detail)for(var c=a.data.detail[b].detail,d=0;d<c.length;d++){var f=new e(c[d].code,a.data.detail[b].name+"-"+c[d].name);a.allOrderType.push(f),c[d].selected&&(a.allSelStatus.push(c[d].code),a.selStatus.push(c[d].code),a._orderType.push(f))}else a.allSelStatus.push(a.data.detail[b].code),1==a.data.detail[b].selected&&a.selStatus.push(a.data.detail[b].code);h.$setViewValue(a.selStatus,a._orderType);var g={};g.code="orderTypeAll",a.select(g,0)}}),a.changeAllStatus=function(){a.allSelStatus.length-1>a.selStatus.length||(g(a.selStatus,a.allSelStatus[0])?f(a.selStatus,a.allSelStatus[0]):a.selStatus=angular.copy(a.allSelStatus,[]))},a.updateShowButtonForCheck=function(b){a.selStatus=[];for(var c=0;c<a.allOrderType.length;c++)if(b==a.allOrderType[c].code){a._orderType=[],a._orderType.push(a.allOrderType[c]);break}return a.selStatus.push(a.allOrderType[c].code),a.changeAllStatus(),void h.$setViewValue(a.selStatus);var c},a.updateShowButton=function(b,c){if(!c)for(var d,e=0;d=a.data.detail[e];e++)if(d.detail)for(var g,i=0;g=d.detail[i];i++)if(g.code==b){c=d;break}c._checked=!1,f(a.selStatus,b);for(var e=0;e<a._orderType.length;e++)if(b==a._orderType[e].code){f(a._orderType,a._orderType[e]);break}a.changeAllStatus(),h.$setViewValue(a.selStatus,a._orderType)},a.select=function(b,c,d){if(a.lastDi.showCheckBoxList=!1,a.lastDi.checkboxselect=!1,a.lastDi.isDrop=!1,"all"==b.code.toLowerCase().substring(b.code.length-3)||0==c){if(g(a.selStatus,b.code))return;a.selStatus=angular.copy(a.allSelStatus,[]),a._orderType=angular.copy(a.allOrderType,[]),a._orderType=a._orderType.slice(0,1)}else b.detail?(b.isDrop=!0,a.lastDi.checkboxselect=!1,b.showCheckBoxList=!0,b.checkboxselect=!0,a.lastDi=b):(a.selStatus=[],a.selStatus.push(b.code),a.changeAllStatus(),a.changeDropStatus(),h.$setViewValue(a.selStatus));h.$setViewValue(a.selStatus)},a.changeDropStatus=function(){for(var b=angular.copy(a._orderType),c=0;c<b.length;c++)a.updateShowButton(b[c].code)},a.hideCheckboxList=function(a){a.showCheckBoxList=!1,a.checkboxselect=!1,a.isDrop=!1},a.hideCheckboxListForClick=function(a,b,c){b&&(a.showCheckBoxList=!1,a.checkboxselect=!1,a.isDrop=!1,c.stopPropagation())}}}}),angular.module("grace.bootstrap.dropdown",[]).constant("dropdownConfig",{openClass:"open"}).service("dropdownService",["$document",function(a){var b=null;this.open=function(e){b||(a.bind("click",c),a.bind("keydown",d)),b&&b!==e&&(b.isOpen=!1),b=e},this.close=function(e){b===e&&(b=null,a.unbind("click",c),a.unbind("keydown",d))};var c=function(a){var c=b.getToggleElement();a&&c&&c[0].contains(a.target)||b.$apply(function(){b.isOpen=!1})},d=function(a){27===a.which&&(b.focusToggleElement(),c())}}]).controller("DropdownController",["$scope","$attrs","$parse","dropdownConfig","dropdownService","$animate",function(a,b,c,d,e,f){var g,h=this,i=a.$new(),j=d.openClass,k=angular.noop,l=b.onToggle?c(b.onToggle):angular.noop;this.init=function(d){h.$element=d,b.isOpen&&(g=c(b.isOpen),k=g.assign,a.$watch(g,function(a){i.isOpen=!!a}))},this.toggle=function(a){return i.isOpen=arguments.length?!!a:!i.isOpen},this.isOpen=function(){return i.isOpen},i.getToggleElement=function(){return h.toggleElement},i.focusToggleElement=function(){h.toggleElement&&h.toggleElement[0].focus()},i.$watch("isOpen",function(b,c){f[b?"addClass":"removeClass"](h.$element,j),b?(i.focusToggleElement(),e.open(i)):e.close(i),k(a,b),angular.isDefined(b)&&b!==c&&l(a,{open:!!b})}),a.$on("$locationChangeSuccess",function(){i.isOpen=!1}),a.$on("$destroy",function(){i.$destroy()})}]).directive("dropdown",function(){return{controller:"DropdownController",link:function(a,b,c,d){d.init(b)}}}).directive("dropdownToggle",function(){return{require:"?^dropdown",link:function(a,b,c,d){if(d){d.toggleElement=b;var e=function(e){e.preventDefault(),b.hasClass("disabled")||c.disabled||a.$apply(function(){d.toggle()})};b.bind("click",e),b.attr({"aria-haspopup":!0,"aria-expanded":!1}),a.$watch(d.isOpen,function(a){b.attr("aria-expanded",!!a)}),a.$on("$destroy",function(){b.unbind("click",e)})}}}}),angular.module("grace.bootstrap.fieldManager",[]).controller("fieldManagerController",["$scope",function(a){var b=this,c=[];b.addField=function(a){c.push(a)},b.getField=function(){return c},b.getFieldValue=function(a){for(var b,d=[],e=0,f=c.length;f>e;e++)b=c[e].scope,arguments.length&&a!==b.getName()||d.push({name:b.getName(),value:b.getValue()});return d},a.handler({getFieldValue:b.getFieldValue})}]).directive("graceFieldManager",[function(){return{restrict:"EA",replace:!0,scope:{handler:"="},controller:"fieldManagerController",link:function(a,b,c,d){}}}]),angular.module("grace.bootstrap.pagination",[]).controller("PaginationController",["$scope","$attrs","$parse",function(a,b,c){var d=this,e={$setViewValue:angular.noop},f=b.numPages?c(b.numPages).assign:angular.noop;this.init=function(f,g){e=f,this.config=g,e.$render=function(){d.render()},b.itemsPerPage?a.$parent.$watch(c(b.itemsPerPage),function(b){d.itemsPerPage=parseInt(b,10),a.totalPages=d.calculateTotalPages()}):this.itemsPerPage=g.itemsPerPage},this.calculateTotalPages=function(){var b=this.itemsPerPage<1?1:Math.ceil(a.totalItems/this.itemsPerPage);return Math.max(b||0,1)},this.render=function(){a.page=parseInt(e.$viewValue,10)||1},a.selectPage=function(b){a.page!==b&&b>0&&b<=a.totalPages&&(e.$setViewValue(b),e.$render())},a.getText=function(b){return a[b+"Text"]||d.config[b+"Text"]},a.noPrevious=function(){return 1===a.page},a.noNext=function(){return a.page===a.totalPages},a.$watch("totalItems",function(){a.totalPages=d.calculateTotalPages()}),a.$watch("totalPages",function(b){f(a.$parent,b),a.page>b?a.selectPage(b):e.$render()});

}]).constant("paginationConfig",{itemsPerPage:10,boundaryLinks:!1,directionLinks:!0,firstText:"First",previousText:"Previous",nextText:"Next",lastText:"Last",rotate:!0}).directive("pagination",["$parse","paginationConfig",function(a,b){return{restrict:"EA",scope:{totalItems:"=",firstText:"@",previousText:"@",nextText:"@",lastText:"@"},require:["pagination","?ngModel"],controller:"PaginationController",templateUrl:"template/pagination/pagination.html",replace:!0,link:function(c,d,e,f){function g(a,b,c){return{number:a,text:b,active:c}}function h(a,b){var c=[],d=1,e=b,f=angular.isDefined(k)&&b>k;f&&(l?(d=Math.max(a-Math.floor(k/2),1),e=d+k-1,e>b&&(e=b,d=e-k+1)):(d=(Math.ceil(a/k)-1)*k+1,e=Math.min(d+k-1,b)));for(var h=d;e>=h;h++){var i=g(h,h,h===a);c.push(i)}if(f&&!l){if(d>1){var j=g(d-1,"...",!1);c.unshift(j)}if(b>e){var m=g(e+1,"...",!1);c.push(m)}}return c}var i=f[0],j=f[1];if(j){var k=angular.isDefined(e.maxSize)?c.$parent.$eval(e.maxSize):b.maxSize,l=angular.isDefined(e.rotate)?c.$parent.$eval(e.rotate):b.rotate;c.boundaryLinks=angular.isDefined(e.boundaryLinks)?c.$parent.$eval(e.boundaryLinks):b.boundaryLinks,c.directionLinks=angular.isDefined(e.directionLinks)?c.$parent.$eval(e.directionLinks):b.directionLinks,i.init(j,b),e.maxSize&&c.$parent.$watch(a(e.maxSize),function(a){k=parseInt(a,10),i.render()});var m=i.render;i.render=function(){m(),c.page>0&&c.page<=c.totalPages&&(c.pages=h(c.page,c.totalPages))}}}}}]).constant("pagerConfig",{itemsPerPage:10,previousText:"« Previous",nextText:"Next »",align:!0}).directive("pager",["pagerConfig",function(a){return{restrict:"EA",scope:{totalItems:"=",previousText:"@",nextText:"@"},require:["pager","?ngModel"],controller:"PaginationController",templateUrl:"template/pagination/pager.html",replace:!0,link:function(b,c,d,e){var f=e[0],g=e[1];g&&(b.align=angular.isDefined(d.align)?b.$parent.$eval(d.align):a.align,f.init(g,a))}}}]),angular.module("grace.bootstrap.tooltip",["grace.bootstrap.position","grace.bootstrap.bindHtml"]).provider("$tooltip",function(){function a(a){var b=/[A-Z]/g,c="-";return a.replace(b,function(a,b){return(b?c:"")+a.toLowerCase()})}var b={placement:"top",animation:!0,popupDelay:0},c={mouseenter:"mouseleave",click:"click",focus:"blur"},d={};this.options=function(a){angular.extend(d,a)},this.setTriggers=function(a){angular.extend(c,a)},this.$get=["$window","$compile","$timeout","$parse","$document","$position","$interpolate",function(e,f,g,h,i,j,k){return function(e,l,m){function n(a){var b=a||o.trigger||m,d=c[b]||b;return{show:b,hide:d}}var o=angular.extend({},b,d),p=a(e),q=k.startSymbol(),r=k.endSymbol(),s="<div "+p+'-popup title="'+q+"tt_title"+r+'" content="'+q+"tt_content"+r+'" placement="'+q+"tt_placement"+r+'" animation="tt_animation" is-open="tt_isOpen"></div>';return{restrict:"EA",scope:!0,compile:function(a,b){var c=f(s);return function(a,b,d){function f(){a.tt_isOpen?m():k()}function k(){(!A||a.$eval(d[l+"Enable"]))&&(a.tt_popupDelay?x||(x=g(p,a.tt_popupDelay,!1),x.then(function(a){a()})):p()())}function m(){a.$apply(function(){q()})}function p(){return x=null,w&&(g.cancel(w),w=null),a.tt_content?(r(),v.css({top:0,left:0,display:"block"}),y?i.find("body").append(v):b.after(v),B(),a.tt_isOpen=!0,a.$digest(),B):angular.noop}function q(){a.tt_isOpen=!1,g.cancel(x),x=null,a.tt_animation?w||(w=g(s,500)):s()}function r(){v&&s(),v=c(a,function(){}),a.$digest()}function s(){w=null,v&&(v.remove(),v=null)}function t(b){return a.$eval(d[l+b])}function u(){a.tt_title=t("Title");var b=parseInt(t("PopupDelay"),10);a.tt_popupDelay=isNaN(b)?o.popupDelay:b;var c=t("Placement");a.tt_placement=angular.isDefined(c)?c:o.placement,D(t("Trigger")),c=t("AppendToBody"),y=angular.isDefined(c)?h(c)(a):y}var v,w,x,y=angular.isDefined(o.appendToBody)?o.appendToBody:!1,z=n(void 0),A=angular.isDefined(d[l+"Enable"]),B=function(){var c=j.positionElements(b,v,a.tt_placement,y);c.top+="px",c.left+="px",v.css(c)};a.tt_isOpen=!1,d.$observe(e,function(b){a.tt_content=b,!b&&a.tt_isOpen&&q()}),d.$observe(l+"Title",function(b){a.tt_title=b}),d.$observe(l+"Placement",function(b){a.tt_placement=angular.isDefined(b)?b:o.placement}),d.$observe(l+"PopupDelay",function(b){var c=parseInt(b,10);a.tt_popupDelay=isNaN(c)?o.popupDelay:c});var C=function(){b.unbind(z.show,k),b.unbind(z.hide,m)},D=function(a){C(),z=n(a),z.show===z.hide?b.bind(z.show,f):(b.bind(z.show,k),b.bind(z.hide,m))};d.$observe(l+"Trigger",D);var E=a.$eval(d[l+"Animation"]);a.tt_animation=angular.isDefined(E)?!!E:o.animation,d.$observe(l+"AppendToBody",function(b){y=angular.isDefined(b)?h(b)(a):y}),y&&a.$on("$locationChangeSuccess",function(){a.tt_isOpen&&q()}),a.$on("$destroy",function(){g.cancel(w),g.cancel(x),C(),s()}),u()}}}}}]}).directive("tooltipPopup",function(){return{restrict:"EA",replace:!0,scope:{content:"@",placement:"@",animation:"&",isOpen:"&"},templateUrl:"template/tooltip/tooltip-popup.html"}}).directive("tooltip",["$tooltip",function(a){return a("tooltip","tooltip","mouseenter")}]).directive("tooltipHtmlUnsafePopup",function(){return{restrict:"EA",replace:!0,scope:{content:"@",placement:"@",animation:"&",isOpen:"&"},templateUrl:"template/tooltip/tooltip-html-unsafe-popup.html"}}).directive("tooltipHtmlUnsafe",["$tooltip",function(a){return a("tooltipHtmlUnsafe","tooltip","mouseenter")}]),angular.module("grace.bootstrap.grid",["grace.bootstrap.pagination","grace.bootstrap.tooltip","grace.bootstrap.bindHtml","grace.bootstrap.position","grace.bootstrap.dataFormatter","grace.bootstrap.bindTemplate"]).constant("gridConstant",{rowHeight:30,headerRowHeight:30,minColumnWidth:50,minBodyHeight:200,enablePagination:!0,enableSort:!1,enableFilter:!1,enableScreen:!1,screenConfig:{screenLabel:"显示/隐藏:",type:"in-line",dropDownWidth:300,dropDownColumnCount:3},enablePinning:!1,enableSelection:!1,enableSelectionMulti:!1,expandableTable:!1,expandingConfig:{remote:!0},enableColumnResize:!1,enableTooltip:!1,paginationConfig:{pageSize:10,paginationSize:5,pageSizes:[10,20,50,100],firstText:"首页",previousText:"上一页",nextText:"下一页",lastText:"尾页"},useRemoteData:!1,ajaxConfig:{dataType:"json",method:"get"},pageSize:10,paginationSize:5,emptyPlaceHolder:"-",tooltipConfig:{place:"bottom",append2Body:!0,showDelay:0},enableInfiniteScroll:!1,infiniteScrollConfig:{iStep:5},lockHeader:!1,lockHeaderType:"normal",enableSearchAll:!1,searchAllConfig:{columnsPass:null},enableAutoResize:!1,enableRowDragging:!1,dataEmptyText:"没有相关数据",columnClassPrefix:"grid-column"}).controller("gridController",["$scope","gridConstant","gridHeaderService","gridBodyService","gridUtil","$timeout","GridApi","$http",function(a,b,c,d,e,f,g,h){function i(b,c){b.forEach(function(b){if(b.rowInfo.visible=c,b.rowInfo.hasChildren&&b.rowInfo.children&&b.rowInfo.children.length){b.rowInfo.expanded=c;var d=a.bodyInfo.rowsChildrenMap;i(d[b.rowInfo.rowId],c)}})}function j(){var b=a.headerInfo,c=b.columnsByDepth,f=a.bodyInfo,g=f.rows,h=f.rowsChildrenMap;if(b.columns2Render=e.copy2DArray(c),a.expandableTable){var i={};for(var j in h)i[j]=d.copyBody(h[j]);f.rowsChildrenMap2Render=i,g=g.filter(function(a){return 0==a.rowInfo.depth})}f.rows2Render=d.copyBody(g)}function k(){d.mergeRows2Render(a.bodyInfo)}var l=this;a.gridId=e.newId(),a.$watch("gridOptions",function(a){a&&(e.isEmptyObj(a)||l.update(a))}),l.scope=a,l.gridApi=new g;var m=e.browserType;a.IE=e.browserType.ie,a.ieCompensation=a.IE?1:0,a.compensation=m.ie&&2||m.chrome&&1||m.safari&&1||m.firefox&&2,a.showScroller=!1,a.isDraggingMode=!1,a.valueParse=function(a,b){return a+="","auto"==a||-1!=a.indexOf("%")||-1!=a.indexOf("px")?a:a?a+(b||"px"):0},l.updateBody=function(){a.bodyInfo=d.createBody(l.options.gridData,a),a.bodyInfo.totalWidth=a.headerInfo.totalWidth,l.applyCurrentData()},l.update=function(h){l.options=h,a.rowHeight=h.rowHeight||b.rowHeight,a.headerRowHeight=h.headerRowHeight||b.headerRowHeight,a.minColumnWidth=h.minColumnWidth||b.minColumnWidth,a.enableRowDragging=void 0!==h.enableRowDragging?h.enableRowDragging:b.enableRowDragging,a.dataEmptyText=h.dataEmptyText||b.dataEmptyText,a.gridDataEmpty=!(h.gridData&&h.gridData.length),a.enableAutoResize=void 0!==h.enableAutoResize?h.enableAutoResize:b.enableAutoResize,a.enableAutoResize&&(window.removeEventListener("resize",n,!1),window.addEventListener("resize",n,!1)),a.emptyPlaceHolder=void 0!=h.emptyPlaceHolder?h.emptyPlaceHolder:b.emptyPlaceHolder,a.enableInfiniteScroll=void 0!==h.enableInfiniteScroll?h.enableInfiniteScroll:b.enableInfiniteScroll,a.enableInfiniteScroll&&(a.infiniteScrollConfig=angular.extend(angular.extend({},b.infiniteScrollConfig),h.infiniteScrollConfig)),a.enablePagination=angular.isDefined(h.enablePagination)?h.enablePagination:b.enablePagination,a.enablePagination&&(a.paginationConfig=angular.extend(angular.extend({},b.paginationConfig),h.paginationConfig)),l.paginationHeightWatcher&&l.paginationHeightWatcher(),a.enablePagination&&(l.paginationHeightWatcher=a.$watch(function(){return l.getPaginationHeight&&l.getPaginationHeight()},function(b){b=b||0,a.paginationHeight=b})),a.useRemoteData=void 0!==h.useRemoteData?h.useRemoteData:b.useRemoteData,a.useRemoteData&&(a.ajaxConfig=angular.extend(angular.extend({},b.ajaxConfig),h.ajaxConfig)),a.enableSort=angular.isDefined(h.enableSort)?h.enableSort:b.enableSort,a.enableFilter=angular.isDefined(h.enableFilter)?h.enableFilter:b.enableFilter,a.enableScreen=angular.isDefined(h.enableScreen)?h.enableScreen:b.enableScreen,l.screenerHeightWatcher&&l.screenerHeightWatcher(),a.enableScreen&&(a.screenConfig=angular.extend(angular.extend({},b.screenConfig),h.screenConfig),l.screenerHeightWatcher=a.$watch(function(){return l.getScreenerHeight&&l.getScreenerHeight()},function(b){b=b||0,a.screenerHeight=b})),a.enablePinning=angular.isDefined(h.enablePinning)?h.enablePinning:b.enablePinning,a.enableSelection=angular.isDefined(h.enableSelection)?h.enableSelection:b.enableSelection,a.enableSelectionMulti=angular.isDefined(h.enableSelectionMulti)?h.enableSelectionMulti:b.enableSelectionMulti,a.expandableTable=angular.isDefined(h.expandableTable)?h.expandableTable:b.expandableTable,a.expandableTable&&(a.expandingConfig=angular.extend(angular.extend({},b.expandingConfig),h.expandingConfig)),a.groupingMode=a.expandableTable,a.tooltipConfig=angular.extend(angular.extend({},b.tooltipConfig),h.tooltipConfig),a.enableColumnResize=angular.isDefined(h.enableColumnResize)?h.enableColumnResize:b.enableColumnResize,a.lockHeader=angular.isDefined(h.lockHeader)?h.lockHeader:b.lockHeader,a.lockHeaderType=angular.isDefined(h.lockHeaderType)?h.lockHeaderType:b.lockHeaderType,a.lockHeader&&"top"==a.lockHeaderType?a.lockHeader2Top():a.unlockHeader2Top(),a.enableSearchAll=angular.isDefined(h.enableSearchAll)?h.enableSearchAll:b.enableSearchAll,a.enableSearchAll&&(a.searchAllConfig=angular.extend(angular.extend({},b.searchAllConfig),h.searchAllConfig)),a.gridWidthWatcher&&a.gridWidthWatcher(),a.gridWidthWatcher=a.$watch(function(){return a.IE?a.gridWrapperEl.parent()[0].offsetWidth:parseFloat(e.getStyles(a.gridWrapperEl.parent()).width.replace("px",""))},function(a){a=a||0,0!=a&&l.setGridWidth(a)}),a.headerInfo=c.createHeader(h.columnsDef||[],a),a.bodyInfo=d.createBody(h.gridData||[],a),f(function(){a.headerData=a.headerInfo.columns2Render,a.bodyData=a.bodyInfo.rows2Render,a.bodyInfo.height="auto"==a.gridHeight?"auto":Math.max(a.gridHeight-a.headerInfo.height,b.minBodyHeight),a.enableInfiniteScroll&&"auto"==a.bodyInfo.height&&(a.bodyInfo.height=b.minBodyHeight),a.bodyInfo.totalWidth=a.headerInfo.totalWidth,a.headerInfo.totalWidth>a.gridWidth?(a.showScroller=!0,"windows"==e.osType&&"auto"!=a.gridHeight&&(a.gridHeight=a.getViewPortInfo().height+e.getScrollBarInfo().horizontalBarHeight)):a.showScroller=!1,l.applyCurrentData(),f(function(){g.update(l.gridApi,l),h.onReady&&h.onReady(l.gridApi)},0)},0)};var n=e.delayExe(function(){0!=a.gridContainerEl[0].offsetWidth&&l.setGridWidth(a.gridContainerEl[0].offsetWidth)},50);l.setGridWidth=function(b){a.gridWidth=b,a.headerInfo&&(a.headerInfo.viewPortWidth=b,l.resizeAutoWidthColumns())},l.resizeAutoWidthColumns=function(){c.updateColumnWidth(a.headerInfo),c.computeColumnCss(a.headerInfo,a),a.bodyInfo.totalWidth=a.headerInfo.totalWidth,a.headerInfo.totalWidth>a.gridWidth?(a.showScroller=!0,"windows"==e.osType&&"auto"!=a.gridHeight&&(a.gridHeight=a.getViewPortInfo().height+e.getScrollBarInfo().horizontalBarHeight)):a.showScroller=!1},l.resizeColumn=function(b,d){a.$apply(function(){c.resizeColumn(b,d,a.headerInfo,a),a.bodyInfo.totalWidth=a.headerInfo.totalWidth,a.headerInfo.totalWidth>a.gridWidth?(a.showScroller=!0,"windows"==e.osType&&"auto"!=a.gridHeight&&(a.gridHeight=a.getViewPortInfo().height+e.getScrollBarInfo().horizontalBarHeight)):a.showScroller=!1})},l.addRows2Body=function(b,c,e){var f;return f=a.expandableTable?d.addRows(a,c,b,e):d.addRows(a,c,b,e)},l.groupExpand=function(b,c){var d=a.bodyInfo.rowsChildrenMap;if(b.rowInfo.expanded=!0,d[b.rowInfo.rowId])return d[b.rowInfo.rowId].forEach(function(a){a.rowInfo.visible=!0}),void(c&&c());var e=a.expandingConfig;h({method:"get",dataType:"json",url:e.dataUrl,params:e.paramParser(b.rowInfo.rawData)}).success(function(d){d=e.resultParser(d);var f=l.addRows2Body(b.rowInfo.originalRowIndex+1,d,b);a.bodyInfo.rowsChildrenMap[b.rowInfo.rowId]=f,c&&c()})},l.groupCollapse=function(b,c){var d=a.bodyInfo.rowsChildrenMap[b.rowInfo.rowId];b.rowInfo.expanded=!1,d&&d.length&&i(d,!1),c&&c()},l.groupCollapseRows=function(a,b){for(var c,d=0;c=a[d];d++)l.groupCollapse(c);b&&b()},l.applyCurrentData=function(){j(),a.enableSearchAll&&l.searchAll&&l.searchAll(a.searchAllKeywords),a.enableFilter&&l.filtering&&l.filtering(a),a.enableSort&&l.sorting&&l.sorting(a),a.enablePagination&&l.paging&&l.paging(a),a.expandableTable&&k(),a.enableScreen&&l.screening&&l.screening(a),a.enablePinning&&l.pinning&&l.pinning(a),a.enableInfiniteScroll&&l.infiniteScrollStart&&l.infiniteScrollStart()},l.searchAll=function(b){function c(a){var d=/<.*?>|<\s*\/.*?>/g;return a.filter(function(a){for(var e,j=!1,k=0;e=a[k];k++)if(!(i.columnsPass&&i.columnsPass.indexOf(e.field)>=0))switch(e.type){case"html":-1!=e.content.replace(d,"").indexOf(b)&&(j=!0,k=a.length);break;case"button":break;default:-1!=(e.content+"").indexOf(b)&&(j=!0,k=a.length)}if(h){var l=a.rowInfo;l.children&&l.children.length&&(g[l.rowId]||(g[l.rowId]=!0,f[l.rowId]=c(f[l.rowId]),f[l.rowId].length&&(j=!0)))}return j})}if(b){var d=a.bodyInfo,e=d.rows2Render,f=d.rowsChildrenMap2Render,g={},h=a.expandableTable,i=a.searchAllConfig;d.rows2Render=c(e)}},a.$on("selectAll",function(){l.selectAll.apply(null,arguments)}),a.$on("selectOne",function(b,c){if(a.enableSelectionMulti){var d=c.selectOrUnSelect,e=a.bodyInfo,f=a.headerInfo,g=f.columns,h=g[0];if("rowSelector"==h.columnType){if(d||(h.isAllSelected=!1),a.enableInfiniteScroll)var i=e.rows2RenderCache;else var i=e.rows2Render;for(var j,k=!0,l=0;j=i[l];l++)if(!j.rowInfo.selected){k=!1;break}h.isAllSelected=k}}})}]).factory("GridApi",function(){function a(){this.eventHandlers={}}function b(){this.event=new a}return a.prototype.on=function(a,b,c){var d=this.eventHandlers[a];!d&&(d=this.eventHandlers[a]=[]),d.push([b,c])},a.prototype.off=function(a,b){var c=this.eventHandlers[a];if(c)for(var d,e=0;d=c[e];e++)d[0]===b&&(c.splice(e,1),e--)},a.prototype.trigger=function(a,b){var c=this.eventHandlers[a];if(c)for(var d,e=0;d=c[e];e++)d[0].apply(d[1],b)},b.update=function(a,b){var c=b.scope;c.expandableTable&&(a.groupExpand=b.groupExpand,a.groupCollapse=b.groupCollapse,a.groupExpandAll=function(){for(var d,e=c.bodyInfo.rows2Render.filter(function(a){return 1==a.rowInfo.hasChildren}),f=e.length,g=0;d=e[g];g++)b.groupExpand(d,function(){--f||(b.applyCurrentData(),a.event.trigger("afterExpandAllRows",[]))})},a.groupCollapseAll=function(){var a=c.bodyInfo.rows2Render.filter(function(a){return 0==a.rowInfo.depth});b.groupCollapseRows(a,function(){b.applyCurrentData()})}),c.enableScreen&&(a.showColumn=function(a){var d=c.headerInfo.columnsMap[a];d.visible||(d.visible=!0,b.applyCurrentData())},a.hideColumn=function(a){var d=c.headerInfo.columnsMap[a];d.visible&&(d.visible=!1,b.applyCurrentData())}),c.enableSearchAll&&(a.searchAll=function(a){c.searchAllKeywords=a,b.applyCurrentData(),c.searchAllKeywords=void 0}),c.enableSort&&(a.sort=function(a,c,d){b.sortingExposed(a,c)}),c.enablePinning&&(a.pinning=function(a){b.pinningExposed(a)}),c.enableRowDragging&&(a.draggingMode=function(a){return void 0!==a&&(c.isDraggingMode=!!a),c.isDraggingMode}),c.useRemoteData&&(a.reload=function(){b.reloadCurrentPage(),c.$broadcast("gridReload",{type:"apiReload"})}),a.getGridData=function(){for(var a,b=c.bodyInfo,d=b.rows,e=[],f=0;a=d[f];f++)e.push(a.rowInfo.rawData);return e},a.getCurrentPageData=function(){for(var a,b=c.bodyInfo,d=b.rows2Render,e=[],f=0;a=d[f];f++)e.push(a.rowInfo.rawData);return e},a.setGridWidth=function(a){b.setGridWidth(a)}},b}).factory("gridHeaderService",["gridConstant","gridUtil",function(a,b){function c(c,d){for(var e,f=c.columns,g=[],h=0;e=f[h];h++)g.push(b.formatStr(".grid{1} .{2}{3}{width:{4}px}\n.grid{1} .{2}{3} .cell-content{width:{5}px;}",d.gridId,a.columnClassPrefix,e.columnId,e.drawnWidth,e.drawnWidth-1));c.columnCss=g.join("\n")}function d(a,b,e,f){var g=a.drawnWidth+b;if(g<a.minWidth){var h=a.drawnWidth;a.drawnWidth=a.minWidth,b=a.drawnWidth-h}else a.drawnWidth=g;a.parent?d(a.parent,b,e,f):(c(e,f),e.totalWidth+=b)}function e(a){for(var b,c=0,d=a.length;b=a[--d];)c+=b.drawnWidth;return c}function f(b){if(b.autoWidthColumns.length){var c=e(b.givenWidthColumns.filter(function(a){return a.visible})),d=b.autoWidthColumns.filter(function(a){return a.visible}),f=a.minColumnWidth;f=Math.max((b.viewPortWidth-c)/d.length,f),f=Math.floor(f);for(var g,h=0,i=0;g=d[i];i++)f<g.minWidth?g.drawnWidth=g.minWidth:g.drawnWidth=f,h+=g.drawnWidth;if(b.totalWidth=c+h,b.viewPortWidth>b.totalWidth&&d[0]){var j=Math.floor(b.viewPortWidth-b.totalWidth)-1;d[0].drawnWidth+=j,b.totalWidth+=j}}}function g(c,d,e){for(var f,h=0;f=c[h];h++){var j=f.children;f.children=null;var k=angular.copy(i);k.minWidth=d.minColumnWidth,c.splice(h,1,angular.extend(k,f)),void 0===k.enableResize&&(k.enableResize=d.enableResize),k.drawnWidth="auto"==k.width?"auto":parseFloat(k.width),k.displayName=k.name||k.field,k.sortable=d.enableSort&&1!=k.disableSort,k.columnId=b.newId(),k.columnClasses=a.columnClassPrefix+k.columnId,k.customClasses&&(k.columnClasses+=" "+k.customClasses),k.parent=e,j?(g(j,d,f),k.children=j,k.colspan=0):(d.columns.push(k),d.columnsMap[k.field]=k,k.columnIndex=d.columns.length-1,"auto"==k.drawnWidth?d.autoWidthColumns.push(k):(d.givenWidthColumns.push(k),d.totalWidth+=k.drawnWidth))}}function h(a,b){function c(a,d){var e=0;if(a.children){a.drawnWidth=0,a.colspan=0;for(var f=a.children,g=0;g<f.length;g++){var h=c(f[g],d+1);e+=h.w,a.colspan+=h.cs}a.drawnWidth=e}return a.depth=d,b.totalDepth=Math.max(d,b.totalDepth),!b.columnsByDepth[d-1]&&(b.columnsByDepth[d-1]=[]),b.columnsByDepth[d-1].push(a),{w:a.drawnWidth,cs:a.colspan}}b.totalDepth=0,b.columnsByDepth=[];for(var d,e=0;d=a[e];e++)c(d,1);for(var d,e=0;d=b.columnsByDepth[e];e++)for(var f,g=0;f=d[g];g++)f.rowspan=f.children?f.rowspan:b.totalDepth-f.depth+1}var i={name:"",displayName:"",width:"auto",drawnWidth:100,field:"",colspan:1,rowspan:1,visible:!0},j={};return j.createHeader=function(a,b){var d={totalDepth:0,totalWidth:0,minColumnWidth:b.minColumnWidth,viewPortWidth:b.gridWidth,viewPortHeight:b.gridHeight,enableResize:b.enableColumnResize,enableSort:b.enableSort,columns:[],columnsMap:{},autoWidthColumns:[],givenWidthColumns:[],columnsByDepth:[]};return g(a,d),f(d),c(d,b),h(a,d),d.height=d.totalDepth*b.headerRowHeight,d},j.computeColumnCss=c,j.resizeColumn=d,j.updateColumnWidth=f,j.formatHeader=g,j.fixColumn=h,j}]).factory("gridRowFactory",function(){var a={},b={rowId:"",visible:!0};return a.copy=function(a){var b=[].concat(a);return b.rowInfo=a.rowInfo,b},a.create=function(a,c){var d=[];return c&&(d=d.concat(c)),d.rowInfo=angular.extend(angular.extend({},b),a),d},a}).factory("gridBodyService",["$gDataFormatterFactory","gridUtil","gridRowFactory","gridConstant",function(a,b,c,d){function e(d,e,f,g){var i=c.create(f);i.rowInfo.rawData=e;for(var j,k=0;j=d[k];k++){var l=angular.copy(h);l.content=e[j.field],"string"==typeof j.formatter?l.displayContent=a(l.content,j.formatter):"function"==typeof j.formatter?l.displayContent=j.formatter(l.content):l.displayContent=l.content,l.type=j.columnType||"normal",l.editable=j.editable||!0,"normal"==l.type&&(l.editable=!1,l.displayContent=l.displayContent||g.emptyPlaceHolder),"select"==l.type&&(l.selectModel=j.selectModel||[l.displayContent]),("check"==l.type||"rowSelector"==l.type)&&(l.displayContent=!!l.content),j.enableTooltip&&(j.tooltiper?l.tooltip=j.tooltiper(e):l.tooltip=l.displayContent,l.enableTooltip=!0),l.width=j.drawnWidth,l.originalColumnIndex=k,l.field=j.field,l.cellId=b.newId(),l.columnId=j.columnId,l.columnClasses=j.columnClasses,i.push(l)}return i}function f(a,b,c){var d=[];b=b||0;for(var e,g,h=0;g=a[h];h++)g.$depth=b,c&&(g.$parent=c),d.push(g),g.$hasChildren&&g.$children&&g.$children.length&&(e=f(g.$children,b+1,g),d=d.concat(e));return d}var g={},h={content:"",displayContent:"",width:100,visible:!0};return g.copyBody=function(a){for(var b=[],d=0,e=a.length;e>d;d++){var f=a[d],g=c.copy(f);g.rowInfo.visible&&b.push(g)}return b},g.copy2Render=function(a){var b=a.rows,c=a.rowsChildrenMap;a.rows2Render=g.copyBody(b);var d={};for(var e in c)d[e]=g.copyBody(c[e]);a.rowsChildrenMap2Render=d},g.mergeRows2Render=function(a){for(var b,c=a.rows2Render,d=a.rowsChildrenMap2Render,e=0;b=c[e];e++){var f=d[b.rowInfo.rowId];if(f){{f.length}f=[].concat(f),f.unshift(0),f.unshift(e+1),c.splice.apply(c,f)}}},g.addRows=function(a,c,d,g){var h=a.bodyInfo.rows,i=a.headerInfo.columns,j=a.gridOptions.gridData,k=a.expandableTable;k&&(g.rowInfo.children=c,c=f(c,g.rowInfo.depth+1,g));for(var l=h.length-1,m=c.length;l>=d;)h[l--].rowInfo.originalRowIndex+=m;for(var n,o=[],p=0;n=c[p];p++){var q={},r=d+p;q.originalRowIndex=r,q.rowId=b.newId(),k&&(q.hasChildren=n.$hasChildren||!1,q.children=n.$children,q.depth=n.$depth,q.parent=n.$parent);var s=e(i,n,q,a);h.splice(r,0,s),j.splice(r,0,n),o.push(s)}return o},g.createBody=function(a,c){function d(j,k,l){k=k||0;for(var m,n=[],o=0;m=j[o];o++){var p={rowId:b.newId(),visible:!0,originalRowIndex:i++,parent:l,depth:k,hasChildren:m.$hasChildren||!1,expanded:!1};h&&m.$hasChildren&&m.$children&&m.$children.length&&(a.splice.apply(a,[i,0].concat(m.$children)),o+=m.$children.length,p.children=d(m.$children,k+1,m),p.expanded=!0,f.rowsChildrenMap[p.rowId]=p.children);var q=e(g,m,p,c);n.push(q),h&&p.children&&(n=n.concat(p.children))}return n}var f={rows:[],rowsChildrenMap:{}},g=c.headerInfo.columns,h=c.expandableTable,i=0;return f.rows=d(a,0,0),f},g}]).directive("graceGrid",["$window","gridUtil","$position",function(a,b,c){return{restrict:"EA",priority:1,replace:!0,controller:"gridController",templateUrl:"template/grid/grid.html",scope:{gridOptions:"="},compile:function(){return{pre:function(a,c,d){function e(){var a=b.getStyles(c),d=parseFloat(a.height.replace("px",""))||"auto",e=parseFloat(a.width.replace("px",""))||"auto";return d>=0&&c[0].clientHeight<=5&&(d="auto"),{width:e,height:d}}var f=angular.element,g=e();a.gridWidth=g.width,a.gridHeight=g.height,a.getViewPortInfo=e,a.getBodyHeight=function(){var a=c[0].querySelector("section");return a?parseFloat(b.getStyles(f(a)).height.replace("px",""))||"auto":0},a.gridWrapperEl=f(c[0].querySelector(".grace-grid-wrapper")),a.gridContainerEl=c},post:function(d,e,f,g){function h(e){m||(m=c.offset(l));var f=d.IE?document.documentElement.scrollTop:a.scrollY,g=m.top;l.css(f>g?b.cssFixer("transform","translateY("+(f-g)+"px)"):b.cssFixer("transform","translateY(0px)"))}{var i=e[0],j=(angular.element,i.querySelector(".grace-grid-wrapper")),k=i.querySelector("header"),l=angular.element(k);angular.element(j)}j.addEventListener("scroll",function(a){var c=j.scrollLeft,e=j.scrollTop,f=angular.element(j.querySelector(".pinning-header")),g=angular.element(j.querySelector(".pinning-body")),h=b.cssFixer("transform","translateX("+c+"px)");f.css(h),g.css(h),d.lockHeader&&"normal"===d.lockHeaderType&&l.css(b.cssFixer("transform","translateY("+e+"px)"))},!1);var m=null;d.lockHeader2Top=function(){d.unlockHeader2Top(),a.addEventListener("scroll",h,!1)},d.unlockHeader2Top=function(){a.removeEventListener("scroll",h,!1)}}}}}}]).controller("graceGridCellController",["gridConstant",function(a){}]).directive("graceGridCell",["$compile",function(a){return{restrict:"EA",replace:!0,templateUrl:"template/grid/gridCell.html",require:["^graceGrid","^graceGridBody"],scope:{cellData:"=",rowIndex:"="},compile:function(){return{pre:function(b,c,d,e){var f=e[0],g=f.scope.expandableTable,h=f.scope,i='<div class="cell-content" >';g&&(i+='<i class="cell-icon" ng-click="iconClick($event)" ></i>');var j=b.cellData;switch(i+="<span "+(j.enableTooltip?'tooltip="'+j.tooltip+'" tooltip-placement="'+h.tooltipConfig.place+'" tooltip-popup-delay="'+h.tooltipConfig.showDelay+'" tooltip-append-to-body="'+h.tooltipConfig.append2Body+'"':"")+">",j.type){case"normal":i+='<span  class="cell-content-normal"  >'+j.displayContent+"</span>";break;case"text":i+='<span class="cell-content-text" ><input type="text"ng-model="cellData.displayContent"ng-model-options="{updateOn:\'blur\',debounce:{blur:\'10\'}}"ng-change="contentChange($event,cellData)"ng-click="elClick($event,cellData)"ng-class="{active:cellData.active}"ng-blur="elBlur($event,cellData)"ng-disabled="gridScope.isDraggingMode" /></span>';break;case"check":i+='<span  class="cell-content-check" ><i class="grid-check-icon"ng-class="{\'grace-icon-check\':cellData.displayContent,\'grace-icon-unchecked\':!cellData.displayContent}"ng-click="doCheck($event,cellData)" ></i></span>';break;case"select":i+='<span  class="cell-content-select" ><select ng-model="cellData.displayContent"ng-change="contentChange($event,cellData)"ng-options="value for value in cellData.selectModel"ng-click="selectionClick($event)"ng-disabled="gridScope.isDraggingMode" ></select></span>';break;case"rowSelector":i+='<span  class="cell-content-check" ><i class="grid-check-icon"ng-class="{\'grace-icon-check\':cellData.displayContent,\'grace-icon-unchecked\':!cellData.displayContent}"</span>';break;case"date":i+="<span></span>";break;case"button":i+='<span class="cell-content-button" ><button class="'+j.displayContent["class"]+'"ng-click="buttonClick($event,cellData)"ng-disabled="gridScope.isDraggingMode"  >'+j.displayContent.text+"</button></span";break;case"buttons":i+='<span class="cell-content-buttons">';for(var k,l=0;k=j.displayContent[l];l++)i+='<button ng-click="buttonClick($event,cellData,'+l+')"class="'+k["class"]+'"ng-disabled="gridScope.isDraggingMode"  >'+k.text+"</button>";i+="</span>";break;case"html":i+='<span  class="cell-content-html" >'+j.displayContent+"</span>";break;case"template":i+='<span  grace-bind-template="cellData.displayContent" class="cell-content-html" ></span>'}i+="</span></div>",c.append(a(i)(b))},post:function(a,b,c,d){var e=d[0],f=d[1],g=e.gridApi,h=e.scope.expandableTable,i=e.scope.bodyInfo;a.gridScope=e.scope,a.iconClick=function(b){a.gridScope.isDraggingMode||(b.stopPropagation(),h&&f.expandOrCollapseRow(i.rows[a.rowIndex]))},a.elBlur=function(a,b){b.active=!1},a.selectionClick=function(a){a.stopPropagation()},a.elClick=function(a,b){a.stopPropagation(),b.editable&&(b.active=!0)},a.contentChange=function(b,c){switch(c.type){case"text":g.event.trigger("contentEdit",[b,a.rowIndex,c.field,c.displayContent]);break;case"select":g.event.trigger("contentEdit",[b,a.rowIndex,c.field,c.displayContent])}},a.buttonClick=function(b,c,d){b.stopPropagation(),g.event.trigger("buttonClick",[b,a.rowIndex,c.field,d])},a.doCheck=function(b,c){a.gridScope.isDraggingMode||(b.stopPropagation(),c.displayContent=!c.displayContent,g.event.trigger("checkStatusChange",[b,a.rowIndex,c.field,c.displayContent]))}}}}}}]).directive("graceGridHeaderCell",["$position","gridUtil","$compile",function(a,b,c){return{restrict:"EA",replace:!0,require:["^graceGrid","^graceGridHeader"],templateUrl:"template/grid/gridHeaderCell.html",scope:{cellData:"=",columnIndex:"=",rowIndex:"="},compile:function(){return{pre:function(a,b,d,e){var f=a.cellData,g=e[0],h=g.scope,i='<div class="cell-content"  >';f.desc&&(i+='<span tooltip="'+f.desc+'"tooltip-append-to-body="'+h.tooltipConfig.append2Body+'"tooltip-popup-delay="'+h.tooltipConfig.showDelay+'"tooltip-placement="'+h.tooltipConfig.place+'" ><i class="grace-icon-question-sign" ></i></span>'),i+="rowSelector"==f.columnType?'<span class="cell-value"  ><i ng-class="{\'grace-icon-check\':cellData.isAllSelected,\'grace-icon-unchecked\':!cellData.isAllSelected}" ng-click="selectAll($event)" ></i></span></div>':'<span class="cell-value" ng-click="valueClick($event)"  >{{cellData.displayName}}<i ng-if="cellData.sortable && !cellData.children" ng-class="{\'grace-icon-sort-down\':sortTypeIndex == 2,\'grace-icon-sort-up\':sortTypeIndex == 1,\'grace-icon-sort\':sortTypeIndex == 0}" ></i></span><div ng-if="!cellData.children && gridOptions.enableFilter && !cellData.disableFilter" class="column-filter" ><input type="text" ng-model="cellData.filterKeyWord" ng-change="filterChange($event)" /></div></div>',f.pinnable&&!f.disablePinning&&"rowSelector"!=f.columnType&&(i+='<div  class="pin-icon" ng-class="{pinned:cellData.pinned}" ng-click="togglePinning($event)" ><i class="grace-icon-pushpin" ></i></div>'),h.enableColumnResize&&f.enableResize&&!f.children&&(i+='<div  class="resize-bar" ng-mousedown="beginResize($event)" ></div>'),b.append(c(i)(a))},post:function(c,d,e,f){function g(a){return a=a.originalEvent||a,a.pageX}function h(a){if(j.scope.enableColumnResize&&o){p=g(a)-n;var c=b.cssFixer("transform","translateX("+p+"px)");q.css(c),r.css(c),a.preventDefault()}}function i(a){j.scope.enableColumnResize&&(o=!1,j.resizeColumn(c.cellData,p),m.event.trigger("columnResize",[a,c.cellData.originalColumnIndex,p]),p=0,q.css(b.cssFixer("transform","translateX(0px)")),q=null,a.preventDefault(),angular.element(document.body).unbind("mousemove",h),angular.element(document.body).unbind("mouseup",i),r.remove())}var j=f[0],k=f[1],l=0,m=j.gridApi;c.gridScope=j.scope,c.gridOptions=j.options,c.sortTypeIndex=l,k.addColumnScope(c),c.resetSort=function(){l=0,c.sortTypeIndex=l},c.selectAll=function(a,b){var b=c.cellData,d=b.isAllSelected=!b.isAllSelected;c.$emit("selectAll",{selectOrUnSelect:d})},c.valueClick=function(a,b){c.cellData.children||j.scope.enableSort&&(c.cellData.disableSort||(void 0!=b?l=b:(l++,l%=3),k.doSort(l,c.rowIndex,c.columnIndex,c),c.sortTypeIndex=l))},c.filterChange=function(a){k.doFilter(c.cellData)},c.togglePinning=function(a){c.cellData.children||c.cellData.parent||j.scope.enablePinning&&(c.cellData.disablePinning||(c.cellData.pinned=!c.cellData.pinned,k.doPinning(c.cellData)))};var n,o=!1,p=0,q=null,r=null;c.beginResize=function(b){if(j.scope.enableColumnResize){q=angular.element(b.target),o=!0,n=g(b),angular.element(document.body).bind("mousemove",h),angular.element(document.body).bind("mouseup",i),r=angular.element("<div class='base-line' ></div>"),j.scope.gridWrapperEl.append(r);var c=a.offset(q),d=a.offset(j.scope.gridWrapperEl);r.css("left",c.left-d.left+j.scope.gridWrapperEl[0].scrollLeft+"px"),b.preventDefault()}},c.doResize=h,c.stopResize=i}}}}}]).controller("graceGridHeaderController",["gridConstant",function(a){var b=this;b.sortTypes=["none","asc","des"],b.sortTypeIndexMap={none:0,asc:1,des:2},b.sorters={asc:function(a,b){var c=a-b;return isNaN(c)?a>b?1:a==b?0:-1:c},des:function(a,b){var c=b-a;return isNaN(c)?a>b?-1:a==b?0:1:c}},b.filters=[];var c={};b.addColumnScope=function(a){var b=a.cellData.field;c[b]=a},b.getColumnScope=function(a){return c[a]}}]).directive("graceGridHeader",["gridUtil",function(a){return{restrict:"EA",replace:!0,require:["^graceGrid","graceGridHeader"],controller:"graceGridHeaderController",templateUrl:"template/grid/gridHeader.html",
scope:{headerData:"="},compile:function(){return{post:function(a,b,c,d){var e=d[0],f=d[1],g="none",h=null;a.gridOptions=e.scope.gridOptions,a.gridScope=e.scope;var i=e.scope,j=null;f.doSort=function(b,c,d,i){j&&j.$id!=i.$id&&j.resetSort(),j=i,g=f.sortTypes[b],h=a.headerData.columns2Render[c][d],a.curRowIndex=c,a.curColumnIndex=d,e.applyCurrentData()},e.sortingExposed=function(a,b){var c=f.getColumnScope(a),d=f.sortTypeIndexMap[b];c&&void 0!=d&&c.valueClick(null,d)},e.sorting=function(a){if("none"!=g&&h){var b,c=h.sorter&&h.sorter[g]||f.sorters[g],d=h.sorterPro&&h.sorterPro[g],e=a.bodyInfo,j=e.rows2Render,k=a.headerInfo.columns.indexOf(h);if(b=d?function(a,b){return d(a.rowInfo.rawData,b.rowInfo.rawData)}:function(a,b){return c(a[k].content,b[k].content)},j.sort(b),i.expandableTable){var l=e.rowsChildrenMap2Render;for(var m in l)l[m].sort(b)}}},f.doFilter=function(a){-1==f.filters.indexOf(a)&&f.filters.push(a),e.applyCurrentData()},e.filtering=function(a){function b(b,c,e){for(var f,g=!0,h=0;f=d[h];h++){var i=b[a.headerInfo.columns.indexOf(f)].content;if(!i)return!1;if(g=-1!=(i+"").indexOf(f.filterKeyWord),!g)return!1}return g}for(var c,d=f.filters,e=[],g=0;c=d[g];g++)e.push(a.headerInfo.columns.indexOf(c));var h=a.bodyInfo,j=h.rows2Render;if(h.rows2Render=j.filter(b),i.expandableTable){var k=h.rowsChildrenMap2Render;for(var l in k)k[l]=k[l].filter(b)}},a.pinnings=[],f.doPinning=function(b){-1==a.pinnings.indexOf(b)?a.pinnings.push(b):a.pinnings.splice(a.pinnings.indexOf(b),1),e.applyCurrentData()},e.pinningExposed=function(a){var b=f.getColumnScope(a);b&&b.togglePinning(null)},e.pinning=function(b){for(var c=b.headerInfo,d=c.columns2Render,e=0,f=d[0].length;f>e;e++){var g=d[0][e];g.children||(g.pinnable=void 0===g.pinnable?!0:g.pinnable,-1!=a.pinnings.indexOf(g)&&(d[0].splice(e,1),e--,f-=1))}b.headerInfo.columns2Pinning=[a.pinnings];var h=b.bodyInfo;b.bodyInfo.rows2Pinning=[];for(var i,e=0;i=h.rows2Render[e];e++){for(var j,g=[],k=0;j=a.pinnings[k];k++)g.push(i.splice(j.columnIndex,1,null)[0]);g.rowInfo=i.rowInfo,i=i.filter(function(a){return null!=a}),i.rowInfo=g.rowInfo,h.rows2Render[e]=i,b.bodyInfo.rows2Pinning.push(g)}}}}}}}]).controller("graceGridBodyController",["$scope",function(a){}]).directive("graceGridBody",["gridUtil","$position","$compile",function(a,b,c){return{restrict:"EA",replace:!0,require:["^graceGrid","graceGridBody"],templateUrl:"template/grid/gridBody.html",controller:"graceGridBodyController",scope:{bodyData:"="},compile:function(){return{pre:function(a,b,c,d){},post:function(c,d,e,f){function g(a){return a=a.originalEvent||a,a.pageY}function h(b){var d=g(b),e=d-v;if(C.css(a.cssFixer({transform:"translateY("+e+"px)"})),c.gridScope.IE){for(var f,h=-1;(f=I[++h])&&!(d>=f[0]&&d<f[1]););F=h}b.preventDefault()}function i(a,b,c){var d=a[b];a[b]=a[c],a[c]=d}function j(a,b,c){var d=a[b].rowInfo.originalRowIndex;a[b].rowInfo.originalRowIndex=a[c].rowInfo.originalRowIndex,a[c].rowInfo.originalRowIndex=d}function k(b){var e=c.gridScope.bodyInfo.rows;i(e,E,F),j(e,E,F),e=c.gridScope.bodyInfo.rows2Render,i(e,E,F),e=c.gridScope.bodyInfo.rows2Pinning,i(e,E,F),C.css({position:"relative",zIndex:"0","pointer-events":"auto"}).css(a.cssFixer({transform:"translateY(0)"})),x&&x.remove(),z&&z.remove(),A&&A.remove(),B&&B.remove(),t(document.body).unbind("mousemove",h),t(document.body).unbind("mouseup",k),d.find("tr").unbind("mouseover",l)}function l(a){for(var b=a.target;"TR"!=b.tagName;)b=b.parentElement;F=b.getAttribute("tr-index"),F||(F=E)}function m(e,f,i){function j(a,c){var d=b.offset(t(a));I[c]=[d.top,d.top+d.height]}u=!0,v=g(f),F=E=i,w=t(d[0].querySelector(".pinning-body tr:nth-child("+(i+1)+")")),y=t(d[0].querySelector(".normal-body tr:nth-child("+(i+1)+")")),C=t(d[0].querySelectorAll("tr:nth-child("+(i+1)+")")),c.gridScope.IE&&(H=t(document.querySelectorAll(".normal-body tr")),G=t(document.querySelectorAll(".pinning-body tr")),I=[],a.forEach(H,j),I.length||a.forEach(G,j)),D=d.find("tr");var m=c.gridScope.headerInfo,n=m.columns2Pinning[0]&&m.columns2Pinning[0].length||0,o=m.columns.length-n;w[0]&&(x=t('<tr><td colspan="'+n+'" ></td></tr>'),x.css({width:w[0].offsetWidth+"px",height:w[0].offsetHeight+"px"}),w.css({position:"absolute",zIndex:10,"pointer-events":"none"}),A=t('<tr style="display: none;" ></tr>'),w.after(x).after(A)),y[0]&&(z=t('<tr><td colspan="'+o+'" ></td></tr>'),z.css({width:y[0].offsetWidth+"px",height:y[0].offsetHeight+"px"}),y.css({position:"absolute",zIndex:10,"pointer-events":"none"}),B=t('<tr style="display: none;" ></tr>'),y.after(z).after(B)),t(document.body).bind("mousemove",h),t(document.body).bind("mouseup",k),c.gridScope.IE||d.find("tr").bind("mouseover",l)}function n(a,b){var d=a.rowInfo.originalRowIndex,e=r.bodyInfo,f=e.rows[d];if(f.rowInfo.selected=!f.rowInfo.selected,"rowSelector"==f[0].type&&(f[0].displayContent=!f[0].displayContent),-1!=s.indexOf(d))s.splice(s.indexOf(d),1),c.$emit("selectOne",{selectOrUnSelect:!1}),q.event.trigger("rowUnSelect",[b,d,s]);else{if(r.enableSelectionMulti)s.push(d);else{var g=s[0];if(void 0!=g){var h=e.rows[g];"rowSelector"==h[0].columnType&&(h[0].displayContent=!1)}s[0]=d}c.$emit("selectOne",{selectOrUnSelect:!0}),q.event.trigger("rowSelect",[b,d,s])}}var o=f[0],p=f[1],q=o.gridApi,r=o.scope,s=[],t=angular.element;c.gridScope=o.scope,c.$on("gridReload",function(){s=[]}),"auto"==c.gridScope.rowHeight&&(c.rowHeightWatcher&&c.rowHeightWatcher(),c.rowHeightWatcher=c.$watch(function(){function a(a,c){b+=a.offsetHeight+","}G=t(document.querySelectorAll(".pinning-body tr")),H=t(document.querySelectorAll(".normal-body tr"));var b="";return angular.forEach(G,a),b=b.substr(0,b.length-1)+"_",angular.forEach(H,a),b=b.substr(0,b.length-1)},function(b){function c(a,b){var c=Math.max(d[b]||0,e[b]||0);a.offsetHeight<c&&(a.style.height=c+"px")}if(b){G=t(document.querySelectorAll(".pinning-body tr")),H=t(document.querySelectorAll(".normal-body tr")),b=b.split("_");var d=b[0].split(","),e=b[1].split(",");a.forEach(G,c),a.forEach(H,c)}}),c.$on("$destroy",function(){c.rowHeightWatcher()})),p.expandOrCollapseRow=function(a){r.expandableTable&&a.rowInfo.hasChildren&&(a.rowInfo.expanded?o.groupCollapse(a,function(){o.applyCurrentData()}):o.groupExpand(a,function(){o.applyCurrentData(),o.gridApi.event.trigger("afterExpandRow",[null,a.rowInfo.rawData])}))};var u=!1,v=0,w=null,x=null,y=null,z=null,A=null,B=null,C=null,D=null,E=0,F=0,G=null,H=null,I=null;c.rowClick=function(a,b){r.enableSelection&&!r.isDraggingMode&&(n(a,b),b.stopPropagation(),b.preventDefault())},c.rowMousedown=function(a,b,c){r.isDraggingMode&&m(a,b,c)},o.selectOne=n,o.selectAll=function(a,b){var d=b.selectOrUnSelect,e=c.gridScope,f=e.bodyInfo,g=f.rows;if(e.enableInfiniteScroll)var h=f.rows2RenderCache;else var h=f.rows2Render;d?(h.forEach(function(a){var b=a.rowInfo.originalRowIndex,c=g[b];c.rowInfo.selected=!0,"rowSelector"==c[0].type&&(c[0].displayContent=!0),-1==s.indexOf(b)&&s.push(b)}),q.event.trigger("rowSelectAll",[a,s])):(h.forEach(function(a){var b=a.rowInfo.originalRowIndex,c=g[b],d=s.indexOf(b);"rowSelector"==c[0].type&&(c[0].displayContent=!1),c.rowInfo.selected=!1,-1!=d&&s.splice(d,1)}),q.event.trigger("rowUnSelectAll",[a,s]))}}}}}}]).directive("graceGridPagination",["gridUtil","gridConstant","$http",function(a,b,c){return{restrict:"EA",replace:!0,require:["^graceGrid"],templateUrl:"template/grid/gridPagination.html",compile:function(){return{post:function(d,e,f,g){function h(){var b={url:l.url,dataType:l.dataType,method:l.method},e={rows:d.pageSize,page:d.currentPageIndex};if("get"==l.method){var f=e;l.externalParam&&(f=angular.extend(f,"function"==typeof l.externalParam?l.externalParam():l.externalParam)),b.params=f}else if("post"==l.method){var g=e,f={};b.headers={"Content-type":"application/x-www-form-urlencoded;charset=UTF-8"},l.externalParam&&(f="function"==typeof l.externalParam?l.externalParam():l.externalParam),l.externalData&&(g=angular.extend(g,"function"==typeof l.externalData?l.externalData():l.externalData),g=a.json2query(g)),b.params=f,b.data=g}c(b).success(function(a){l.resultParser&&(a=l.resultParser(a)),d.totalItems=a.records,i.options.gridData=a.rows,i.update(i.options)}).error(function(a){console.error(a)})}var i=g[0],j=i.scope,k=(j.headerInfo,j.paginationConfig);d.currentPageIndex=1,d.paginationSize=k.paginationSize||b.paginationSize,d.pageSizes=angular.copy(k.pageSizes),d.pageSize=k.pageSize,d.totalItems=j.bodyInfo.rows.length,-1==d.pageSizes.indexOf(d.pageSize)&&(d.pageSizes.push(d.pageSize),d.pageSizes.sort(function(a,b){return a-b})),d.changePage=function(){/^\d+$/.test(d.currentPageIndex+"")?d.currentPageIndex<1?d.currentPageIndex=1:d.currentPageIndex>d.totalPages&&(d.currentPageIndex=d.totalPages):d.currentPageIndex=1,i.gridApi.event.trigger("prePaging",[d.currentPageIndex,d.pageSize]),d.useRemoteData?h():i.applyCurrentData()},i.getCurrentPageData=function(a){return d.useRemoteData||(a=a.slice((d.currentPageIndex-1)*d.pageSize,d.pageSize*d.currentPageIndex)),a},i.paging=function(a){var b=a.bodyInfo,c=b.rows2Render;j.useRemoteData||(d.totalItems=b.rows.length),c=i.getCurrentPageData(c),b.rows2Render=c,i.gridApi.event.trigger("paging",[d.currentPageIndex,d.pageSize])},i.getPaginationHeight=function(){return e[0].offsetHeight};var l=d.ajaxConfig;i.reloadCurrentPage=h,d.useRemoteData&&h()}}}}}]).directive("graceGridScreen",["gridUtil","$position","$document",function(a,b,c){return{restrict:"EA",replace:!0,require:["^graceGrid"],templateUrl:"template/grid/gridScreener.html",compile:function(){return{pre:function(a,b,c,d){{var e=(d[0],a.headerInfo);a.bodyInfo}a.screener=[],a.visibleCount=0;for(var f,g=0;f=e.columns[g];g++)"rowSelector"!=f.columnType&&(a.screener.push({label:f.displayName,checked:f.visible,field:f.field}),f.visible&&a.visibleCount++)},post:function(a,d,e,f){function g(a){function b(a){if(a.children){var d=c.children;a.drawnWidth=0,a.colspan=0;for(var e,f=0;e=d[f];f++){var g=b(e);a.drawnWidth+=g.w,a.colspan+=g.cs}}return a.visible?{w:a.drawnWidth,cs:a.colspan}:{w:0,cs:0}}for(var c,d=0,e=0;c=a[0][e];e++)d+=b(c).w;return d}function h(){a.$apply(function(){a.dropDownConfig.active=!1})}{var i=f[0];i.gridApi}a.gridScope=i.scope,a.doCheck=function(b,c){var d=a.screener[b];a.visibleCount<=1&&d.checked||(d.checked=!d.checked,d.checked&&a.visibleCount++||a.visibleCount--,i.scope.headerInfo.columns[b].visible=d.checked,i.applyCurrentData(),c.preventDefault(),c.stopPropagation())},i.screening=function(a){var b=a.headerInfo,c=a.bodyInfo,d=b.columns2Render,e=g(d);b.totalWidth=e,c.totalWidth=e;for(var f,h=b.columns,j=c.rows2Render,k=0;f=j[k];k++)for(var l,m=0;l=h[m];m++)f[m].visible=l.visible;i.resizeAutoWidthColumns&&i.resizeAutoWidthColumns()},i.getScreenerHeight=function(){return d[0].offsetHeight},a.dropDownConfig={active:!1},a.showDropDown=function(c){var e=d[0].querySelector(".screen-drop-down-trigger"),f=d[0].querySelector(".screen-drop-down"),g=b.position(angular.element(e));f.style.top=g.top+g.height-1+"px",a.dropDownConfig.active=!0,c.preventDefault(),c.stopPropagation()},c.bind("click",h)}}}}}]).directive("graceGridScrollbarVertical",["gridUtil","$compile","gridConstant","$timeout","$document",function(a,b,c,d,e){return{restrict:"EA",replace:!0,template:'<div class="grace-grid-scrollbar-v" ></div>',require:["^graceGrid"],compile:function(){return{pre:function(c,d,e){var f=a,g="";"osx"==f.osType?(d.addClass("osx"),g+='<div class="scroll-handle-bar" ></div>'):(d.addClass("win"),g+='<div class="scroll-handle-button-up" ><i class="grace-icon-angle-up" ></i></div><div class="scroll-slot" ><div class="scroll-handle-bar" ></div></div><div class="scroll-handle-button-down" ><i class="grace-icon-angle-down" ></i></div>'),d.append(b(g)(c))},post:function(b,c,d,f){function g(a){a=a.originalEvent||a,w=a.pageY;var b=w-v;v=w;var c=parseFloat(r.css("top").replace("%","")),d=s[0].clientHeight,e=parseFloat(r.css("height").replace("%","")),f=b/d*100;c+=f,0>c&&(c=0),c>100-e&&(c=100-e),r.css("top",c+"%"),a.preventDefault()}function h(a){x=!1,c.removeClass("dragging");var d=b.bodyInfo,f=d.rows2RenderCache,i=d.rows2PinningCache,j=f.length||i&&i.length,k=parseFloat(r.css("top").replace("%",""));b.curStartIndex=parseInt(k/100*j),b.curEndIndex=b.curStartIndex+b.iSPageSize,q.infiniteScroll(),e.unbind("mousemove",g),e.unbind("mouseup",h)}function i(){var a=b.bodyInfo,c=a.height,d=0,e=b.rowHeight+d,f=c%e,g=Math.ceil(c/e),h=e-f;b.iSPageSize=g,b.bodyHeightOverFlow=h}function j(){var a=b.bodyInfo,c=a.rows2RenderCache,d=a.rows2PinningCache,e=c.length||d&&d.length,f=Math.floor(100*b.curStartIndex/e);r.css("top",f+"%")}function k(a,b){for(var c=0,d=a.length;d>c;c++)a[c]=b[c]}function l(a){var a=a.originalEvent||a;return void 0!==a.wheelDeltaY?a.wheelDeltaY:void 0!==a.wheelDelta?a.wheelDelta:a.detail}function m(a){if(!x){var c,d=l(a),e=b.bodyInfo;0!=d&&(e.rows2Render.length>=b.iSPageSize&&(c=d>0?o.cssFixer("transform","translateY(0px)"):o.cssFixer("transform","translateY("+-b.bodyHeightOverFlow+"px)"),b.gridWrapperEl.find("section").css(c)),A(l(a)),a.wheelDeltaX||y&&d>0||z&&0>d||a.preventDefault())}}function n(d){var e=b.gridWrapperEl[0].scrollLeft,f=a.cssFixer("transform","translateX("+e+"px)");c.css(f)}var o=a,p=angular.element,q=f[0],r=(b.gridWrapperEl.find("section"),p(c[0].querySelector(".scroll-handle-bar")));if("osx"==o.osType)var s=c;else{var s=p(c[0].querySelector(".scroll-slot")),t=p(c[0].querySelector(".scroll-handle-button-up")),u=p(c[0].querySelector(".scroll-handle-button-down"));t.bind("click",function(a){b.$apply(function(){q.infiniteScroll(1)})}),u.bind("click",function(a){b.$apply(function(){q.infiniteScroll(-1)})})}s.bind("click",function(a){});var v,w,x=!1;r.bind("mousedown",function(a){a=a.originalEvent||a,x=!0,c.addClass("dragging"),v=a.pageY,e.bind("mousemove",g),e.bind("mouseup",h)}),b.$watch(function(){if(!b.bodyInfo||!b.bodyInfo.rows2Render||!b.bodyInfo.rows2RenderCache)return void 0;var a=b.bodyInfo.rows2RenderCache.length,c=b.bodyInfo.rows2Render.length;return a+","+c},function(a){if(a){var d=a.split(",");b.scrollHandlerBarLen=Math.max(Math.ceil(d[1]/d[0]*100),5),r.css("height",b.scrollHandlerBarLen+"%");var e=parseInt(d[1])<parseInt(d[0]);c.css({height:b.bodyInfo.height+"px",top:"auto"}),c[e?"addClass":"removeClass"]("is-visible")}}),b.curStartIndex=0,b.iSPageSize,b.scrollHandlerBarLen=5,q.infiniteScrollStart=function(){void 0==b.iSPageSize&&i();var a=(b.infiniteScrollConfig,b.bodyInfo),c=a.rows2Render,d=a.rows2Pinning,e=b.iSPageSize;void 0===b.curEndIndex&&(b.curEndIndex=e),b.curEndIndex>c.length&&(c.length>e?(b.curEndIndex=c.length,b.curStartIndex=b.curEndIndex-e):(b.curStartIndex=0,b.curEndIndex=b.curStartIndex+e)),a.rows2Render=c.slice(b.curStartIndex,b.curEndIndex),a.rows2RenderCache=c,y=0==b.curStartIndex,z=b.curEndIndex==c.length,b.enablePinning&&(a.rows2Pinning=d.slice(b.curStartIndex,b.curEndIndex),a.rows2PinningCache=d),j()};var y=!1,z=!1;q.infiniteScroll=function(a){var c=b.infiniteScrollConfig,d=c.iStep;if(a=a>0?-d:0==a?0:d,0!==a){var e=b.bodyInfo,f=e.rows2RenderCache,g=e.rows2PinningCache;b.curStartIndex+a<0?(b.curStartIndex=0,b.curEndIndex=b.iSPageSize):b.curStartIndex+b.iSPageSize+a>f.length?(b.curStartIndex=f.length-b.iSPageSize,b.curEndIndex=f.length):(b.curStartIndex+=a,b.curEndIndex+=a);var h=f.slice(b.curStartIndex,b.curEndIndex);k(e.rows2Render,h),b.enablePinning&&(h=g.slice(b.curStartIndex,b.curEndIndex),k(e.rows2Pinning,h)),y=0==b.curStartIndex,z=b.curEndIndex==f.length,j()}};var A=o.delayExe(function(a){q.infiniteScroll(a)},50),B=o.browserType.firefox?"DOMMouseScroll":"mousewheel";b.bindInfiniteScroll=function(){b.unbindInfiniteScroll(),b.gridWrapperEl.bind(B,m).bind("scroll",n)},b.unbindInfiniteScroll=function(){b.gridWrapperEl.unbind(B,m).unbind("scroll",n)},b.bindInfiniteScroll()}}}}}]).factory("gridUtil",["$timeout",function(a){function b(a,b){for(var c=["webkit","Moz","ms","o"],d={},e=0,f=c.length;f>e;e++)d[c[e]+a.replace(/^\w/,a[0].toUpperCase())]=b;return d}var c={};c.newId=function(){var a=(new Date).getTime();return function(){return a+=1}}(),c.isEmptyObject=function(a){if("object"==typeof a)for(var b in a)return!1;return!0},c.formatStr=function(a){var b=arguments;return a.replace(/{(\d+)}/g,function(a,c,d){return b[c]})},c.copy2DArray=function(a){for(var b,c=[],d=0;b=a[d];d++){for(var e,f=[],g=0;e=b[g];g++)f.push(e);c.push(f)}return c},c.getStyles=function(a){var b=a;return"undefined"!=typeof b.length&&b.length&&(b=a[0]),b.ownerDocument.defaultView.getComputedStyle(b,null)},c.delayExe=function(b,c){var d=!0,e=b;return function(f){d&&(e&&e(f),e=null,d=!1,a(function(){b(f),d=!0},c))}},c.browserType=function(){var a=navigator.userAgent;return{ie:/MSIE/i.test(a)||/trident/i.test(a),chrome:/chrome.*safari/i.test(a),safari:/version.*safari/i.test(a),firefox:/gecko.*firefox/i.test(a)}}(),c.osType=function(){var a=navigator.platform;return/mac/i.test(a)?"osx":/win/i.test(a)?"windows":/x11/i.test(a)?"unix":/linux/i.test(a)?"linux":"other"}(),c.getScrollBarInfo=function(){var a=document.createElement("div");a.style.cssText="position:absolute;left:0;top:0;width:100px;height:100px;overflow:scroll;visibility:hidden",document.body.appendChild(a);var b={verticalBarWidth:a.offsetWidth-a.clientWidth,horizontalBarHeight:a.offsetHeight-a.clientHeight};return document.body.removeChild(a),b};var d={transform:!0,"box-shadow":!0};return c.register2Hack=function(a){d[a]=!0},c.cssFixer=function(){if(2==arguments.length)return d[arguments[0]]?b.apply(null,arguments):arguments;var a=arguments[0],c=[a];for(var e in a)c.push(b(e,a[e]));return angular.extend.apply(angular,c),a},c.isElementVisible=function(a){for(;a[0]&&a[0]!=document;){if("none"===c.getStyles(a).display)return!1;a=a.parent()}return!0},c.forEach=function(a,b){if(b)for(var c=0,d=a.length;d>c;c++)b&&b(a[c],c)},c.json2query=function(a){var b=[];for(var c in a)b.push(c+"="+a[c]);return b.join("&")},c.isEmptyObj=function(a){if(!a)return!0;for(var b in a)return!1;return!0},c}]).directive("graceGridStyle",["gridUtil","$interpolate",function(a,b){return{link:function(a,c,d,e){var f=b(c.text(),!0);f&&a.$watch(f,function(a){c.text(a)})}}}]),angular.module("grace.bootstrap.input",[]).constant("graceInputConstant",{enter:"请输入",type:["text","number","password"],typeReg:{number:/^[-\+]?\d+(\.\d+)?$/},requireText:"该字段不能为空"}).factory("graceInputService",["graceInputConstant",function(a){function b(b){return angular.isObject(b.label)||(b.label={text:b.label,style:{}}),b.input&&b.input.type&&-1==a.type.indexOf(b.input.type)&&(b.input.type=""),angular.isUndefined(b.$v)&&(b.$v={}),angular.isUndefined(b.value)&&(b.value=""),b}function c(a){return angular.isUndefined(a)||""===a||null===a||a!==a}return{formatConfig:b,isEmpty:c}}]).directive("graceInput",["graceInputService","graceInputConstant",function(a,b){return{restrict:"EA",replace:!0,require:["^?graceFieldManager"],templateUrl:"template/input/input.html",scope:{config:"="},link:function(c,d,e,f){c.first=!0,d.find("input").blur(function(){c.$apply(function(){c.first=!1})}),c.$watch("config",function(d,e){if(d){a.formatConfig(c.config);var f,g,h=c.config.$v,i=!0;if(d.input){if(f=d.input.valid){var j=f.validFn.call(this,d.value);(!j||angular.isArray(j)&&!j[0])&&(h.text=j?j[1]:f.inValidText,i=!1)}a.isEmpty(d.value)?angular.isDefined(d.input.require)&&d.input.require&&(h.text=b.requireText,i=!1):("number"==(g=d.input.type)&&!b.typeReg[g].test(d.value)&&(d.value=e.value),d.input.maxLength&&d.input.maxLength<d.value.length&&(d.value=e.value)),i&&(h.text="")}}},!0),c.getValue=function(){return c.config.value},c.getName=function(){return c.config.input?c.config.input.name:""},f.length&&f[0]&&f[0].addField({type:"input",element:d,scope:c})}}}]),angular.module("grace.bootstrap.transition",[]).factory("$transition",["$q","$timeout","$rootScope",function(a,b,c){function d(a){for(var b in a)if(void 0!==f.style[b])return a[b]}var e=function(d,f,g){g=g||{};var h=a.defer(),i=e[g.animation?"animationEndEventName":"transitionEndEventName"],j=function(a){c.$apply(function(){d.unbind(i,j),h.resolve(d)})};return i&&d.bind(i,j),b(function(){angular.isString(f)?d.addClass(f):angular.isFunction(f)?f(d):angular.isObject(f)&&d.css(f),i||h.resolve(d)}),h.promise.cancel=function(){i&&d.unbind(i,j),h.reject("Transition cancelled")},h.promise},f=document.createElement("trans"),g={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",transition:"transitionend"},h={WebkitTransition:"webkitAnimationEnd",MozTransition:"animationend",OTransition:"oAnimationEnd",transition:"animationend"};return e.transitionEndEventName=d(g),e.animationEndEventName=d(h),e}]),angular.module("grace.bootstrap.modal",["grace.bootstrap.transition"]).factory("$$stackedMap",function(){return{createNew:function(){var a=[];return{add:function(b,c){a.push({key:b,value:c})},get:function(b){for(var c=0;c<a.length;c++)if(b==a[c].key)return a[c]},keys:function(){for(var b=[],c=0;c<a.length;c++)b.push(a[c].key);return b},top:function(){return a[a.length-1]},remove:function(b){for(var c=-1,d=0;d<a.length;d++)if(b==a[d].key){c=d;break}return a.splice(c,1)[0]},removeTop:function(){return a.splice(a.length-1,1)[0]},length:function(){return a.length}}}}}).directive("modalBackdrop",["$timeout",function(a){return{restrict:"EA",replace:!0,templateUrl:"template/modal/backdrop.html",link:function(b,c,d){b.backdropClass=d.backdropClass||"",b.animate=!1,a(function(){b.animate=!0})}}}]).directive("modalWindow",["$modalStack","$timeout",function(a,b){return{restrict:"EA",scope:{index:"@",animate:"="},replace:!0,transclude:!0,templateUrl:function(a,b){return b.templateUrl||"template/modal/window.html"},link:function(c,d,e){d.addClass(e.windowClass||""),c.size=e.size,b(function(){c.animate=!0,d[0].querySelectorAll("[autofocus]").length||d[0].focus()}),c.close=function(b){var c=a.getTop();c&&c.value.backdrop&&"static"!=c.value.backdrop&&b.target===b.currentTarget&&(b.preventDefault(),b.stopPropagation(),a.dismiss(c.key,"backdrop click"))}}}}]).directive("modalTransclude",function(){return{link:function(a,b,c,d,e){e(a.$parent,function(a){b.empty(),b.append(a)})}}}).factory("$modalStack",["$transition","$timeout","$document","$compile","$rootScope","$$stackedMap",function(a,b,c,d,e,f){function g(){for(var a=-1,b=n.keys(),c=0;c<b.length;c++)n.get(b[c]).value.backdrop&&(a=c);return a}function h(a){var b=c.find("body").eq(0),d=n.get(a).value;n.remove(a),j(d.modalDomEl,d.modalScope,300,function(){d.modalScope.$destroy(),b.toggleClass(m,n.length()>0),i()})}function i(){if(k&&-1==g()){var a=l;j(k,l,150,function(){a.$destroy(),a=null}),k=void 0,l=void 0}}function j(c,d,e,f){function g(){g.done||(g.done=!0,c.remove(),f&&f())}d.animate=!1;var h=a.transitionEndEventName;if(h){var i=b(g,e);c.bind(h,function(){b.cancel(i),g(),d.$apply()})}else b(g)}var k,l,m="modal-open",n=f.createNew(),o={};return e.$watch(g,function(a){l&&(l.index=a)}),c.bind("keydown",function(a){var b;27===a.which&&(b=n.top(),b&&b.value.keyboard&&(a.preventDefault(),e.$apply(function(){o.dismiss(b.key,"escape key press")})))}),o.open=function(a,b){n.add(a,{deferred:b.deferred,modalScope:b.scope,backdrop:b.backdrop,keyboard:b.keyboard});var f=c.find("body").eq(0),h=g();if(h>=0&&!k){l=e.$new(!0),l.index=h;var i=angular.element("<div modal-backdrop></div>");i.attr("backdrop-class",b.backdropClass),k=d(i)(l),f.append(k)}var j=angular.element("<div modal-window></div>");j.attr({"template-url":b.windowTemplateUrl,"window-class":b.windowClass,size:b.size,index:n.length()-1,animate:"animate"}).html(b.content);var o=d(j)(b.scope);n.top().value.modalDomEl=o,f.append(o),f.addClass(m)},o.close=function(a,b){var c=n.get(a);c&&(c.value.deferred.resolve(b),h(a))},o.dismiss=function(a,b){var c=n.get(a);c&&(c.value.deferred.reject(b),h(a))},o.dismissAll=function(a){for(var b=this.getTop();b;)this.dismiss(b.key,a),b=this.getTop()},o.getTop=function(){return n.top()},o}]).provider("$modal",function(){var a={options:{backdrop:!0,keyboard:!0},$get:["$injector","$rootScope","$q","$http","$templateCache","$controller","$modalStack",function(b,c,d,e,f,g,h){function i(a){return a.template?d.when(a.template):e.get(angular.isFunction(a.templateUrl)?a.templateUrl():a.templateUrl,{cache:f}).then(function(a){return a.data})}function j(a){var c=[];return angular.forEach(a,function(a){(angular.isFunction(a)||angular.isArray(a))&&c.push(d.when(b.invoke(a)))}),c}var k={};return k.open=function(b){var e=d.defer(),f=d.defer(),k={result:e.promise,opened:f.promise,close:function(a){h.close(k,a)},dismiss:function(a){h.dismiss(k,a)}};if(b=angular.extend({},a.options,b),b.resolve=b.resolve||{},!b.template&&!b.templateUrl)throw new Error("One of template or templateUrl options is required.");var l=d.all([i(b)].concat(j(b.resolve)));return l.then(function(a){var d=(b.scope||c).$new();d.$close=k.close,d.$dismiss=k.dismiss;var f,i={},j=1;b.controller&&(i.$scope=d,i.$modalInstance=k,angular.forEach(b.resolve,function(b,c){i[c]=a[j++]}),f=g(b.controller,i),b.controller&&(d[b.controllerAs]=f)),h.open(k,{scope:d,deferred:e,content:a[0],backdrop:b.backdrop,keyboard:b.keyboard,backdropClass:b.backdropClass,windowClass:b.windowClass,windowTemplateUrl:b.windowTemplateUrl,size:b.size})},function(a){e.reject(a)}),l.then(function(){f.resolve(!0)},function(){f.reject(!1)}),k},k}]};return a}),angular.module("grace.bootstrap.nav",[]).directive("graceNav",["$rootScope",function(a){return{restrict:"AE",replace:!0,templateUrl:"template/nav/nav.html",scope:{navsData:"=",vm:"="},link:function(a,b,c,d){}}}]),angular.module("grace.bootstrap.radio",[]).factory("radioService",[function(){function a(a){return angular.isFunction(a)?a:angular.noop}return{fn:a}}]).controller("RadioController",["$scope","radioService",function(a,b){a.data||(a.data={setting:{},list:[]}),a.radioConfig={selectIndex:0,extraCSS:"default",callback:{onChange:null}};var c=function(b){angular.extend(a.radioConfig,b)};a.$watch("data.setting",function(b){c(b),a.select(a.radioConfig.selectIndex)}),a.select=function(b){return arguments.length?void(a.currentSelect=b):a.currentSelect},a.getCurrentItem=function(){return{item:a.data.list[a.currentSelect],index:a.currentSelect}},a.selectByFilter=function(b){if(angular.isFunction(b))for(var c=a.data.list,d=0,e=c.length;e>d;d++)if(b(c[d],d,c)){a.select(d);break}},a.$watch("currentSelect",function(c,d){b.fn(a.radioConfig.callback.onChange)(a.data.list[c],c,a.data.list),a.result=a.data.list[c]})}]).directive("graceRadio",["radioService",function(a){return{restrict:"A",replace:!0,scope:{data:"=?graceRadio",result:"=?result"},templateUrl:"template/radio/radio.html",controller:"RadioController",link:function(a,b,c,d){}}}]),angular.module("grace.bootstrap.select",["grace.bootstrap.dropdown"]).directive("graceSelect",[function(){return{restrict:"EA",replace:!0,require:["^?graceFieldManager"],templateUrl:"template/select/select.html",scope:{config:"="},link:function(a,b,c,d){var e=a.config.value;a.selectItem=function(b){a.currentItem=b},a.select=function(b){if(angular.isFunction(b))for(var c=a.config.list,d=0,e=c.length;e>d;d++)if(b(c[d],d,c)){a.selectItem(c[d]);break}},angular.isDefined(e)&&a.select(function(a){return a.value===e}),a.$watch("currentItem",function(b,c){angular.isDefined(b)&&(a.config.value=b.value)}),b.find("div.item-select").focus(function(){$(this).addClass("focus")}).blur(function(){$(this).removeClass("focus")}),a.getValue=function(){return a.config.value},a.getName=function(){return a.config.input?a.config.input.name:""},d.length&&d[0]&&d[0].addField({type:"select",element:b,scope:a}),a.config.api={select:a.select,selectItem:a.selectItem}}}}]);var app=angular.module("grace.bootstrap.selectByGroup",["grace.bootstrap.position"]).controller("selectByGroupController",["$scope","$http",function(a,b){function c(a){for(var b in a)return!1;return!0}function d(a,b,c){var d={};return e(b,d,c),d}function e(a,b,c){for(var d,e=0;d=a[e];e++)(!c||c(d))&&(b[d.code]=d)}var f=["A-E","F-J","K-O","P-T","U-Z"];a.curCode="",a.$watch("data",function(){if(a.data&&a.data.length){if(a.baseFirst=a.data[0],a.curCode=a.baseFirst.code,"own"==a.curCode)a.selectionData=a.baseFirst.children;else{a.selectionData={title:[],body:[]},a.selectionData.title=f;for(var b,c=0;b=f[c];c++)a.selectionData.body.push(a.baseFirst.children[b])}a.changTitle(0)}}),a.changeSelectionShow=function(){},a.changTitle=function(b){a.index=b,"own"==a.curCode?a.curDataList=a.selectionData:(a.curTitle=a.selectionData.title[b],a.curDataList=a.selectionData.body[b])},a.doSearch=function(b){a.searchResult23=d(b,a.curDataList,function(a){return-1!=a.name.indexOf(b)}),a.searchResult23Empty=c(a.searchResult23),a.$apply()},a.nodeClick=function(b){a.ngModel=b,a.ngModel.pid=a.curCode,angular.element(".selectionList").hide(),angular.element(".selectByGroup").parent().css("height","auto")}}]).directive("graceSelectByGroup",["$window","$position",function(a,b){return{restrict:"EA",require:["graceSelectByGroup","^ngModel"],controller:"selectByGroupController",templateUrl:"template/selectByGroup/selectByGroup.html",replace:!0,scope:{data:"=",ngModel:"="},link:function(c,d,e,f){function g(a,b){var c=!0;return function(d){c&&(a(d),c=!1,setTimeout(function(){c=!0},b))}}var h=angular.element(a),i=null;h.on("click",function(){c.$apply(function(){angular.element(".selectionList",d).hide()}),i&&i.css({height:"auto"})}),angular.element(".selectionList").on("click",function(a){a.originalEvent.cancelBubble=!0}),d.on("click",".selection",function(a){if(!angular.isArray(c.selectionData)||c.selectionData.length){angular.element(".selectionList").hide(),curEl=angular.element(a.currentTarget);var e=curEl.parent(),f=b.position(e),g=b.offset(e),h=angular.element(".selectionList",d);h.toggle();var j=i=curEl.parent().parent();j.css({height:"auto"});var k=b.offset(j);h.css({top:g.top+g.height+8-k.top,left:0}),h.find(".selection-arrow").css({left:f.left+f.width/2});var l=b.offset(h);l.top+l.height>k.height+k.top&&j.css({height:l.top-k.top+l.height}),a.originalEvent.cancelBubble=!0}});var j=g(function(a){var b=angular.element(a.target),d=b.val();d?c.doSearch(d):b.parent().find(".selection-search-searchbtn").triggerHandler("click")},100);d.find(".selection-search-searchbox").bind("keyup",j)}}}]);angular.module("grace.bootstrap.string",[]).service("$gStringService",[function(){var a=this;a.trim=function(a){return a.replace(/(^\s+)|(\s+$)|(^　+)|(　+$)/g,"")},a.ltrim=function(a){return a.replace(/(^\s+)|(^　+)/g,"")},a.rtrim=function(a){return a.replace(/(\s+$)|(　+$)/g,"")},a.isNumber=function(a){return a.isInt()||a.isFloat()||a.isPercent()},a.isFloat=function(a){return/^(?:-?|\+?)\d+(,\d\d\d)*\.\d+$/g.test(a)},a.isInt=function(a){return/^(?:-?|\+?)\d+(,\d\d\d)*$/g.test(a)},a.isPercent=function(a){return/^(?:-?|\+?)\d+(,\d\d\d)*(\.\d+)?\%$/g.test(a)},a.isPlus=function(b){return a.isPlusInt()||a.isPlusFloat()},a.isPlusFloat=function(a){return/^\+?\d*\.\d+$/g.test(a)},a.isPlusInt=function(a){return/^\+?\d+$/.test(a)},a.isMinus=function(b){return a.isMinusInt()||a.isMinusFloat()},a.isMinusFloat=function(a){return/^-\d*\.\d+$/g.test(a)},a.isMinusInt=function(a){return/^-\d+$/g.test(a)},a.isLeastCharSet=function(a){return!/[^A-Za-z0-9_]/g.test(a)},a.isEmail=function(a){return/^\w+@.+\.\w+$/g.test(a)},a.isZip=function(a){return/^\d{6}$/g.test(a)},a.isPhone=function(a){return/^(\d{2,4}-)?((\(\d{3,5}\))|(\d{3,5}-))?\d{3,18}(-\d+)?$/g.test(a)},a.isMobile=function(a){return/^((13)|(15))\d{9}$/g.test(a)},a.isTel=function(b){return a.isMobileTelephone()||a.isFixedTelephone()},a.hasMark=function(a){var b=new RegExp("("+_mark+")","g");return(a.match(b)?a.match(b).length:0)>0},a.getLen=function(a){var b=a.match(/[^\x00-\xff]/gi);return a.length+(null==b?0:b.length)},a.encodeHtml=function(a){var b=/"|&|'|<|>|[\x00-\x20]|[\x7F-\xFF]|[\u0100-\u2700]/g,c=a.toString();return"string"!=typeof c?c:c.replace(b,function(a){var b=a.charCodeAt(0),c=["&#"];return b=32==b?160:b,c.push(b),c.push(";"),c.join("")})},a.format=function(a){var b=arguments;return a.replace(/{(\d+)}/g,function(a,c,d){
return b[c]})},a.decodeHtml=function(a){var b=/&\w+;|&#(\d+);/g,c={"&lt;":"<","&gt;":">","&amp;":"&","&nbsp;":" ","&quot;":'"',"&copy;":""},d=a.toString();return"string"!=typeof d?d:d.replace(b,function(a,b){var d=c[a];return void 0==d&&(d=isNaN(b)?a:String.fromCharCode(160==b?32:b)),d})}}]),angular.module("grace.bootstrap.summary",["grace.bootstrap.tooltip"]).constant("summaryConfig",{footLeft:{},footRight:{},mainValue:{},maxItemCount:5,deepWatch:!1}).controller("summaryController",["$scope","summaryConfig","summaryFactory","$attrs",function(a,b,c,d){a.selectedIndex=0,a.curSummrayData=null,a.overFlowData=null,a.selectedOverFlow=null,a.selectedOverFlowIndex=0,d.summaryOptions&&(a.options=a.$parent.$eval(d.summaryOptions));var e=this;a.options&&(a.maxItemCount=a.options.maxItemCount||b.maxItemCount),a.options&&(a.deepWatch=a.options.deepWatch||b.deepWatch),a.itemClick=function(b,c){a.summaryData[b].disable||(a.selectedIndex=b,a.onSelect&&a.onSelect(b,a.summaryData[b]))},a.overFlowItemClick=function(b){a.selectedOverFlow&&0!=a.selectedOverFlowIndex&&(a.selectedIndex=a.maxItemCount-1,a.onSelect&&a.onSelect(a.maxItemCount+a.selectedOverFlowIndex-2,a.selectedOverFlow))},a.onSelectClick=function(a){a.preventDefault(),a.stopPropagation()},a.overFlowItemChanged=function(b){a.selectedOverFlowIndex=a.overFlowData.indexOf(a.selectedOverFlow),0!=a.selectedOverFlowIndex&&(a.selectedIndex=a.maxItemCount-1,e.odometerUpdateByIndex(a.selectedIndex),a.onSelect&&a.onSelect(a.maxItemCount+a.selectedOverFlowIndex-2,a.selectedOverFlow))},this.updateData=function(b){if(b){var d=c.formatData(b,a);d.length>a.maxItemCount?(a.curSummaryData=d.slice(0,a.maxItemCount-1),a.overFlowData=d.slice(a.maxItemCount-1),a.overFlowData.unshift({title:"请选择"}),a.selectedOverFlow=a.overFlowData[a.selectedOverFlowIndex]):a.curSummaryData=d}}}]).factory("summaryFactory",["$filter",function(a){function b(a,b){var c={value:"",style:"","class":"",format:""};if(b&&(c=angular.extend(c,b)),"string"==typeof a)c.value=a;else{if("object"!=typeof a)return null;angular.extend(c,a)}return c}function c(a,c){d=c.options;for(var e,f=[],g=0;e=a[g];g++){var h=angular.extend({},e);h.mainValue=b(h.mainValue,d.main),h.footLeftValue=b(h.footLeftValue,d.footLeft),h.footRightValue=b(h.footRightValue,d.footRight),f.push(h)}return f}var d=null;return{formatData:c}}]).filter("summaryFilter",["$filter",function(a){function b(b,c){b=parseFloat(b);var d=c.split("_"),e=a("number")(b,d[1]||0);return d[2]&&b>0&&(e="+"+e),e}var c=/number/,d=/percent/,e=/date_/,f=/currency/;return function(g,h){return c.test(h)?g=b(g,h):d.test(h)?g=b(g,h)+"%":e.test(h)?g=a("date")(g,h.replace("date_","")):f.test(h)&&(g=a("currency")(g,h.replace(/currency_?/,"")||"￥")),g}}]).directive("graceSummary",["$timeout","$window","summaryConfig",function(a,b,c){return{restrict:"A",scope:{summaryData:"=",onSelect:"=?",triggerSelectOnLoaded:"@?"},replace:!0,templateUrl:"template/summary/summary.html",controller:"summaryController",link:function(c,d,e,f){function g(b){b&&(b=c.summaryData,f.updateData(b),a(function(){h=d.find(".odometer"),h.each(f.odometerUpdateByIndex)},10))}a(function(){b.Odometer&&Odometer.init()},0);var h;f.odometerUpdateByIndex=function(a){a>=c.curSummaryData.length?c.selectedOverFlow&&c.selectedOverFlow.mainValue&&$(h[a]).html(c.selectedOverFlow.mainValue.value):$(h[a]).html(c.curSummaryData[a].mainValue.value)},c.options.deepWatch?c.$watch(function(){for(var a,b=c.summaryData,d="",e=0;a=b[e];e++)d+=a.mainValue.value,a.footLeftValue&&(d+=a.footLeftValue.value),a.footRightValue&&(d+=a.footRightValue.value);return d},g):c.$watch("summaryData",g)}}}]),angular.module("grace.bootstrap.summaryList",["grace.bootstrap.tooltip","grace.bootstrap.dataFormatter"]).controller("SummaryListController",["$scope","$gDataFormatterFactory",function(a,b){a.format=function(a){if(!a)return a;for(var c=0,d=a.length;d>c;c++)a[c].format&&(a[c].value=b(a[c].value,a[c].format));return a},a.adapterDataLength=function(a){var b=a.data;if(!b)return a;for(var c=0,d=0,e=0,f=0;4>f;f++)b[f]||b.push({});if(b.length>4){if(c=Math.floor(b.length/4),d=b.length%4,c>1){b[0]=[b[0]],b[1]=[b[1]],b[2]=[b[2]],b[3]=[b[3]];for(var f=1;c>f;f++)e=4*f,b[0].push(b[e]),b[1].push(b[e+1]),b[2].push(b[e+2]),b[3].push(b[e+3])}for(var f=0;d>f;f++)b[f]instanceof Array||(b[f]=[b[f]]),b[f].push(b[4*c+f]);b.splice(4),a.height||(a.height=40*(c+(d>0?1:0))-10)}return a}}]).directive("graceSummaryList",function(){return{templateUrl:"template/summaryList/summaryList.html",restrict:"AE",scope:{summaryListData:"="},controller:"SummaryListController",link:function(a,b,c,d){a.summaryListData.data&&a.summaryListData.data.length>0&&(a.summaryListData.data=a.format(a.summaryListData.data),a.summaryListData=a.adapterDataLength(a.summaryListData)),a.rowheight=a.summaryListData.height?a.summaryListData.height:40,b.find("h3").css("height",a.rowheight+"px").css("line-height",a.rowheight+"px")}}});var app=angular.module("grace.bootstrap.table",["grace.bootstrap.dropdown"]).constant("tableConfig",{autoIncrement:!1,enableFn:!0,fnThText:"操作",NORMAL_TYPE:"x,xxx.xx",formatType:null,isFormat:!1}).config(["$sceProvider",function(a){a.enabled(!1)}]).controller("tableController",["$scope","tableConfig","$http","tableFactory",function(a,b,c,d){a.autoIncrement=b.autoIncrement,a.enableFn=b.enableFn,a.fnThText=b.fnThText,a.isArray=function(a){return a instanceof Array&&a instanceof Object?!0:!1},a.isObject=function(a){return a instanceof Object&&!(a instanceof Array)?!0:!1},a.isFnConfig=function(a){return"object"==typeof a&&a.fn?!0:!1},a.isFnCell=function(b){return a.isFnConfig(a.isArray(b)?b[0]:b)},a.searchData=function(b,c){var d=b.target,e=angular.element(d).parent().find("input").val();if(13===b.keyCode||"undefined"==typeof b.keyCode){if(!a.action)return void console.error("Table: Search Title Must Have Action");a.action({code:c.code,query:e})}},a.$watch("tableData",function(b){b&&d.formatData(a,b)}),a.isThEmpty=function(){return a.tableData&&a.tableData.head[0]?!1:!0},a.editCell=function(b,c,d){a.curEditItem=c,a.curColIndex=d},a.onEditDispatch=function(){var b=a.tableData.head,c=b[a.curColIndex];c.onEdit&&c.onEdit(b,a.curEditItem,a.curColIndex)},a.tipBubbleFormatter=function(a){return a?(angular.isNumber(a)&&(a+=""),a.replace(/<.*?>/g,"")):a},a.onFilterDispatch=function(b,c){b.selected=b.filter[c],a.filterAction&&a.filterAction(b,b.selected),console.log(arguments)},a.htmlLog=function(){console.log(arguments)}}]).factory("tableFactory",["tableConfig",function(a){function b(b,c){var d=c.body,e=c.head,f=[],g=[];g=g.concat(e),b.autoIncrement&&g.unshift({name:"",code:null}),b.enableFn&&g.push({name:b.fnThText,code:null});for(var h,i=0;h=g[i];i++)h.isSearch&&(h.type="search"),"filter"==h.type&&(h.selected||(h.selected=h.filter[0]));for(var j,k=0;j=d[k];k++){var l=[];l=l.concat(j),b.autoIncrement&&l.unshift(k+1),a.enableFn&&!j.$$fn?j.$$fn=[{name:"remove",text:"删除",iconClass:"",fn:function(a){console.log("to remove...")}},{name:"modify",text:"修改",iconClass:"",fn:function(a){console.log("to modify...")}}]:a.enableFn&&(l.$$fn=j.$$fn),f.push(l)}c.body=f,c.head=g}return{formatData:b}}]).filter("tableFilter",["tableConfig","$filter",function(a,b){function c(a){var c=(""+a).match(/(-?|\+?){0,1}([\d\.]+)(%?)$/);return!c||isNaN(c[2])?a:(c[2]=c[2].replace(/\.0*$/,""),c[2]=100*parseFloat(c[2]),c[2]=(""+c[2]).replace(/(\.\d{2}).*/,"$1"),c[3]=c[3]?c[3]:"%",(c[1]?c[1]:"")+b("number")(c[2])+c[3])}function d(a){var b=a;return b=(new Date(a)+"").match(/\d{2}:\d{2}:\d{2}/)[0].split(":"),b[0]=(parseInt(b[0])-8+"").replace(/^(\d?)(\d)$/,function(){return(arguments[1]?arguments[1]:"0")+arguments[3]}),b.join(":")}function e(a){var c=(""+a).match(/^(-?|\+?){0,1}([\d\.]+)(%?)$/);return!c||isNaN(c[2])?a:(c[2]=c[2].replace(/\.0*$/,""),a=(""+c[2]).replace(/(\.\d{2}).*/,"$1"),(c[1]?c[1]:"")+b("number")(a)+(c[3]?c[3]:""))}return function(b,f){if("SkuId"==f||"TimeDay"==f||"BatchesId"==f||"BatchId"==f)return b;if(a.isFormat&&a.formatType==a.NORMAL_TYPE||a.isFormat&&!a.formatType){var g=val=b;switch(f){case"BouncesRate":case"SiteConversionRate":case"GoalConversionRate":case"NewVisitorVisitsPercent":g=c(val);break;case"AvgPageRt":g=d(1e3*val);break;case"AvgLoadSec":g=(val/1e3).toFixed(2)+"s";break;case"AvgSiteRt":g=d(1e3*val);break;default:g=e(val)}return g}return b}}]).directive("graceTable",["tableConfig",function(a){return{restrict:"EA",require:["graceTable"],controller:"tableController",templateUrl:"template/table/table.html",replace:!0,scope:{tableData:"=",action:"=",filterAction:"="},link:function(b,c,d){function e(a){var b=a.find(".grace-table-group");b.remove(),a.children().show()}"true"==d.autoIncrement&&(b.autoIncrement=!0),d.fnThText&&(b.fnThText=d.fnThText),d.formatType&&(a.formatType=d.formatType),d.isFormat&&(a.isFormat=!!d.isFormat),"true"==d.enableFn?b.enableFn=!0:b.enableFn=!1;var f=angular.element(c),g=!1,h=null;f.on("click",".grace-table-btn-edit",function(a){var c=angular.element(a.currentTarget),d=c.parent();h&&d!=h&&e(h),h=d,c.prev().hide(),c.hide();var f="<span class='grace-table-group' autofocus ><input class='grace-table-input-edit' /><i class='grace-table-btn-ok' >&#10004;</i><i class='grace-table-btn-cancel'>&#10008;</i></span>",i=angular.element(f);d.append(i),i.find(".grace-table-input-edit").val(b.curEditItem[b.curColIndex]),g=!0}).on("click",".grace-table-btn-ok",function(a){var c=angular.element(a.currentTarget);console.log("ok.......");var d=c.parent(),f=d.parent(),g=d.find(".grace-table-input-edit"),h=g.val();return h?(b.$apply(function(){b.curEditItem[b.curColIndex]=h,b.onEditDispatch()}),void e(f)):void alert("不能为空")}).on("click",".grace-table-btn-cancel",function(a){var b=angular.element(a.currentTarget);console.log("cancel....");var c=b.parent(),d=c.parent();e(d)}).on("keyup",".grace-table-input-edit",function(a){{var b=angular.element(a.currentTarget),c=b.parent(),d=(c.parent(),b);d.val()}13==a.keyCode&&c.find(".grace-table-btn-ok").trigger("click")}).on("click",function(a){a.stopPropagation()}).on("click","span.grace-table-group",function(a){a.stopPropagation()})}}}]).directive("graceTableCell",function(){return{restrict:"A",require:"^graceTable",scope:{cellData:"="},link:function(a,b){var c=a.cellData;if("object"==typeof c){b.html(c[0]);for(var d,e="",f=1;d=c[f];f++)e+="<div>"+d+"</div>";e&&b.after(angular.element(e))}else b.html(c)}}});angular.module("grace.bootstrap.tabs",[]).controller("TabsetController",["$scope",function(a){var b=this,c=b.tabs=a.tabs=[];b.select=function(a){angular.forEach(c,function(b){b.active&&b!==a&&(b.active=!1,b.onDeselect())}),a.active=!0,a.onSelect()},b.addTab=function(a){c.push(a),1===c.length?a.active=!0:a.active&&b.select(a)},b.removeTab=function(a){var d=c.indexOf(a);if(a.active&&c.length>1){var e=d==c.length-1?d-1:d+1;b.select(c[e])}c.splice(d,1)}}]).directive("tabset",function(){return{restrict:"EA",transclude:!0,replace:!0,scope:{type:"@"},controller:"TabsetController",templateUrl:"template/tabs/tabset.html",link:function(a,b,c){a.vertical=angular.isDefined(c.vertical)?a.$parent.$eval(c.vertical):!1,a.justified=angular.isDefined(c.justified)?a.$parent.$eval(c.justified):!1}}}).directive("tab",["$parse",function(a){return{require:"^tabset",restrict:"EA",replace:!0,templateUrl:"template/tabs/tab.html",transclude:!0,scope:{active:"=?",heading:"@",onSelect:"&select",onDeselect:"&deselect"},controller:function(){},compile:function(b,c,d){return function(b,c,e,f){b.$watch("active",function(a){a&&f.select(b)}),b.disabled=!1,e.disabled&&b.$parent.$watch(a(e.disabled),function(a){b.disabled=!!a}),b.select=function(){b.disabled||(b.active=!0)},f.addTab(b),b.$on("$destroy",function(){f.removeTab(b)}),b.$transcludeFn=d}}}}]).directive("tabHeadingTransclude",[function(){return{restrict:"A",require:"^tab",link:function(a,b,c,d){a.$watch("headingElement",function(a){a&&(b.html(""),b.append(a))})}}}]).directive("tabContentTransclude",function(){function a(a){return a.tagName&&(a.hasAttribute("tab-heading")||a.hasAttribute("data-tab-heading")||"tab-heading"===a.tagName.toLowerCase()||"data-tab-heading"===a.tagName.toLowerCase())}return{restrict:"A",require:"^tabset",link:function(b,c,d){var e=b.$eval(d.tabContentTransclude);e.$transcludeFn(e.$parent,function(b){angular.forEach(b,function(b){a(b)?e.headingElement=b:c.append(b)})})}}}),angular.module("template/checkbox/checkbox.html",[]).run(["$templateCache",function(a){a.put("template/checkbox/checkbox.html",'<div class="grace-checkbox">\n	<div ng-repeat="ck in checkboxList" ng-click="changeboxChange(ck, $event)" class="grace-checkbox-item {{horizontal}}">\n		<i ng-class="{checked:ck.checked}"></i><input type="checkbox" value="ck.value" ng-model="ck.checked"/><label >{{ck.text}}</label>\n	</div>\n</div>\n')}]),angular.module("template/chosenAssociate/chosenAssociate.html",[]).run(["$templateCache",function(a){a.put("template/chosenAssociate/chosenAssociate.html",'<div class="grace-select-by-associate">\n	<div class="associate-input" id="chose-single" ng-show="!plural"><span ng-bind="ngModel.selected.name"></span><b></b></div>\n	<div class="associate-input" id="chose-plural" ng-show="plural">\n		<span class="choice-close" ng-repeat="con in ngModel.selected"><a ng-mouseup="choiceCloseClick(con)"></a><i ng-class="con.class" ng-bind-html="trust(con.name)"></i></span>\n		<input class="plural-expression" ng-model="expression" ng-focus="getWidth($event)" ng-blur="setWidth($event)"  ng-keyup="selectFuzzy()" type="text"/>\n	</div>\n	<div class="associate-body body-plural{{plural}}" ng-style={display:bodyShow?\'block\':\'none\'}>\n		<input class="associate-expression" ng-show="!plural" type="text" ng-model="expression" ng-keyup="selectFuzzy()"/>\n		<div class="associate-box">\n	        <p ng-show="!currentPageData.length">\n	            没有匹配项\n	        </p>\n		    <ul class="chosen chosen{isPaging}">\n		        <li ng-repeat="con in currentPageData">\n		            <a ng-click="changeConfigured(con)" ng-bind-html="trust(con.name)"></a>\n		        </li>\n		    </ul>\n		    <div class="pagination-container found-pages" ng-show="isPaging" style="position:relative;">\n		        <div class="pagination-info">\n		            <span>共{{pagegroup.totalPages}}页</span>\n		            <span>到第<input pagination-input tableType="pagegroup" type="tel"/>页</span>\n		        </div>\n		        <pagination ng-change="pagegroup.changePage()" boundary-links="true" total-items="pagegroup.totalItems"\n		                    ng-model="pagegroup.currentPage" items-per-page="pagegroup.itemsPerPage" class="pagination-sm"\n		                    previous-text="&lsaquo;" next-text="&rsaquo;" first-text="&laquo;"\n		                    last-text="&raquo;"></pagination>\n		    </div>\n		</div>\n	</div>\n\n</div>')}]),angular.module("template/datepicker/datepicker.html",[]).run(["$templateCache",function(a){a.put("template/datepicker/datepicker.html",'<div ng-switch="datepickerMode" role="application" ng-keydown="keydown($event)" class="grc datepicker" >\n  <grace-daypicker  ng-switch-when="day" tabindex="0"></grace-daypicker>\n  <grace-monthpicker  ng-switch-when="month" tabindex="0"></grace-monthpicker>\n  <grace-yearpicker  ng-switch-when="year" tabindex="0"></grace-yearpicker>\n    <grace-hourpicker ng-switch-when="hour" tabindex="0"></grace-hourpicker>\n    <grace-minutepicker ng-switch-when="minute" tabindex="0"></grace-minutepicker>\n</div>')}]),angular.module("template/datepicker/daterangepicker.html",[]).run(["$templateCache",function(a){a.put("template/datepicker/daterangepicker.html",'<div ng-switch="datepickerMode" role="application" ng-keydown="keydown($event)" class="grc datepicker" >\n    <grace-daypicker-range ng-switch-when="day" tabindex="0"></grace-daypicker-range>\n</div>')}]),angular.module("template/datepicker/day.html",[]).run(["$templateCache",function(a){a.put("template/datepicker/day.html",'<table role="grid" class="day-picker" aria-labelledby="{{uniqueId}}-title" aria-activedescendant="{{activeDateId}}">\n  <thead>\n    <tr>\n      <th class="th-arrow"><button type="button" class="btn btn-default btn-sm pull-left" ng-click="move(-1)" tabindex="-1"><i class="grace-icon-chevron-left"></i></button></th>\n      <th colspan="{{5 + showWeeks}}" class="th-header"><button id="{{uniqueId}}-title" role="heading" aria-live="assertive" aria-atomic="true" type="button" class="btn btn-default btn-sm" ng-class="{\'click-disabled\': switchDisabled}" ng-click="toggleMode()" tabindex="-1" style="width:100%;"><strong>{{title}}</strong></button></th>\n      <th class="th-arrow"><button type="button" class="btn btn-default btn-sm pull-right" ng-click="move(1)" tabindex="-1"><i class="grace-icon-chevron-right"></i></button></th>\n    </tr>\n    <tr>\n      <th ng-show="showWeeks" class="text-center">周</th>\n      <th ng-repeat="label in labels track by $index" class="text-center"><small aria-label="{{label.full}}">{{label.abbr}}</small></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr ng-repeat="row in rows track by $index">\n      <td ng-show="showWeeks" class="text-center h6">\n          <em class="btn btn-default btn-sm"\n                  ng-click="selectWeek(weekNumbers[$index])" ng-class="{active: weekNumbers[$index].selected}">{{ weekNumbers[$index].week }}</em>\n      </td>\n      <td ng-repeat="dt in row track by dt.date" class="text-center" role="gridcell" id="{{dt.uid}}" aria-disabled="{{!!dt.disabled}}">\n        <button type="button" style="width:100%;" class="btn btn-default btn-sm"\n                ng-class="{\'btn-info\': dt.selected, active: dt.selected,\'cell-muted\': dt.secondary,weekend:dt.weekend}"\n                ng-click="select(dt.date)" ng-disabled="dt.disabled" tabindex="-1">\n            <span ng-class="{\'text-muted\': dt.secondary, \'text-info\': dt.current}">{{dt.label}}</span></button>\n      </td>\n    </tr>\n  </tbody>\n</table>\n')}]),angular.module("template/datepicker/dayrange.html",[]).run(["$templateCache",function(a){a.put("template/datepicker/dayrange.html",'<div class="datepicker-group" >\n    <table role="grid" class="day-picker" aria-labelledby="{{uniqueId}}-title" aria-activedescendant="{{activeDateId}}" ng-repeat="rows in rowsGroup track by $index">\n        <thead>\n        <tr>\n            <th class="th-arrow"><button type="button" class="btn btn-default btn-sm pull-left" ng-click="move(-1)" tabindex="-1"><i class="grace-icon-chevron-left"></i></button></th>\n            <th colspan="{{5 + showWeeks}}" class="th-header"><button id="{{uniqueId}}-title" role="heading" aria-live="assertive" aria-atomic="true" type="button" class="btn btn-default btn-sm" ng-class="{\'click-disabled\': switchDisabled}" ng-click="toggleMode()" tabindex="-1" style="width:100%;"><strong>{{titles[$index]}}</strong></button></th>\n            <th class="th-arrow"><button type="button" class="btn btn-default btn-sm pull-right" ng-click="move(1)" tabindex="-1"><i class="grace-icon-chevron-right"></i></button></th>\n        </tr>\n        <tr>\n            <th ng-show="showWeeks" class="text-center">周</th>\n            <th ng-repeat="label in labels track by $index" class="text-center"><small aria-label="{{label.full}}">{{label.abbr}}</small></th>\n        </tr>\n        </thead>\n        <tbody ng-init="weekNumbers = weekNumbersGroup[$index]" >\n        <tr ng-repeat="row in rows track by $index">\n            <td ng-show="showWeeks" class="text-center h6">\n                <em class="btn btn-default btn-sm"\n                    ng-click="selectWeek(weekNumbers[$index])" ng-class="{active: weekNumbers[$index].selected}">{{ weekNumbers[$index].week }}</em>\n            </td>\n            <td ng-repeat="dt in row track by dt.date" class="text-center" role="gridcell" id="{{dt.uid}}" aria-disabled="{{!!dt.disabled}}">\n                <button type="button" style="width:100%;"\n                        class="btn btn-default btn-sm" ng-class="{\'btn-info\': dt.selected, active: dt.selected, \'cell-muted\': dt.secondary,\'weekend\':dt.weekend}"\n                        ng-click="select(dt.date)" ng-disabled="dt.disabled" tabindex="-1">\n                    <span ng-class="{\'text-muted\': dt.secondary, \'text-info\': dt.current}">{{dt.label}}</span>\n                </button>\n            </td>\n        </tr>\n        </tbody>\n    </table>\n</div>\n\n')}]),angular.module("template/datepicker/hour.html",[]).run(["$templateCache",function(a){a.put("template/datepicker/hour.html",'<table role="grid" class="hour-picker" aria-labelledby="{{uniqueId}}-title" aria-activedescendant="{{activeDateId}}">\n    <thead>\n    <tr>\n        <th class="th-arrow"><button type="button" class="btn btn-default btn-sm pull-left" ng-click="move(-1)" tabindex="-1"><i class="grace-icon-chevron-left"></i></button></th>\n        <th colspan="3"  class="th-header"><button id="{{uniqueId}}-title" role="heading" aria-live="assertive" aria-atomic="true" type="button" class="btn btn-default btn-sm" ng-class="{\'click-disabled\': switchDisabled}" ng-click="toggleMode()" tabindex="-1" style="width:100%;"><strong>{{title}}</strong></button></th>\n        <th class="th-arrow"><button type="button" class="btn btn-default btn-sm pull-right" ng-click="move(1)" tabindex="-1"><i class="grace-icon-chevron-right"></i></button></th>\n    </tr>\n    </thead>\n    <tbody>\n    <tr ng-repeat="row in rows track by $index">\n        <td ng-repeat="dt in row track by dt.date" class="text-center" role="gridcell" id="{{dt.uid}}" aria-disabled="{{!!dt.disabled}}">\n            <button type="button"\n                    style="width:100%;"\n                    class="btn btn-default"\n                    ng-class="{\'btn-info\': dt.selected, active: isActive(dt)}"\n                    ng-click="select(dt.date)"\n                    ng-disabled="dt.disabled"\n                    ng-if="!!dt"\n                    tabindex="-1"><span ng-class="{\'text-info\': dt.current}">{{dt.label}}</span></button>\n        </td>\n    </tr>\n    </tbody>\n</table>\n')}]),angular.module("template/datepicker/minuteOrSecond.html",[]).run(["$templateCache",function(a){a.put("template/datepicker/minuteOrSecond.html",'<table role="grid" class="minuteOrSecond-picker" aria-labelledby="{{uniqueId}}-title" aria-activedescendant="{{activeDateId}}">\n    <thead>\n    <tr>\n        <th class="th-arrow"><button type="button" class="btn btn-default btn-sm pull-left" ng-click="move(-1)" tabindex="-1"><i class="grace-icon-chevron-left"></i></button></th>\n        <th colspan="3"  class="th-header"><button id="{{uniqueId}}-title" role="heading" aria-live="assertive" aria-atomic="true" type="button" class="btn btn-default btn-sm" ng-class="{\'click-disabled\': switchDisabled}" ng-click="toggleMode()" tabindex="-1" style="width:100%;"><strong>{{title}}</strong></button></th>\n        <th class="th-arrow"><button type="button" class="btn btn-default btn-sm pull-right" ng-click="move(1)" tabindex="-1"><i class="grace-icon-chevron-right"></i></button></th>\n    </tr>\n    </thead>\n    <tbody>\n    <tr ng-repeat="row in rows track by $index">\n        <td ng-repeat="dt in row track by dt.uid" class="text-center" role="gridcell" id="{{dt.uid}}" aria-disabled="{{!!dt.disabled}}">\n            <button type="button"\n                    style="width:100%;"\n                    class="btn btn-default"\n                    ng-class="{\'btn-info\': dt.selected, active: isActive(dt)}"\n                    ng-click="select(dt.date)"\n                    ng-disabled="dt.disabled"\n                    ng-if="!!dt.date"\n                    tabindex="-1"><span ng-class="{\'text-info\': dt.current}">{{dt.label}}</span></button>\n        </td>\n    </tr>\n    </tbody>\n</table>\n')}]),angular.module("template/datepicker/month.html",[]).run(["$templateCache",function(a){a.put("template/datepicker/month.html",'<table role="grid" class="month-picker" aria-labelledby="{{uniqueId}}-title" aria-activedescendant="{{activeDateId}}">\n  <thead>\n    <tr>\n      <th class="th-arrow"><button type="button" class="btn btn-default btn-sm pull-left" ng-click="move(-1)" tabindex="-1"><i class="grace-icon-chevron-left"></i></button></th>\n      <th class="th-header"><button id="{{uniqueId}}-title" role="heading" aria-live="assertive" aria-atomic="true" type="button" class="btn btn-default btn-sm" ng-class="{\'click-disabled\': switchDisabled}" ng-click="toggleMode()" tabindex="-1" style="width:100%;"><strong>{{title}}</strong></button></th>\n      <th class="th-arrow"><button type="button" class="btn btn-default btn-sm pull-right" ng-click="move(1)" tabindex="-1"><i class="grace-icon-chevron-right"></i></button></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr ng-repeat="row in rows track by $index">\n      <td ng-repeat="dt in row track by dt.date" class="text-center" role="gridcell" id="{{dt.uid}}" aria-disabled="{{!!dt.disabled}}">\n        <button type="button" style="width:100%;" class="btn btn-default" ng-class="{\'btn-info\': dt.selected, active: isActive(dt)}" ng-click="select(dt.date)" ng-disabled="dt.disabled" tabindex="-1"><span ng-class="{\'text-info\': dt.current}">{{dt.label}}</span></button>\n      </td>\n    </tr>\n  </tbody>\n</table>\n')}]),angular.module("template/datepicker/popup.html",[]).run(["$templateCache",function(a){a.put("template/datepicker/popup.html",'<ul class="dropdown-menu" id="{{uniqId}}" ng-style="{display: (isOpen && \'block\') || \'none\', top: position.top+\'px\', left: position.left+\'px\'}" ng-keydown="keydown($event)">\n	<li ng-transclude></li>\n	<li ng-if="showButtonBar" style="padding:10px 9px 2px">\n		<span class="btn-group">\n			<button ng-if="showCurrentButton"  type="button" class="btn btn-sm btn-info" ng-click="select(\'today\')">{{ getText(\'current\') }}</button>\n			<button ng-if="showClearButton" type="button" class="btn btn-sm btn-danger" ng-click="select(null)">{{ getText(\'clear\') }}</button>\n            <button ng-if="showEnterButton" type="button" class="btn btn-sm btn-info" ng-click="enter()" >{{ getText(\'enter\') }}</button>\n		</span>\n		<button ng-if="showCloseButton" type="button" class="btn btn-sm btn-success pull-right" ng-click="close()">{{ getText(\'close\') }}</button>\n	</li>\n</ul>\n')}]),angular.module("template/datepicker/year.html",[]).run(["$templateCache",function(a){a.put("template/datepicker/year.html",'<table role="grid" class="year-picker" aria-labelledby="{{uniqueId}}-title" aria-activedescendant="{{activeDateId}}">\n  <thead>\n    <tr>\n      <th class="th-arrow"><button type="button" class="btn btn-default btn-sm pull-left" ng-click="move(-1)" tabindex="-1"><i class="grace-icon-chevron-left"></i></button></th>\n      <th colspan="3" class="th-header"><button id="{{uniqueId}}-title" role="heading" aria-live="assertive" aria-atomic="true" type="button" ng-class="{\'click-disabled\': switchDisabled}" class="btn btn-default btn-sm" ng-click="toggleMode()" tabindex="-1" style="width:100%;"><strong>{{title}}</strong></button></th>\n      <th class="th-arrow"><button type="button" class="btn btn-default btn-sm pull-right" ng-click="move(1)" tabindex="-1"><i class="grace-icon-chevron-right"></i></button></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr ng-repeat="row in rows track by $index">\n      <td ng-repeat="dt in row track by dt.date" class="text-center" role="gridcell" id="{{dt.uid}}" aria-disabled="{{!!dt.disabled}}">\n        <button type="button" style="width:100%;" class="btn btn-default" ng-class="{\'btn-info\': dt.selected, active: isActive(dt)}" ng-click="select(dt.date)" ng-disabled="dt.disabled" tabindex="-1"><span ng-class="{\'text-info\': dt.current}">{{dt.label}}</span></button>\n      </td>\n    </tr>\n  </tbody>\n</table>\n')}]),angular.module("template/dimension/dimension.html",[]).run(["$templateCache",function(a){a.put("template/dimension/dimension.html",'<section>\n    <section class="grace-section-dimension01" >\n        <div class="grace-dimension-0" ng-show="showContrastOption" ><dt><label>维度对比</label> </dt><span ng-click="checkContrast()" class="grace-dimension-contrast"  ng-class="{\'on\':isContrast}" ></span></div>\n        <dl ng-repeat="node0 in dimensionData"  class="grace-dimension-0" >\n            <dt><label>{{node0.name}}:</label></dt>\n            <dd ng-repeat="node1 in node0.children"  ng-class="{checked:node1.checked}" >\n                <a ng-click="nodeClick($event,node1)" >{{node1.name}}</a>\n                <span ng-if="node1.children.length" ng-click="showSubDimension($event,node1)" class="grace-dimension-dropdown level{{node1.level}}" >\n                    <i></i>\n                </span>\n            </dd>\n        </dl>\n        <dl class="grace-dimension-0 selected" >\n            <dt><label>已选择：</label></dt>\n            <dd ng-repeat="(k,s) in selected" class="checked" >\n                <a>{{s.nameChain.join(\' > \')}}</a>\n                <span class="grace-dimension-x" ng-click="cancelSelect(k)" >&times;</span>\n            </dd>\n        </dl>\n        <div class="grace-dimension-0" >\n            <span class="grace-dimension-button" ng-click="onAction()" ng-class="{disable:!selectedNode.length}" >查询</span>\n        </div>\n    </section>\n    <section class="grace-section-dimension23" ng-show="showDimension23" >\n        <div>\n            <div class="grace-search-group" >\n                <input type="text" placeholder="请输入要搜索的内容" level="23"  class="grace-dimension-searchbox" />\n                <span class="grace-dimension-searchbtn" ></span>\n                <span class="grace-searchbox-closebtn" ng-click="closeSearchBox(23)" ng-show="searchKeyWord23" >&times;</span>\n                <div class="grace-searchbox-searchResult" ng-show="!searchResult23Empty" >\n                    <span class="grace-searchbox-resultItem"  ng-repeat="item in searchResult23" ng-click="nodeClick($event,item)" ng-class="{checked:item.checked}" >{{item.name}}</span>\n                </div>\n            </div>\n        </div>\n        <div class="grace-dimension-2"  >\n            <div ng-repeat="c2 in curDimensionData23.children" >\n                <ul>\n                    <div><a ng-class="{checked:c2.checked}" ng-click="nodeClick($event,c2)" >{{c2.name}}</a></div>\n                    <li ng-repeat="c3 in c2.children" ng-class="{checked:c3.checked}" >\n                        <a ng-click="nodeClick($event,c3)" >{{c3.name}}</a>\n                        <span ng-if="c3.children.length" ng-click="showSubDimension($event,c3)" class="grace-dimension-dropdown level{{c3.level}}" >\n                            <i></i>\n                        </span>\n                    </li>\n                </ul>\n            </div>\n        </div>\n        <i class="grace-dimension-arrow" ></i>\n    </section>\n    <section class="grace-section-dimension45" ng-show="showDimension45" >\n        <div>\n            <div class="grace-search-group" >\n                <input type="text" placeholder="请输入要搜索的内容" class="grace-dimension-searchbox" level="45" />\n                <span class="grace-dimension-searchbtn" ></span>\n                <span class="grace-searchbox-closebtn" ng-click="closeSearchBox(45)" ng-show="searchKeyWord45" >&times;</span>\n                <div class="grace-searchbox-searchResult" ng-show="!searchResult45Empty" >\n                    <span class="grace-searchbox-resultItem"  ng-repeat="item in searchResult45" ng-click="nodeClick($event,item)" ng-class="{checked:item.checked}"  >{{item.name}}</span>\n                </div>\n            </div>\n\n        </div>\n        <div class="grace-dimension-4" >\n            <div ng-repeat="c4 in curDimensionData45.children" >\n                <ul>\n                    <div><a ng-class="{checked:c4.checked}" ng-click="nodeClick($event,c4)" >{{c4.name}}</a></div>\n                    <li ng-repeat="c5 in c4.children" ng-class="{checked:c5.checked}" >\n                        <a ng-click="nodeClick($event,c5)" >{{c5.name}}</a>\n                    </li>\n                </ul>\n            </div>\n        </div>\n        <i class="grace-dimension-arrow" ></i>\n    </section>\n\n</section>');

}]),angular.module("template/dimensionBaseSelect/dimensionBaseSelect.html",[]).run(["$templateCache",function(a){a.put("template/dimensionBaseSelect/dimensionBaseSelect.html",'<div class="grace-search-conditions clearfix">\n   <div class="search-item-title clearfix">\n       <span class="search-title" code="{{data.code}}">{{data.name}}</span> <span class="semicolon-right">:</span>\n   </div>\n   <div class="search-list">\n       <div class="search-label" ng-class="{hidelist:hideList}" ng-repeat="di in data.detail">\n           <span ng-class="{active:(selStatus.indexOf(di.code)>-1 && isMult), active2:(selStatus.indexOf(di.code)>-1 && !isMult), active3:!isMult}"  ng-click="select(di,$index)" code="{{di.code}}">\n            <div ng-if="isMult" class="occupy" ng-class="{active:selStatus.indexOf(di.code)>-1}"></div> {{di.name}}\n           </span>\n       </div>\n       <div class="search-custom" ng-class="{showcustom:hideList}">\n           <input class="city-input" placeholder="搜索省份及城市" ng-keyup="keyUp($event)"/>\n           <span class="cancel-button" ng-click="return()">取消</span>\n       </div>\n   </div>\n</div>')}]),angular.module("template/dimensionBaseSelect/dimensionSelectWithCheckBox.html",[]).run(["$templateCache",function(a){a.put("template/dimensionBaseSelect/dimensionSelectWithCheckBox.html",'<div class="grace-search-conditions clearfix">\n    <div class="clearfix">\n        <div class="search-item-title clearfix">\n            <span class="search-title" code="{{data.code}}">{{data.name}}</span> <span class="semicolon-right">:</span>\n        </div>\n        <div class="search-list">\n            <div class="search-label" ng-repeat="di in data.detail">\n                <span ng-class="{active:selStatus.indexOf(di.code)>-1?true:false, active1:di.checkboxselect, di_sel: di.isDrop, active4:di.detail}" ng-click="select(di, $index, data.detail)" code="{{di.code}}">\n                    <div ng-if="!di.detail" class="occupy" ng-class="{active:selStatus.indexOf(di.code)>-1?true:false, active2:(di._checked)}"></div>\n                    <i style="font-style: normal;" ng-bind="di.name"></i>\n                    <em class="triangle-png-down" ng-if="di.detail"></em>\n                </span>\n                <div ng-if="di.detail" class="cond-dropdown" ng-show="di.showCheckBoxList" ng-mouseleave="hideCheckboxList(di)">\n                    <ul>\n                        <li ng-repeat="diDrop in di.detail" style="border-bottom:0px;">\n                            <label>\n                                <div name="{{diDrop.code}}" code="{{diDrop.code}}" ng-click="updateShowButtonForCheck(diDrop.code, di)">\n                                    <div class="occupy" ng-class="{active:selStatus.indexOf(diDrop.code)>-1?(di._checked=true):false}" ></div>\n                                    <i style="font-style: normal;" ng-bind="diDrop.name"></i>\n                                </div>\n                            </label>\n                        </li>\n                    </ul>\n                </div>\n            </div>\n        </div>\n    </div>\n    <div class="ordertypediv clearfix" style="display: none;">\n        <div class="ordertypediv-content">\n            <ul>\n                <li ng-repeat="val in _orderType" class="">\n                    <div class="dropdownshowbutton clearfix">{{val.newName}}\n                        <div class="close-img" ng-click="updateShowButton(val.code)"><div>\n                        </div>\n                </li>\n            </ul>\n        </div>\n    </div>\n</div>\n')}]),angular.module("template/dimensionBaseSelect/dimensionSelectWithCustom.html",[]).run(["$templateCache",function(a){a.put("template/dimensionBaseSelect/dimensionSelectWithCustom.html",'<div class="grace-search-conditions clearfix">\n   <div class="search-item-title">\n       <span class="search-title" code="{{data.code}}">{{data.name}}</span><span class="semicolon-right">:</span>\n   </div>\n   <div class="search-list">\n       <div class="search-label"  ng-class="{hidelist:hideList}" ng-repeat="di in data.detail">\n           <!--<span ng-class="{active:selStatus.indexOf(di.code)>-1?true:false}"  ng-click="select(di,$index)" code="{{di.code}}">-->\n           <span ng-if="!isCustom(di)" ng-class="{active:(selStatus.indexOf(di.code)>-1 && isMult), active2:(selStatus.indexOf(di.code)>-1 && !isMult), active3:!isMult}"  ng-click="select(di,$index)" code="{{di.code}}">\n               <div ng-if="isMult" class="occupy" ng-class="{active:selStatus.indexOf(di.code)>-1?true:false}"></div> {{di.name}}\n           </span>\n           <span id="graceDiCustom" ng-if="isCustom(di)" class="custom"  ng-class="{active: customSelected}"  ng-click="select(di,$index)" code="{{di.code}}">\n           {{di.name}}\n           </span>\n       </div>\n       <div  class="search-custom" ng-class="{showcustom:hideList}">\n           <input id="graceDiCusInputBox" class="city-input" placeholder="搜索省份及城市"/>\n           <span class="cancel-button" ng-click="return()">取消</span>\n       </div>\n   </div>\n</div>')}]),angular.module("template/dimensionBaseSelect/dimensionSelectWithRadioBox.html",[]).run(["$templateCache",function(a){a.put("template/dimensionBaseSelect/dimensionSelectWithRadioBox.html",'<div class="grace-search-conditions clearfix">\n    <div class="clearfix">\n        <div class="search-item-title clearfix">\n            <span class="search-title" code="{{data.code}}">{{data.name}}</span>\n            <span class="semicolon-right">:</span>\n        </div>\n        <div class="search-list">\n            <div class="search-label" ng-repeat="di in data.detail">\n                <span ng-class="{active:selStatus.indexOf(di.code)>-1?true:false, active1:di.checkboxselect, di_sel: di.isDrop, active4:di.detail}" ng-click="select(di, $index, data.detail)" code="{{di.code}}">\n                    <div ng-if="!di.detail" class="occupy" ng-class="{active:selStatus.indexOf(di.code)>-1?true:false, active2:(di._checked)}"></div>\n                    <i style="font-style: normal;" ng-bind="di.name"></i>\n                    <em class="triangle-png-down" ng-if="di.detail" ng-click="hideCheckboxListForClick(di, di.isDrop, $event)"></em>\n                </span>\n                <div ng-if="di.detail" class="cond-dropdown" ng-show="di.showCheckBoxList" ng-mouseleave="hideCheckboxList(di)">\n                    <ul style="min-width: 90px;margin: 5px 0;">\n                        <li ng-repeat="diDrop in di.detail" style="border-bottom:0px;">\n                            <label style="padding: 0;">\n                                <div name="{{diDrop.code}}" code="{{diDrop.code}}" ng-click="updateShowButtonForCheck(diDrop.code, di)" ng-class="{activeradio:selStatus.indexOf(diDrop.code)>-1?(di._checked=true):false}" style="padding-left: 10px;">\n                                    {{diDrop.name}}\n                                </div>\n                            </label>\n                        </li>\n                    </ul>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>')}]),angular.module("template/pagination/pager.html",[]).run(["$templateCache",function(a){a.put("template/pagination/pager.html",'<ul class="pager">\n  <li ng-class="{disabled: noPrevious(), previous: align}"><a href ng-click="selectPage(page - 1)">{{getText(\'previous\')}}</a></li>\n  <li ng-class="{disabled: noNext(), next: align}"><a href ng-click="selectPage(page + 1)">{{getText(\'next\')}}</a></li>\n</ul>')}]),angular.module("template/pagination/pagination.html",[]).run(["$templateCache",function(a){a.put("template/pagination/pagination.html",'<ul class="pagination">\n  <li ng-if="boundaryLinks" ng-class="{disabled: noPrevious()}"><a href ng-click="selectPage(1)">{{getText(\'first\')}}</a></li>\n  <li ng-if="directionLinks" ng-class="{disabled: noPrevious()}"><a href ng-click="selectPage(page - 1)">{{getText(\'previous\')}}</a></li>\n  <li ng-repeat="page in pages track by $index" ng-class="{active: page.active}"><a href ng-click="selectPage(page.number)">{{page.text}}</a></li>\n  <li ng-if="directionLinks" ng-class="{disabled: noNext()}"><a href ng-click="selectPage(page + 1)">{{getText(\'next\')}}</a></li>\n  <li ng-if="boundaryLinks" ng-class="{disabled: noNext()}"><a href ng-click="selectPage(totalPages)">{{getText(\'last\')}}</a></li>\n</ul>')}]),angular.module("template/tooltip/tooltip-html-unsafe-popup.html",[]).run(["$templateCache",function(a){a.put("template/tooltip/tooltip-html-unsafe-popup.html",'<div class="grace-tooltip {{placement}}" ng-class="{ in: isOpen(), fade: animation() }">\n  <div class="grace-tooltip-arrow"></div>\n  <div class="grace-tooltip-inner" grace-bind-html-unsafe="content"></div>\n</div>\n')}]),angular.module("template/tooltip/tooltip-popup.html",[]).run(["$templateCache",function(a){a.put("template/tooltip/tooltip-popup.html",'<div class="grace-tooltip {{placement}}" ng-class="{ in: isOpen(), fade: animation() }">\n  <div class="grace-tooltip-arrow"></div>\n  <div class="grace-tooltip-inner" ng-bind="content"></div>\n</div>\n')}]),angular.module("template/grid/grid.html",[]).run(["$templateCache",function(a){a.put("template/grid/grid.html","<div class=\"grace-grid-container grace-grid-container{{gridId}}\" >\n    <style grace-grid-style >\n        .grace-grid-container{{gridId}} {\n            padding-top:{{valueParse(screenerHeight)}};\n            padding-bottom:{{valueParse(paginationHeight)}};\n        }\n        .grid{{ gridId }} {\n            width:{{valueParse(gridWidth)}};\n            height:{{valueParse(gridHeight)}};\n            overflow-x:{{ showScroller ? 'scroll':'hidden'}};\n            overflow-y:{{gridHeight != 'auto' && !enableInfiniteScroll && (gridHeight < getBodyHeight() + headerInfo.height) && 'scroll' || 'hidden' }};\n        }\n        .grid{{gridId}} .grace-grid-body .grace-grid-cell .cell-content {\n            height: {{valueParse(rowHeight == 'auto' ? rowHeight:rowHeight-1)}};\n            white-space: {{rowHeight == 'auto' ? 'normal':'nowrap'}};\n            text-overflow: {{rowHeight == 'auto' ? 'initial' : 'ellipsis'}};\n            {{rowHeight != 'auto' && ('line-height:'+valueParse(rowHeight-1)+\";\") }}\n        }\n        .grid{{gridId}} .grace-grid-body .grace-grid-cell .cell-content > span{\n            position: {{rowHeight == 'auto' ? 'relative':'absolute'}};\n        }\n        .grid{{gridId}} .grace-grid-body .grace-grid-cell .cell-content > span > span{\n            position: {{rowHeight == 'auto' ? 'relative':'absolute'}};\n        }\n        .grid{{gridId}} .grace-grid-header-cell{\n            height: {{valueParse(headerRowHeight)}};\n        }\n        .grid{{gridId}} header>div>div{\n            height: {{valueParse(headerInfo.height)}};\n        }\n        .grid{{gridId}} header{\n            height:{{valueParse(headerInfo.height)}};\n            width: {{valueParse(headerInfo.totalWidth + compensation )}};\n        }\n        .grid{{gridId}} section{\n            width: {{valueParse(bodyInfo.totalWidth + compensation )}};\n        }\n        .grid{{gridId}} .pinning-header .grace-grid-header-cell{\n            height:{{valueParse(headerInfo.height)}};\n        }\n        .grid{{gridId}} .empty-tips{\n            width: {{valueParse(headerInfo.totalWidth + compensation )}};\n        }\n        {{headerInfo.columnCss}}\n    </style>\n    <div grace-grid-screen ng-if=\"enableScreen\" ></div>\n\n    <div grace-grid-search-all ng-if=\"enableSearchAll\" ></div>\n\n    <div class=\"grid{{gridId}} grace-grid-wrapper\"  >\n"+'        <div class="grace-grid-scroller" id="gridScroller" >\n            <header class="clearfix" >\n                <div grace-grid-header header-data="headerInfo"></div>\n            </header>\n            <section ng-if="!gridDataEmpty" ng-class="{\'row-dragging-mode\':isDraggingMode}" >\n                <div grace-grid-body body-data="bodyInfo"></div>\n            </section>\n            <div ng-if="gridDataEmpty" class="empty-tips" >\n                {{dataEmptyText}}\n            </div>\n            <footer>\n            </footer>\n        </div>\n        <div grace-grid-scrollbar-vertical ng-if="enableInfiniteScroll" ></div>\n    </div>\n\n    <div grace-grid-pagination ng-if="enablePagination" ></div>\n</div>')}]),angular.module("template/grid/gridBody.html",[]).run(["$templateCache",function(a){a.put("template/grid/gridBody.html",'<div class="clearfix" >\n    <div style="float: left" class="pinning-body" ng-if="bodyData.rows2Pinning[0][0]" >\n        <table class="grace-grid-body">\n            <tbody>\n                <tr ng-repeat="row in bodyData.rows2Pinning track by row.rowInfo.rowId"\n                    ng-class="{grouper:gridScope.groupingMode && row.rowInfo.hasChildren,\n                    grouperChild:gridScope.groupingMode && !row.rowInfo.hasChildren,\n                    expanded:row.rowInfo.expanded,\n                    selected:row.rowInfo.selected}"\n                    class="grace-grid-body-row row-depth{{row.rowInfo.depth}}"\n                    ng-mousedown="rowMousedown(row,$event,$index)"\n                    ng-click="rowClick(row,$event)"\n                    ng-if="row.rowInfo.visible"\n                    tr-index="{{$index}}" >\n                    <td ng-repeat="rowCell in row track by rowCell.cellId"\n                        grace-grid-cell\n                        cell-data="rowCell"\n                        row-index="row.rowInfo.originalRowIndex"\n                        ng-if="rowCell.visible" ></td>\n                </tr>\n            </tbody>\n        </table>\n    </div>\n    <div style="float: left" class="normal-body" >\n        <table class="grace-grid-body">\n            <tbody>\n                <tr ng-repeat="row in bodyData.rows2Render track by row.rowInfo.rowId"\n                    ng-class="{grouper:gridScope.groupingMode && row.rowInfo.hasChildren && !bodyData.rows2Pinning[0][0],\n                    grouperChild:gridScope.groupingMode && !row.rowInfo.hasChildren && !bodyData.rows2Pinning[0][0],\n                    expanded:row.rowInfo.expanded && !bodyData.rows2Pinning[0][0],\n                    selected:row.rowInfo.selected}"\n                    class="grace-grid-body-row row-depth{{row.rowInfo.depth}}"\n                    ng-mousedown="rowMousedown(row,$event,$index)"\n                    ng-click="rowClick(row,$event)"\n                    ng-if="row.rowInfo.visible"\n                    tr-index="{{$index}}" >\n                    <td ng-repeat="rowCell in row track by rowCell.cellId"\n                        grace-grid-cell\n                        cell-data="rowCell"\n                        row-index="row.rowInfo.originalRowIndex"\n                        ng-if="rowCell.visible"  ></td>\n                </tr>\n            </tbody>\n        </table>\n    </div>\n</div>\n')}]),angular.module("template/grid/gridCell.html",[]).run(["$templateCache",function(a){a.put("template/grid/gridCell.html",'<td class="grace-grid-cell {{cellData.columnClasses}}"  >\n\n</td>')}]),angular.module("template/grid/gridFooter.html",[]).run(["$templateCache",function(a){a.put("template/grid/gridFooter.html",'<!DOCTYPE html>\n<html>\n<head lang="en">\n    <meta charset="UTF-8">\n    <title></title>\n</head>\n<body>\n\n</body>\n</html>')}]),angular.module("template/grid/gridFooterCell.html",[]).run(["$templateCache",function(a){a.put("template/grid/gridFooterCell.html",'<!DOCTYPE html>\n<html>\n<head lang="en">\n    <meta charset="UTF-8">\n    <title></title>\n</head>\n<body>\n\n</body>\n</html>')}]),angular.module("template/grid/gridHeader.html",[]).run(["$templateCache",function(a){a.put("template/grid/gridHeader.html",'<div>\n    <div style="display: table-cell;float:left;" class="pinning-header" ng-if="headerData.columns2Pinning[0][0]" >\n    <table class="grace-grid-header " ng-if="gridScope.gridOptions.enablePinning" >\n        <thead>\n        <tr ng-repeat="cells in headerData.columns2Pinning track by $index" vars="{{rowIndex = $index}}" >\n            <th grace-grid-header-cell\n                ng-repeat="cell in cells track by cell.columnId"\n                cell-data="cell"\n                row-index="rowIndex"\n                column-index="$index"\n\n\n                ng-if="gridScope.gridOptions.enableScreen && cell.visible || !gridScope.gridOptions.enableScreen"\n                    ></th>\n        </tr>\n        </thead>\n    </table>\n    </div>\n    <div class="normal-header" style="display: table-cell;float:left;" >\n    <table class="grace-grid-header" >\n        <thead>\n        <tr ng-repeat="cells in headerData.columns2Render track by $index" vars="{{rowIndex = $index}}" >\n            <th grace-grid-header-cell\n                ng-repeat="cell in cells track by cell.columnId"\n                cell-data="cell"\n                row-index="rowIndex"\n                column-index="$index"\n\n\n                ng-if="gridScope.gridOptions.enableScreen && cell.visible || !gridScope.gridOptions.enableScreen"\n                    ></th>\n        </tr>\n        </thead>\n    </table>\n    </div>\n</div>\n')}]),angular.module("template/grid/gridHeaderCell.html",[]).run(["$templateCache",function(a){a.put("template/grid/gridHeaderCell.html",'<th class="grace-grid-header-cell {{cellData.columnClasses}}"  colspan="{{cellData.colspan}}" rowspan="{{cellData.rowspan}}" >\n   <!-- <div class="cell-content"  >\n        <span ng-if="cellData.desc"\n              tooltip="{{cellData.desc}}"\n              tooltip-append-to-body="{{gridScope.tooltipConfig.append2Body}}"\n              tooltip-popup-delay="{{gridScope.tooltipConfig.showDelay}}"\n              tooltip-placement="{{gridScope.tooltipConfig.place}}" >\n            <i class="grace-icon-question-sign" ></i>\n        </span>\n        <span class="cell-value" ng-click="valueClick($event)"  >\n            {{cellData.displayName}}\n            <i ng-if="cellData.sortable && !cellData.children" ng-class="{\'grace-icon-sort-down\':sortTypeIndex == 2,\'grace-icon-sort-up\':sortTypeIndex == 1,\'grace-icon-sort\':sortTypeIndex == 0}" ></i>\n        </span>\n        <div ng-if="!cellData.children && gridOptions.enableFilter && !cellData.disableFilter" class="column-filter" >\n            <input type="text" ng-model="cellData.filterKeyWord" ng-change="filterChange($event)" />\n        </div>\n\n    </div>\n    <div ng-if="cellData.pinnable && !cellData.disablePinning" class="pin-icon" ng-class="{pinned:cellData.pinned}" ng-click="togglePinning($event)" >\n        <i class="grace-icon-pushpin" ></i>\n    </div>\n    <div ng-if="gridScope.enableColumnResize && cellData.enableResize && !cellData.children" class="resize-bar" ng-mousedown="beginResize($event)" ></div>-->\n</th>')}]),angular.module("template/grid/gridPagination.html",[]).run(["$templateCache",function(a){a.put("template/grid/gridPagination.html",'<div class="grace-grid-pagination grace-clear"  >\n\n    <pagination  total-items="totalItems"\n                ng-model="currentPageIndex"\n                max-size="paginationSize"\n                class="pagination-sm"\n                boundary-links="true"\n                rotate="true"\n                items-per-page="pageSize"\n                ng-change="changePage()"\n                num-pages="totalPages"\n                previous-text="上一页"\n                next-text="下一页"\n                first-text="首页"\n                last-text="尾页"></pagination>\n\n    <div class="pagination-info" >\n        <span>第{{currentPageIndex}}/{{totalPages}}页</span>\n    </div>\n    <div class="pagination-info" >\n        <span>\n            到\n            <input type="number" ng-model="currentPageIndex" ng-change="changePage()" />\n            页\n        </span>\n    </div>\n    <div class="pagination-sizes" >\n        每页<select ng-model="pageSize" ng-options="item for item in pageSizes" ng-change="changePage()" ></select>条\n    </div>\n\n    <div class="record-num" >\n        共{{totalItems}}条\n    </div>\n</div>')}]),angular.module("template/grid/gridScreener.html",[]).run(["$templateCache",function(a){a.put("template/grid/gridScreener.html",'<div class="grace-grid-screen grace-clear" >\n    <div ng-if="screenConfig.type == \'in-line\'" >\n        <div class="screen-left" >{{screenConfig.screenLabel}}</div>\n        <div class="screen-right grace-clear">\n            <div class="screen-item" ng-repeat="si in screener track by $index" ng-click="doCheck($index,$event)" >\n                <label>{{si.label}}</label><i class="{{si.checked?\'grace-icon-check\':\'grace-icon-unchecked\'}}"></i>\n            </div>\n        </div>\n    </div>\n    <div ng-if="screenConfig.type == \'drop-down\'" >\n        <div class="screen-drop-down-trigger" ng-click="showDropDown($event)" ng-class="{\'active\':dropDownConfig.active}" var="{{dropDownConfig.active}}" >\n            <span>{{screenConfig.screenLabel}}</span><i class="grace-icon-caret-down" ></i>\n        </div>\n        <div class="screen-drop-down"  ng-class="{active:dropDownConfig.active}" >\n            <ul class="clearfix"  ng-style="{width:screenConfig.dropDownWidth+\'px\'}" ng-class="{unClickable:visibleCount<=1}" >\n                <li class="screen-drop-down-item" ng-repeat="si in screener track by $index" ng-click="doCheck($index,$event)" ng-style="{width:1/screenConfig.dropDownColumnCount*100+\'%\'}"  >\n                    <i class="{{si.checked?\'grace-icon-check\':\'grace-icon-unchecked\'}}" ></i><label>{{si.label}}</label>\n                </li>\n            </ul>\n        </div>\n    </div>\n</div>\n')}]),angular.module("template/grid/gridSearchAll.html",[]).run(["$templateCache",function(a){a.put("template/grid/gridSearchAll.html","")}]),angular.module("template/input/input.html",[]).run(["$templateCache",function(a){a.put("template/input/input.html",'<div class="grace-input clearfix">\n    <label ng-style="config.label.style" ng-show="config.label.text">{{config.label.text}}</label>\n    <input class="form-control {{!!config.label.text ? \'\' : \'all\'}}" ng-style="config.input.style"\n           placeholder="{{config.input.placeholder}}"\n           ng-model="config.value"\n           type="{{config.input.type != \'number\' ? config.input.type : \'\'}}" name="{{config.input.name}}"\n           tooltip="{{config.$v.text}}" tooltip-trigger="blur" tooltip-placement="bottom"\n           ng-class="{error: angular.isDefined(config.$v.text) && (config.$v.text != \'\') && !first}">\n</div>')}]),angular.module("template/modal/backdrop.html",[]).run(["$templateCache",function(a){a.put("template/modal/backdrop.html",'<div class="modal-backdrop fade {{ backdropClass }}"\n     ng-class="{in: animate}"\n     ng-style="{\'z-index\': 1040 + (index && 1 || 0) + index*10}"\n></div>\n')}]),angular.module("template/modal/window.html",[]).run(["$templateCache",function(a){a.put("template/modal/window.html",'<div tabindex="-1" role="dialog" class="modal fade" ng-class="{in: animate}" ng-style="{\'z-index\': 1050 + index*10, display: \'block\'}" ng-click="close($event)">\n    <div class="modal-dialog" ng-class="{\'modal-sm\': size == \'sm\', \'modal-lg\': size == \'lg\'}"><div class="modal-content" modal-transclude></div></div>\n</div>')}]),angular.module("template/nav/nav.html",[]).run(["$templateCache",function(a){a.put("template/nav/nav.html",'<div class="grace-nav-new clearfix"> \n  <a ng-class="vm.logo"></a>\n  <ul class="grace-nav-list">\n    <li class="grace-nav-item-{{($index+1)}}" ng-repeat="navData in navsData track by $index" ng-mouseover="listShow = true" ng-mouseleave="listShow = false"> <a ng-bind="navData.title" ng-href="{{navData.url}}" ng-class="{on:listShow}"></a>\n      <dl ng-if="navData.detail" ng-show="listShow">\n        <dd ng-repeat="nav in navData.detail" class="grace-nav-item-{{($index+1)}}"> <a ng-bind="nav.title" ng-href="{{nav.url}}"></a> </dd>\n      </dl>\n      <i class="grace-nav-icon-role" ng-if="navData.detail" ng-show="listShow"></i> </li>\n  </ul>\n</div>\n\n')}]),angular.module("template/radio/radio.html",[]).run(["$templateCache",function(a){a.put("template/radio/radio.html",'<div class="grace-radio-wrapper {{radioConfig.extraCSS}}">\n    <div class="grace-radio-item-wrapper">\n        <span ng-repeat="item in data.list" class="grace-radio-item"\n              ng-class="{selected: $index == select()}" ng-click="select($index)">\n            <span class="grace-radio-item-icon"></span>\n            <span class="grace-radio-item-text">{{item.name || item}}</span>\n        </span>\n    </div>\n</div>\n')}]),angular.module("template/select/select.html",[]).run(["$templateCache",function(a){a.put("template/select/select.html",'<div class="grace-select clearfix">\n    <label class="control-label" ng-style="config.label.style" ng-show="config.label.text">{{config.label.text}}</label>\n    <div class="dropdown-container {{!!config.label.text ? \'\' : \'all\'}}" dropdown ng-style="config.input.style">\n        <div class="item-select" tabindex="0" hidefocus="true" dropdown-toggle>\n            <span class="item-name" ng-bind="currentItem.text"></span>\n            <a class="toggle"></a>\n        </div>\n        <ul class="dropdown-menu">\n            <li ng-repeat="item in config.list" ng-class="{selected: item.value == currentItem.value}">\n                <a href value="{{item.value}}" ng-click="selectItem(item);">{{item.text}}</a>\n            </li>\n        </ul>\n    </div>\n</div>')}]),angular.module("template/selectByGroup/selectByGroup.html",[]).run(["$templateCache",function(a){a.put("template/selectByGroup/selectByGroup.html",'<div class="selectByGroup">\n    <a class="selection" ng-class="{isMore:selectionData.length == 0}" ng-click="changeSelectionShow()"> {{baseFirst.name}}<span class="selection-dropdown"></span></a>\n    <div class="selectionList">\n		<div class="selection-title" ng-hide="curCode == \'own\'">\n			<ul class="clearfix">\n				<li ng-class="{on:index == $index}" ng-repeat="t in selectionData.title" ng-click="changTitle($index)" ng-bind="t"></li>\n			</ul>\n			<div class="selection-search">\n				<input type="text" placeholder="请输入要搜索的内容" class="selection-search-searchbox">\n				<span class="selection-search-searchbtn"></span>\n				<div class="selection-searchbox-searchResult" ng-show="!searchResult23Empty" >\n                    <span class="selection-searchbox-resultItem"  ng-repeat="item in searchResult23" ng-click="nodeClick(item)" >{{item.name}}</span>\n                </div>\n			</div>\n		</div>\n		<div class="selection-body clearfix">\n			<a ng-repeat="item in curDataList"><span ng-bind="item.name" ng-class="{on:item.checked}" ng-click="nodeClick(item)"></span></a>\n    	</div>\n    	<i class="selection-arrow"></i>\n    </div>\n</div>')}]),angular.module("template/summary/summary-item.html",[]).run(["$templateCache",function(a){a.put("template/summary/summary-item.html",'<li class="grace-summary-item">\n    <div class="arrow-outer">\n        <div class="arrow-inner"></div>\n    </div>\n    <h6 class="summary-title"><label desc="{{sum.desc}}">{{sum.value}}</label></h6>\n    <span>\n        <div id="Odometer{{sum.id}}" class="odometer">{{sum.currentData}}</div>\n        <label class="percent" ng-bind-html="to_trusted(sum.currentType)">{{sum.currentType}}</label>\n    </span>\n\n    <div id="Trend{{sum.id}}" class="clearfix trendDataOutDiv num {{sum.trendCss}}">\n        <b><label ng-class="{abnormal:sum.abnormal}">{{sum.trendRatio}}</label></b>\n\n        <div class="isBrFlag" style="display: none"><br/></div>\n        <em class="trendData">{{sum.trendData}}</em>\n    </div>\n</li>')}]),angular.module("template/summary/summary.html",[]).run(["$templateCache",function(a){a.put("template/summary/summary.html",'<div class="grace-summary" >\n    <ul class="grace-clear summary-list"  >\n        <li class="summary-item"\n            ng-repeat="sum in curSummaryData track by $index"\n            ng-class="{disable:sum.disable,selected:selectedIndex == $index}"\n            ng-click="itemClick($index,$event)" >\n            <div class="arrow-outer" >\n                <div class="arrow-inner"></div>\n            </div>\n            <h6 class="summary-title">\n                <label tooltip="{{sum.desc}}" tooltip-placement="bottom" tooltip-append-to-body="true" >{{sum.title}}</label>\n            </h6>\n\n            <div class="summary-body" >\n                <div class="odometer {{sum.mainValue.class}}" style="{{sum.mainValue.style}}" ></div>\n            </div>\n\n            <div class="summary-foot grace-clear" ng-if="sum.footLeftValue || sum.footRightValue" >\n                <b ng-if="sum.footLeftValue"\n                   class="foot-left {{sum.footLeftValue.class}}"\n                   style="{{sum.footLeftValue.style}}" >{{sum.footLeftValue.value | summaryFilter:sum.footLeftValue.format}}</b>\n                <b ng-if="sum.footRightValue"\n                   class="foot-right {{sum.footRightValue.class}}"\n                   style="{{sum.footRightValue.style}}" >{{sum.footRightValue.value | summaryFilter:sum.footRightValue.format}}</b>\n            </div>\n        </li>\n        <li class="summary-item"\n            ng-show="overFlowData"\n            ng-class="{selected:selectedIndex == maxItemCount-1}"\n            ng-click="overFlowItemClick($event)" >\n            <div class="arrow-outer" >\n                <div class="arrow-inner"></div>\n            </div>\n            <h6 class="summary-title" >\n                <select ng-click="onSelectClick($event)"\n                        ng-change="overFlowItemChanged($event)"\n                        ng-model="selectedOverFlow"\n                        ng-options="item.title for item in overFlowData"></select>\n            </h6>\n\n            <div class="summary-body" ng-show="selectedOverFlow.mainValue" >\n                <!--<div style="display: none" class="odometer-value" >{{sum.value}}</div>-->\n                <div class="odometer" ></div>\n            </div>\n\n            <div class="summary-foot grace-clear" ng-if="selectedOverFlow.footLeftValue || selectedOverFlow.footRightValue" >\n                <b ng-if="selectedOverFlow.footLeftValue"\n                   class="foot-left {{selectedOverFlow.footLeftValue.class}}"\n                   style="{{selectedOverFlow.footLeftValue.style}}" >{{selectedOverFlow.footLeftValue.value | summaryFilter:selectedOverFlow.footLeftValue.format}}</b>\n                <b ng-if="selectedOverFlow.footRightValue"\n                   class="foot-right {{sum.footRightValue.class}}"\n                   style="{{selectedOverFlow.footRightValue.style}}" >{{selectedOverFlow.footRightValue.value | summaryFilter:selectedOverFlow.footRightValue.format}}</b>\n            </div>\n\n        </li>\n    </ul>\n</div>')}]),angular.module("template/summaryList/summaryList.html",[]).run(["$templateCache",function(a){a.put("template/summaryList/summaryList.html",'<div  class="grace-summaryList clearfix">\n\n        <h3><i class="{{summaryListData.titleClass}}"></i>{{summaryListData.title}}</h3>\n      \n     <div class="summary-item" ng-repeat="item in summaryListData.data track by $index" style="height:{{rowheight}}px">\n             <div class="summary-inner" ng-if="item&&item.name"  >\n                <label class="icon-help"  tooltip="{{item.desc}}" tooltip-placement="bottom"></label>\n                <span ng-bind="item.name"></span>\n                <strong ng-bind="item.value"></strong>\n             </div>\n             \n             <div class="summary-inner" ng-if="item&&item.length>1" ng-repeat="ii in item track by $index"  style="margin-top:11px">\n                <label class="icon-help"  tooltip="{{ii.desc}}" tooltip-placement="bottom"></label>\n                <span ng-bind="ii.name"></span>\n                <strong ng-bind="ii.value"></strong>\n             </div>\n             <div class="summary-inner" ng-if="!(item&&item.name)"></div>\n      </div>\n    \n    </div>\n');

}]),angular.module("template/table/table.html",[]).run(["$templateCache",function(a){a.put("template/table/table.html",'<table class="grace-table" >\n    <thead>\n        <th class="grace-table-th" ng-repeat="th in tableData.head" ng-if="th.hide !== true" ng-switch on="th.type" >\n\n             <!--<span ng-if="!th.isSearch">{{th.name}}</span>\n             <div ng-if="th.isSearch" id="{{\'th_\'+(th.code?th.code:\'\')}}">\n                 <div class="search-wrapper">\n                     <input type="text" placeholder="{{th.placeholder}}" >\n                     <i ng-click="searchData($event, th)"></i>\n                 </div>\n             </div>-->\n            <div ng-switch-when="search" id="{{\'th_\'+(th.code?th.code:\'\')}}" >\n                <div class="search-wrapper">\n                    <input type="text" placeholder="{{th.placeholder}}" value="{{th.text}}"  ng-keypress="searchData($event, th)">\n                    <i ng-click="searchData($event, th)"></i>\n                </div>\n            </div>\n            <div ng-switch-when="filter" class="btn-group dropdown-box" dropdown dropdown-toggle>\n                <!--<select ng-model="th.selected" ng-options="f.name for f in th.filter" ng-change="onFilterDispatch($index,th.selected)" ></select>-->\n                <button type="button" class="btn">{{th.selected.name}}</button>\n                <button type="button" class="btn dropdown-toggle">\n                    &nabla;\n                </button>\n                <ul class="dropdown-menu" role="menu">\n                    <li ng-repeat="f in th.filter" ng-click="onFilterDispatch(th,$index)" ><a>{{f.name}}</a></li>\n                </ul>\n            </div>\n            <span ng-switch-default >{{th.name}}</span>\n        </th>\n        <!--<th class="grace-table-th" ng-if="enableFn" >{{fnThText}}</th>-->\n    </thead>\n\n    <tbody>\n    <tr class="grace-table-tr" ng-repeat="item in tableData.body" >\n        <td class="grace-table-td"\n            ng-repeat="it in item track by $index"\n            var="{{itIndex = $index;colFilterable = tableData.head[itIndex].formatter;colCode = tableData.head[itIndex].code}}"\n            ng-if="tableData.head[$index].hide !== true" >\n            <tsc ng-if="!isArray(it) && !isObject(it)" >\n                <a ng-bind-html="it|tableFilter:colCode" class="grace-table-value" title="{{tableData.head[itIndex].tipBubble ? tipBubbleFormatter(it) : \'\'}}" ></a>\n                <i ng-if="tableData.head[$index].editable" ng-click="editCell(table.head,item,$index,$event)" class="grace-table-btn-edit" >&#9998;</i>\n            </tsc>\n            <tsc ng-if="isArray(it)"  ng-repeat="t in it track by $index" ng-class="{\'grace-table-cell-fn\':t.fn}" >\n                <span ng-if="!isObject(t)" ng-bind-html="t|tableFilter:colCode" title="{{tableData.head[itIndex].tipBubble ? tipBubbleFormatter(t) : \'\'}}" ></span>\n                <span ng-if="isObject(t)" >\n                    <i ng-if="t.iconClass" class="{{t.iconClass}}" ></i>\n                    <a ng-click="t.fn(tableData.head,item,$event)" ng-bind-html="t.text|tableFilter:colCode" title="{{tableData.head[itIndex].tipBubble ? tipBubbleFormatter(t.text) : \'\'}}" ></a>\n                </span>\n            </tsc>\n            <tsc ng-if="isObject(it)"  ng-click="it.fn(tableData.head,item,$index,$event)">\n                <i ng-if="it.iconClass" class="{{it.iconClass}}" ></i>\n                <a ng-bind-html="it.text" title="{{tableData.head[itIndex].tipBubble ? tipBubbleFormatter(it.text) : \'\'}}" ></a>\n            </tsc>\n        </td>\n        <td class="grace-table-td" ng-if="enableFn && item.$$fn" >\n            <span class="grace-table-btn" ng-repeat="fn in item.$$fn track by $index" >\n                <i ng-if="fn.iconClass" class="{{fn.iconClass}}" ></i>\n                <a ng-click="fn.fn(tableData.head,item)" ng-bind-html="fn.text" ></a>\n            </span>\n        </td>\n    </tr>\n    </tbody>\n\n</table>')}]),angular.module("template/tabs/tab.html",[]).run(["$templateCache",function(a){a.put("template/tabs/tab.html",'<li ng-class="{active: active, disabled: disabled}">\n    <a ng-click="select()" tab-heading-transclude>{{heading}}</a>\n</li>\n')}]),angular.module("template/tabs/tabset.html",[]).run(["$templateCache",function(a){a.put("template/tabs/tabset.html",'<div>\n    <ul class="nav nav-{{type || \'tabs\'}}" ng-class="{\'nav-stacked\': vertical, \'nav-justified\': justified}" ng-transclude></ul>\n    <div class="tab-content">\n        <div class="tab-pane"\n             ng-repeat="tab in tabs"\n             ng-class="{active: tab.active}"\n             tab-content-transclude="tab">\n        </div>\n    </div>\n</div>\n')}]);